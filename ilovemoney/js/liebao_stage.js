var W=640,H=1000,IS_TOUCH,SCREEN_SHOW_ALL=!0;(function(j,p){function c(){var g=j.stage.canvas,e=window.innerWidth,a=window.innerHeight;if(SCREEN_SHOW_ALL){e/a>W/H?e=W*a/H:a=H*e/W,g.style.marginTop=0}else{var f=W*a/H;e>=f?(e=f,stage.x=0):stage.x=(e-f)/2}g.width=W;g.height=H;g.style.width=e+"px";g.style.height=a+"px"}var i=null,n=null,m=null,o=null,k=null;j.stage=null;j.queue=null;j.init=function(a){k=a;IS_ANDROID&&(createjs.Sound.play=function(g,d){var f=j.queue.getResult("sound");f.currentTime=this.soundSprite[g];f.play();d!=p&&!0==d&&(null!=i&&(clearTimeout(i),i=null),i=setTimeout(function(){createjs.Sound.play("silenttail")},1000))},createjs.Sound.registMySound=function(b,d){this.soundSprite||(this.soundSprite={});this.soundSprite[b]=d})};window.onload=function(){j.stage=new createjs.Stage("stage");j.queue=new createjs.LoadQueue(!1);j.queue.setMaxConnections(30);if(IS_TOUCH=createjs.Touch.isSupported()){createjs.Touch.enable(j.stage,!0);j.stage.mouseEnabled=!1;var a=new createjs.Shape;a.graphics.f("white").r(0,0,W,H);j.stage.addChild(a)}createjs.Ticker.setFPS(60);setTimeout(c,100);createjs.Ticker.on("tick",j.stage);a=new MyProgressBar(W,H);j.stage.addChild(a);j.queue.on("complete",k.startFunc,null,!0);k.img&&j.queue.loadManifest(k.img,!1);k.audio&&(IS_ANDROID?j.queue.loadFile({id:"sound",src:"img/all.mp3"}):(createjs.Sound.alternateExtensions=["ogg"],j.queue.installPlugin(createjs.Sound),j.queue.loadManifest(k.audio,!1)));k.noshare||j.queue.loadManifest({path:"img/",manifest:[{src:"share_tip.png",id:"share_tip"}]},!1);k.noshared||j.queue.loadManifest({path:"img/",manifest:[{src:"liebaoShareTip.png",id:"ShareliebaoTip"}]},!1);k.followed||j.queue.loadManifest({path:"img/",manifest:[{src:"follow_anim.png",id:"follow"}]},!1);a.forQueue(j.queue);j.queue.load()};window.onresize=c;createjs.DisplayObject.prototype.do_cache=function(){var b=this.getBounds();this.cache(b.x,b.y,b.width,b.height)};j.showShareTip=function(){adPush(true);if(!k.noshare){if(null==n){n=new createjs.Container;var a=new createjs.Shape;a.graphics.f("#000").r(0,0,W,H).ef();a.alpha=0.9;n.addChild(a);a=new createjs.Bitmap(j.queue.getResult("share_tip"));a.y=0;a.x=W-a.getBounds().width;if(navigator.userAgent.match(/liebao/gi)!=null){a=new createjs.Bitmap(j.queue.getResult("ShareliebaoTip"));a.x=W-a.getBounds().width;a.y=H-a.getBounds().height}n.addChild(a);n.on("click",function(b){IS_TOUCH&&b.nativeEvent instanceof MouseEvent||j.stage.removeChild(n)})}j.stage.addChild(n)}};j.showFollowAnim=function(d){j.showMoreGames(d);if(!k.followed){if(null==m){var a=new createjs.SpriteSheet({framerate:10,images:[j.queue.getResult("follow")],frames:{width:170,height:150},animations:{show:[0,4,!0]}});m=new createjs.Sprite(a);m.y=H;m.name="follow";m.on("click",function(b){b.stopImmediatePropagation();IS_TOUCH&&b.nativeEvent instanceof MouseEvent||window.open(APP_FOLLOW_URL)})}else{j.stage.removeChild(m)}j.stage.addChild(m);a=m.getBounds();d?(m.play(),createjs.Tween.get(m).to({regX:a.width,regY:0,visible:!0}).to({regX:0,regY:a.height},200)):createjs.Tween.get(m).to({regX:a.width,regY:0},200).to({visible:!1}).call(function(){m.stop()})}};j.showMoreGames=function(a){if(null==o){o=new createjs.Text("微信游戏l","#404040");o.textAlign="right";o.textBaseline="bottom";o.x=W-15;o.y=H-15;var g=new createjs.Shape,e=o.getBounds();g.graphics.beginFill("#000").rect(0,0,-e.width,-e.height);o.hitArea=g;o.on("click",function(b){b.stopImmediatePropagation();IS_TOUCH&&b.nativeEvent instanceof MouseEvent||window.open(APP_LIST_URL)});o.name="moreGames"}else{j.stage.removeChild(o)}j.stage.addChild(o);o.visible=a}})(window.LiebaoStage=window.LiebaoStage||{});function MyProgressBar(g,i,c){this.initialize();this.w=g;this.h=i;this.lastCount=0;var e=i/2;this.progress=new createjs.Shape;var h=this.progress.graphics;h.setStrokeStyle(1);h.beginStroke("black");h.rect(76,e-4,488,48);h.endStroke();this.addChild(this.progress);this.progressText=new createjs.Text("0%","bold 24px Arial","black");this.progressText.x=g/2;this.progressText.y=e+20;this.progressText.textAlign="center";this.progressText.textBaseline="middle";this.addChild(this.progressText);void 0==c&&(c="微信游戏");c=new createjs.Text(c,"bold 66px Arial","black");c.x=g/2;c.y=150;c.textAlign="center";this.addChild(c);c=new createjs.Text("\公众号：熊心平","38px Arial","black");c.x=g/2;c.y=260;c.textAlign="center";this.addChild(c);c=new createjs.Text("\u00a92014 \20\熊心平\ng.huceo.com","32px Arial","black");c.x=g/2;c.y=i-100;c.textAlign="center";this.addChild(c)}MyProgressBar.prototype=new createjs.Container;MyProgressBar.prototype.completeCallback=function(b){this.parent.removeChild(this)};MyProgressBar.prototype.progressCallback=function(b){var c=this.progress.graphics;c.setStrokeStyle(0);c.beginStroke("#008000");c.beginFill("#008000");c.rect(80,this.h/2,480*b.progress,40);c.endFill();c.endStroke();this.progressText.text=""+parseInt(100*b.progress)+"%"};MyProgressBar.prototype.forQueue=function(b){this.errorList=[];b.on("complete",this.completeCallback,this,!0);b.on("progress",this.progressCallback,this);b.on("error",function(c){alert("\u90e8\u5206\u8d44\u6e90\u52a0\u8f7d\u5931\u8d25!")},null,!0);b.on("error",function(c){this.errorList.push(c.item.src)},this)};