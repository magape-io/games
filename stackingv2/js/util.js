function logout(){FB.logout(function(a){window.localStorage["mas-t"]=2});$("#userLoggedIn").hide();$("#userLoggedOut").show();return false}function util_setUserToken(a,b,c,d,e){window.localStorage["mas-uid"]=a;window.localStorage["mas-id"]=b;window.localStorage["mas-t"]=c;window.localStorage["mas-un"]=d;window.localStorage["mas-up"]=e}function util_createUnknownAccount(a){if(window.localStorage["mas-uid"]==null){$.ajax({type:"POST",url:"Magic.ashx",data:"c=lg",success:function(a){if(isAJAXSuccess(a)){var b=$(a).find("uid").text();var c=$(a).find("upic").text();var d=$(a).find("id").text();var e=$(a).find("un").text();util_setUserToken(b,d,2,e,c)}}})}else{};}function checkLoggedIn(){if(window.localStorage["mas-t"]!=null){if(window.localStorage["mas-t"]!=1){$("#fb_profile_pic").hide();$("#userLoggedOut").show();$("#userLoggedIn").hide()}else{$("#userLoggedOut").hide();$("#userLoggedIn").show();$("#fb_profile_pic").attr("src",window.localStorage["mas-up"]);$("#fb_profile_pic").show()}$("#headLogin").html("Welcome <strong>"+window.localStorage["mas-un"]+"</strong>")}else{util_createUnknownAccount(true);$("#userLoggedIn").hide();$("#userLoggedOut").show()}}function makeUnfave(a){var b=window.localStorage["mas-uid"];if(b==null){return false}$.ajax({type:"POST",url:bUrl,data:"c=f&id="+a+"&uid="+b,success:function(a){}});return false}function buildLoading(){var a="<table class='loading'><tr><td style='text-align:center;'><span>Loading...</span><img src='d/i/loading.gif' alt='Loading, please wait' /></td></tr></table>";return a}function makeSafe(a){return a.toLowerCase().replace(/[ ]+/g,"-").replace(/[^a-z0-9\-]+/g,"")}function getDevice(){var a="Web";if(navigator.userAgent.match(/iPad/i)!=null){a="iPad"}else if(navigator.userAgent.match(/iPod/i)!=null){a="iPod"}else if(navigator.userAgent.match(/iPhone/i)!=null){a="iPhone"}else if(navigator.userAgent.match(/Android/i)!=null){a="Android"}else if(navigator.userAgent.match(/IEMobile/i)!=null){a="IEMobile"}return a}function getRating(a){if(a==0){return"<span class='noRating'>No Rating</span>"}var b="";a*=5;var c=Math.floor(a);var d=a-c;var e=0;var f;for(f=0;f<c;f++,e++){b+="<span class='starW'><img src='d/i/star.png' class='thumb' /></span>"}if(d>=.25){b+="<span class='starW'><img src='d/i/starhalf.png' class='thumb' /></span>";e++}for(f=e;f<5;f++){b+="<span class='starW'><img src='d/i/starshadow.png' class='thumb' /></span>"}return b}function makeSafeForPost(a){return urlEncode(htmlEncode(a))}function htmlDecode(a){return $("<div/>").html(a).text()}function htmlEncode(a){return $("<div/>").text(a).html()}function urlEncode(a){return encodeURIComponent(a)}function isAJAXSuccess(a){var b=$(a).find("res").text();return b=="SUCCESS"}var bUrl="Magic.ashx"