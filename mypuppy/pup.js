/**
 AStar

 Copyright (c) 2010, Brian Grinstead, http://briangrinstead.com

 Permission is hereby granted, free of charge, to any person obtaining
 a copy of this software and associated documentation files (the
 "Software"), to deal in the Software without restriction, including
 without limitation the rights to use, copy, modify, merge, publish,
 distribute, sublicense, and/or sell copies of the Software, and to
 permit persons to whom the Software is furnished to do so, subject to
 the following conditions:

 The above copyright notice and this permission notice shall be
 included in all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

 */

/**
 hammer.js

 Copyright (C) 2013 by Jorik Tangelder (Eight Media)

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.

 */

/**

 pixi.js

 The MIT License

 Copyright (c) 2013-2014 Mathew Groves

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.

 */

/**

 state-machine.js

 Copyright (c) 2012, 2013 Jake Gordon and contributors

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in all
 copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 SOFTWARE.

 */

/**

 tween.js

 The MIT License

 Copyright (c) 2010-2012 Tween.js authors.

 Easing equations Copyright (c) 2001 Robert Penner http://robertpenner.com/easing/

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.

 */

var requirejs,require,define;!function(global){function isFunction(t){return"[object Function]"===ostring.call(t)}function isArray(t){return"[object Array]"===ostring.call(t)}function each(t,e){if(t){var i;for(i=0;i<t.length&&(!t[i]||!e(t[i],i,t));i+=1);}}function eachReverse(t,e){if(t){var i;for(i=t.length-1;i>-1&&(!t[i]||!e(t[i],i,t));i-=1);}}function hasProp(t,e){return hasOwn.call(t,e)}function getOwn(t,e){return hasProp(t,e)&&t[e]}function eachProp(t,e){var i;for(i in t)if(hasProp(t,i)&&e(t[i],i))break}function mixin(t,e,i,n){return e&&eachProp(e,function(e,o){(i||!hasProp(t,o))&&(!n||"object"!=typeof e||!e||isArray(e)||isFunction(e)||e instanceof RegExp?t[o]=e:(t[o]||(t[o]={}),mixin(t[o],e,i,n)))}),t}function bind(t,e){return function(){return e.apply(t,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(t){throw t}function getGlobal(t){if(!t)return t;var e=global;return each(t.split("."),function(t){e=e[t]}),e}function makeError(t,e,i,n){var o=new Error(e+"\nhttp://requirejs.org/docs/errors.html#"+t);return o.requireType=t,o.requireModules=n,i&&(o.originalError=i),o}function newContext(t){function e(t){var e,i,n=t.length;for(e=0;n>e;e++)if(i=t[e],"."===i)t.splice(e,1),e-=1;else if(".."===i){if(1===e&&(".."===t[2]||".."===t[0]))break;e>0&&(t.splice(e-1,2),e-=2)}}function i(t,i,n){var o,r,s,a,h,l,u,c,p,d,f,g=i&&i.split("/"),m=g,y=C.map,v=y&&y["*"];if(t&&"."===t.charAt(0)&&(i?(m=g.slice(0,g.length-1),t=t.split("/"),u=t.length-1,C.nodeIdCompat&&jsSuffixRegExp.test(t[u])&&(t[u]=t[u].replace(jsSuffixRegExp,"")),t=m.concat(t),e(t),t=t.join("/")):0===t.indexOf("./")&&(t=t.substring(2))),n&&y&&(g||v)){s=t.split("/");t:for(a=s.length;a>0;a-=1){if(l=s.slice(0,a).join("/"),g)for(h=g.length;h>0;h-=1)if(r=getOwn(y,g.slice(0,h).join("/")),r&&(r=getOwn(r,l))){c=r,p=a;break t}!d&&v&&getOwn(v,l)&&(d=getOwn(v,l),f=a)}!c&&d&&(c=d,p=f),c&&(s.splice(0,p,c),t=s.join("/"))}return o=getOwn(C.pkgs,t),o?o:t}function n(t){isBrowser&&each(scripts(),function(e){return e.getAttribute("data-requiremodule")===t&&e.getAttribute("data-requirecontext")===x.contextName?(e.parentNode.removeChild(e),!0):void 0})}function o(t){var e=getOwn(C.paths,t);return e&&isArray(e)&&e.length>1?(e.shift(),x.require.undef(t),x.require([t]),!0):void 0}function r(t){var e,i=t?t.indexOf("!"):-1;return i>-1&&(e=t.substring(0,i),t=t.substring(i+1,t.length)),[e,t]}function s(t,e,n,o){var s,a,h,l,u=null,c=e?e.name:null,p=t,d=!0,f="";return t||(d=!1,t="_@r"+(O+=1)),l=r(t),u=l[0],t=l[1],u&&(u=i(u,c,o),a=getOwn(A,u)),t&&(u?f=a&&a.normalize?a.normalize(t,function(t){return i(t,c,o)}):i(t,c,o):(f=i(t,c,o),l=r(f),u=l[0],f=l[1],n=!0,s=x.nameToUrl(f))),h=!u||a||n?"":"_unnormalized"+(P+=1),{prefix:u,name:f,parentMap:e,unnormalized:!!h,url:s,originalName:p,isDefine:d,id:(u?u+"!"+f:f)+h}}function a(t){var e=t.id,i=getOwn(T,e);return i||(i=T[e]=new x.Module(t)),i}function h(t,e,i){var n=t.id,o=getOwn(T,n);!hasProp(A,n)||o&&!o.defineEmitComplete?(o=a(t),o.error&&"error"===e?i(o.error):o.on(e,i)):"defined"===e&&i(A[n])}function l(t,e){var i=t.requireModules,n=!1;e?e(t):(each(i,function(e){var i=getOwn(T,e);i&&(i.error=t,i.events.error&&(n=!0,i.emit("error",t)))}),n||req.onError(t))}function u(){globalDefQueue.length&&(apsp.apply(E,[E.length,0].concat(globalDefQueue)),globalDefQueue=[])}function c(t){delete T[t],delete _[t]}function p(t,e,i){var n=t.map.id;t.error?t.emit("error",t.error):(e[n]=!0,each(t.depMaps,function(n,o){var r=n.id,s=getOwn(T,r);!s||t.depMatched[o]||i[r]||(getOwn(e,r)?(t.defineDep(o,A[r]),t.check()):p(s,e,i))}),i[n]=!0)}function d(){var t,e,i=1e3*C.waitSeconds,r=i&&x.startTime+i<(new Date).getTime(),s=[],a=[],h=!1,u=!0;if(!v){if(v=!0,eachProp(_,function(t){var i=t.map,l=i.id;if(t.enabled&&(i.isDefine||a.push(t),!t.error))if(!t.inited&&r)o(l)?(e=!0,h=!0):(s.push(l),n(l));else if(!t.inited&&t.fetched&&i.isDefine&&(h=!0,!i.prefix))return u=!1}),r&&s.length)return t=makeError("timeout","Load timeout for modules: "+s,null,s),t.contextName=x.contextName,l(t);u&&each(a,function(t){p(t,{},{})}),r&&!e||!h||!isBrowser&&!isWebWorker||S||(S=setTimeout(function(){S=0,d()},50)),v=!1}}function f(t){hasProp(A,t[0])||a(s(t[0],null,!0)).init(t[1],t[2])}function g(t,e,i,n){t.detachEvent&&!isOpera?n&&t.detachEvent(n,e):t.removeEventListener(i,e,!1)}function m(t){var e=t.currentTarget||t.srcElement;return g(e,x.onScriptLoad,"load","onreadystatechange"),g(e,x.onScriptError,"error"),{node:e,id:e&&e.getAttribute("data-requiremodule")}}function y(){var t;for(u();E.length;){if(t=E.shift(),null===t[0])return l(makeError("mismatch","Mismatched anonymous define() module: "+t[t.length-1]));f(t)}}var v,b,x,w,S,C={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},T={},_={},M={},E=[],A={},B={},k={},O=1,P=1;return w={require:function(t){return t.require?t.require:t.require=x.makeRequire(t.map)},exports:function(t){return t.usingExports=!0,t.map.isDefine?t.exports?A[t.map.id]=t.exports:t.exports=A[t.map.id]={}:void 0},module:function(t){return t.module?t.module:t.module={id:t.map.id,uri:t.map.url,config:function(){return getOwn(C.config,t.map.id)||{}},exports:t.exports||(t.exports={})}}},b=function(t){this.events=getOwn(M,t.id)||{},this.map=t,this.shim=getOwn(C.shim,t.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},b.prototype={init:function(t,e,i,n){n=n||{},this.inited||(this.factory=e,i?this.on("error",i):this.events.error&&(i=bind(this,function(t){this.emit("error",t)})),this.depMaps=t&&t.slice(0),this.errback=i,this.inited=!0,this.ignore=n.ignore,n.enabled||this.enabled?this.enable():this.check())},defineDep:function(t,e){this.depMatched[t]||(this.depMatched[t]=!0,this.depCount-=1,this.depExports[t]=e)},fetch:function(){if(!this.fetched){this.fetched=!0,x.startTime=(new Date).getTime();var t=this.map;return this.shim?void x.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return t.prefix?this.callPlugin():this.load()})):t.prefix?this.callPlugin():this.load()}},load:function(){var t=this.map.url;B[t]||(B[t]=!0,x.load(this.map.id,t))},check:function(){if(this.enabled&&!this.enabling){var t,e,i=this.map.id,n=this.depExports,o=this.exports,r=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(r)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{o=x.execCb(i,r,n,o)}catch(s){t=s}else o=x.execCb(i,r,n,o);if(this.map.isDefine&&void 0===o&&(e=this.module,e?o=e.exports:this.usingExports&&(o=this.exports)),t)return t.requireMap=this.map,t.requireModules=this.map.isDefine?[this.map.id]:null,t.requireType=this.map.isDefine?"define":"require",l(this.error=t)}else o=r;this.exports=o,this.map.isDefine&&!this.ignore&&(A[i]=o,req.onResourceLoad&&req.onResourceLoad(x,this.map,this.depMaps)),c(i),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var t=this.map,e=t.id,n=s(t.prefix);this.depMaps.push(n),h(n,"defined",bind(this,function(n){var o,r,u,p=getOwn(k,this.map.id),d=this.map.name,f=this.map.parentMap?this.map.parentMap.name:null,g=x.makeRequire(t.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(n.normalize&&(d=n.normalize(d,function(t){return i(t,f,!0)})||""),r=s(t.prefix+"!"+d,this.map.parentMap),h(r,"defined",bind(this,function(t){this.init([],function(){return t},null,{enabled:!0,ignore:!0})})),u=getOwn(T,r.id),void(u&&(this.depMaps.push(r),this.events.error&&u.on("error",bind(this,function(t){this.emit("error",t)})),u.enable()))):p?(this.map.url=x.nameToUrl(p),void this.load()):(o=bind(this,function(t){this.init([],function(){return t},null,{enabled:!0})}),o.error=bind(this,function(t){this.inited=!0,this.error=t,t.requireModules=[e],eachProp(T,function(t){0===t.map.id.indexOf(e+"_unnormalized")&&c(t.map.id)}),l(t)}),o.fromText=bind(this,function(i,n){var r=t.name,h=s(r),u=useInteractive;n&&(i=n),u&&(useInteractive=!1),a(h),hasProp(C.config,e)&&(C.config[r]=C.config[e]);try{req.exec(i)}catch(c){return l(makeError("fromtexteval","fromText eval for "+e+" failed: "+c,c,[e]))}u&&(useInteractive=!0),this.depMaps.push(h),x.completeLoad(r),g([r],o)}),void n.load(t.name,g,o,C))})),x.enable(n,this),this.pluginMaps[n.id]=n},enable:function(){_[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(t,e){var i,n,o;if("string"==typeof t){if(t=s(t,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[e]=t,o=getOwn(w,t.id))return void(this.depExports[e]=o(this));this.depCount+=1,h(t,"defined",bind(this,function(t){this.defineDep(e,t),this.check()})),this.errback&&h(t,"error",bind(this,this.errback))}i=t.id,n=T[i],hasProp(w,i)||!n||n.enabled||x.enable(t,this)})),eachProp(this.pluginMaps,bind(this,function(t){var e=getOwn(T,t.id);e&&!e.enabled&&x.enable(t,this)})),this.enabling=!1,this.check()},on:function(t,e){var i=this.events[t];i||(i=this.events[t]=[]),i.push(e)},emit:function(t,e){each(this.events[t],function(t){t(e)}),"error"===t&&delete this.events[t]}},x={config:C,contextName:t,registry:T,defined:A,urlFetched:B,defQueue:E,Module:b,makeModuleMap:s,nextTick:req.nextTick,onError:l,configure:function(t){t.baseUrl&&"/"!==t.baseUrl.charAt(t.baseUrl.length-1)&&(t.baseUrl+="/");var e=C.shim,i={paths:!0,bundles:!0,config:!0,map:!0};eachProp(t,function(t,e){i[e]?(C[e]||(C[e]={}),mixin(C[e],t,!0,!0)):C[e]=t}),t.bundles&&eachProp(t.bundles,function(t,e){each(t,function(t){t!==e&&(k[t]=e)})}),t.shim&&(eachProp(t.shim,function(t,i){isArray(t)&&(t={deps:t}),!t.exports&&!t.init||t.exportsFn||(t.exportsFn=x.makeShimExports(t)),e[i]=t}),C.shim=e),t.packages&&each(t.packages,function(t){var e,i;t="string"==typeof t?{name:t}:t,i=t.name,e=t.location,e&&(C.paths[i]=t.location),C.pkgs[i]=t.name+"/"+(t.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}),eachProp(T,function(t,e){t.inited||t.map.unnormalized||(t.map=s(e))}),(t.deps||t.callback)&&x.require(t.deps||[],t.callback)},makeShimExports:function(t){function e(){var e;return t.init&&(e=t.init.apply(global,arguments)),e||t.exports&&getGlobal(t.exports)}return e},makeRequire:function(e,o){function r(i,n,h){var u,c,p;return o.enableBuildCallback&&n&&isFunction(n)&&(n.__requireJsBuild=!0),"string"==typeof i?isFunction(n)?l(makeError("requireargs","Invalid require call"),h):e&&hasProp(w,i)?w[i](T[e.id]):req.get?req.get(x,i,e,r):(c=s(i,e,!1,!0),u=c.id,hasProp(A,u)?A[u]:l(makeError("notloaded",'Module name "'+u+'" has not been loaded yet for context: '+t+(e?"":". Use require([])")))):(y(),x.nextTick(function(){y(),p=a(s(null,e)),p.skipMap=o.skipMap,p.init(i,n,h,{enabled:!0}),d()}),r)}return o=o||{},mixin(r,{isBrowser:isBrowser,toUrl:function(t){var n,o=t.lastIndexOf("."),r=t.split("/")[0],s="."===r||".."===r;return-1!==o&&(!s||o>1)&&(n=t.substring(o,t.length),t=t.substring(0,o)),x.nameToUrl(i(t,e&&e.id,!0),n,!0)},defined:function(t){return hasProp(A,s(t,e,!1,!0).id)},specified:function(t){return t=s(t,e,!1,!0).id,hasProp(A,t)||hasProp(T,t)}}),e||(r.undef=function(t){u();var i=s(t,e,!0),o=getOwn(T,t);n(t),delete A[t],delete B[i.url],delete M[t],eachReverse(E,function(e,i){e[0]===t&&E.splice(i,1)}),o&&(o.events.defined&&(M[t]=o.events),c(t))}),r},enable:function(t){var e=getOwn(T,t.id);e&&a(t).enable()},completeLoad:function(t){var e,i,n,r=getOwn(C.shim,t)||{},s=r.exports;for(u();E.length;){if(i=E.shift(),null===i[0]){if(i[0]=t,e)break;e=!0}else i[0]===t&&(e=!0);f(i)}if(n=getOwn(T,t),!e&&!hasProp(A,t)&&n&&!n.inited){if(!(!C.enforceDefine||s&&getGlobal(s)))return o(t)?void 0:l(makeError("nodefine","No define call for "+t,null,[t]));f([t,r.deps||[],r.exportsFn])}d()},nameToUrl:function(t,e,i){var n,o,r,s,a,h,l,u=getOwn(C.pkgs,t);if(u&&(t=u),l=getOwn(k,t))return x.nameToUrl(l,e,i);if(req.jsExtRegExp.test(t))a=t+(e||"");else{for(n=C.paths,o=t.split("/"),r=o.length;r>0;r-=1)if(s=o.slice(0,r).join("/"),h=getOwn(n,s)){isArray(h)&&(h=h[0]),o.splice(0,r,h);break}a=o.join("/"),a+=e||(/^data\:|\?/.test(a)||i?"":".js"),a=("/"===a.charAt(0)||a.match(/^[\w\+\.\-]+:/)?"":C.baseUrl)+a}return C.urlArgs?a+((-1===a.indexOf("?")?"?":"&")+C.urlArgs):a},load:function(t,e){req.load(x,t,e)},execCb:function(t,e,i,n){return e.apply(n,i)},onScriptLoad:function(t){if("load"===t.type||readyRegExp.test((t.currentTarget||t.srcElement).readyState)){interactiveScript=null;var e=m(t);x.completeLoad(e.id)}},onScriptError:function(t){var e=m(t);return o(e.id)?void 0:l(makeError("scripterror","Script error for: "+e.id,t,[e.id]))}},x.require=x.makeRequire(),x}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(t){return"interactive"===t.readyState?interactiveScript=t:void 0}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.1.11",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,apsp=ap.splice,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}"undefined"==typeof require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(t,e,i,n){var o,r,s=defContextName;return isArray(t)||"string"==typeof t||(r=t,isArray(e)?(t=e,e=i,i=n):t=[]),r&&r.context&&(s=r.context),o=getOwn(contexts,s),o||(o=contexts[s]=req.s.newContext(s)),r&&o.configure(r),o.require(t,e,i)},req.config=function(t){return req(t)},req.nextTick="undefined"!=typeof setTimeout?function(t){setTimeout(t,4)}:function(t){t()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(t){req[t]=function(){var e=contexts[defContextName];return e.require[t].apply(e,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(t){var e=t.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return e.type=t.scriptType||"text/javascript",e.charset="utf-8",e.async=!0,e},req.load=function(t,e,i){var n,o=t&&t.config||{};if(isBrowser)return n=req.createNode(o,e,i),n.setAttribute("data-requirecontext",t.contextName),n.setAttribute("data-requiremodule",e),!n.attachEvent||n.attachEvent.toString&&n.attachEvent.toString().indexOf("[native code")<0||isOpera?(n.addEventListener("load",t.onScriptLoad,!1),n.addEventListener("error",t.onScriptError,!1)):(useInteractive=!0,n.attachEvent("onreadystatechange",t.onScriptLoad)),n.src=i,currentlyAddingScript=n,baseElement?head.insertBefore(n,baseElement):head.appendChild(n),currentlyAddingScript=null,n;if(isWebWorker)try{importScripts(i),t.completeLoad(e)}catch(r){t.onError(makeError("importscripts","importScripts failed for "+e+" at "+i,r,[e]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(t){return head||(head=t.parentNode),dataMain=t.getAttribute("data-main"),dataMain?(mainScript=dataMain,cfg.baseUrl||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0):void 0}),define=function(t,e,i){var n,o;"string"!=typeof t&&(i=e,e=t,t=null),isArray(e)||(i=e,e=null),!e&&isFunction(i)&&(e=[],i.length&&(i.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(t,i){e.push(i)}),e=(1===i.length?["require"]:["require","exports","module"]).concat(e))),useInteractive&&(n=currentlyAddingScript||getInteractiveScript(),n&&(t||(t=n.getAttribute("data-requiremodule")),o=contexts[n.getAttribute("data-requirecontext")])),(o?o.defQueue:globalDefQueue).push([t,e,i])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this),define("requireLib",function(){}),define("text",["module"],function(t){"use strict";var e,i,n,o,r,s=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],a=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,h=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,l="undefined"!=typeof location&&location.href,u=l&&location.protocol&&location.protocol.replace(/\:/,""),c=l&&location.hostname,p=l&&(location.port||void 0),d={},f=t.config&&t.config()||{};return e={version:"2.0.10",strip:function(t){if(t){t=t.replace(a,"");var e=t.match(h);e&&(t=e[1])}else t="";return t},jsEscape:function(t){return t.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:f.createXhr||function(){var t,e,i;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(e=0;3>e;e+=1){i=s[e];try{t=new ActiveXObject(i)}catch(n){}if(t){s=[i];break}}return t},parseName:function(t){var e,i,n,o=!1,r=t.indexOf("."),s=0===t.indexOf("./")||0===t.indexOf("../");return-1!==r&&(!s||r>1)?(e=t.substring(0,r),i=t.substring(r+1,t.length)):e=t,n=i||e,r=n.indexOf("!"),-1!==r&&(o="strip"===n.substring(r+1),n=n.substring(0,r),i?i=n:e=n),{moduleName:e,ext:i,strip:o}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(t,i,n,o){var r,s,a,h=e.xdRegExp.exec(t);return h?(r=h[2],s=h[3],s=s.split(":"),a=s[1],s=s[0],!(r&&r!==i||s&&s.toLowerCase()!==n.toLowerCase()||(a||s)&&a!==o)):!0},finishLoad:function(t,i,n,o){n=i?e.strip(n):n,f.isBuild&&(d[t]=n),o(n)},load:function(t,i,n,o){if(o.isBuild&&!o.inlineText)return void n();f.isBuild=o.isBuild;var r=e.parseName(t),s=r.moduleName+(r.ext?"."+r.ext:""),a=i.toUrl(s),h=f.useXhr||e.useXhr;return 0===a.indexOf("empty:")?void n():void(!l||h(a,u,c,p)?e.get(a,function(i){e.finishLoad(t,r.strip,i,n)},function(t){n.error&&n.error(t)}):i([s],function(t){e.finishLoad(r.moduleName+"."+r.ext,r.strip,t,n)}))},write:function(t,i,n){if(d.hasOwnProperty(i)){var o=e.jsEscape(d[i]);n.asModule(t+"!"+i,"define(function () { return '"+o+"';});\n")}},writeFile:function(t,i,n,o,r){var s=e.parseName(i),a=s.ext?"."+s.ext:"",h=s.moduleName+a,l=n.toUrl(s.moduleName+a)+".js";e.load(h,n,function(){var i=function(t){return o(l,t)};i.asModule=function(t,e){return o.asModule(t,l,e)},e.write(t,h,i,r)},r)}},"node"===f.env||!f.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(i=require.nodeRequire("fs"),e.get=function(t,e,n){try{var o=i.readFileSync(t,"utf8");0===o.indexOf("﻿")&&(o=o.substring(1)),e(o)}catch(r){n(r)}}):"xhr"===f.env||!f.env&&e.createXhr()?e.get=function(t,i,n,o){var r,s=e.createXhr();if(s.open("GET",t,!0),o)for(r in o)o.hasOwnProperty(r)&&s.setRequestHeader(r.toLowerCase(),o[r]);f.onXhr&&f.onXhr(s,t),s.onreadystatechange=function(){var e,o;4===s.readyState&&(e=s.status,e>399&&600>e?(o=new Error(t+" HTTP status: "+e),o.xhr=s,n(o)):i(s.responseText),f.onXhrComplete&&f.onXhrComplete(s,t))},s.send(null)}:"rhino"===f.env||!f.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?e.get=function(t,e){var i,n,o="utf-8",r=new java.io.File(t),s=java.lang.System.getProperty("line.separator"),a=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(r),o)),h="";try{for(i=new java.lang.StringBuffer,n=a.readLine(),n&&n.length()&&65279===n.charAt(0)&&(n=n.substring(1)),null!==n&&i.append(n);null!==(n=a.readLine());)i.append(s),i.append(n);h=String(i.toString())}finally{a.close()}e(h)}:("xpconnect"===f.env||!f.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(n=Components.classes,o=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),r="@mozilla.org/windows-registry-key;1"in n,e.get=function(t,e){var i,s,a,h={};r&&(t=t.replace(/\//g,"\\")),a=new FileUtils.File(t);try{i=n["@mozilla.org/network/file-input-stream;1"].createInstance(o.nsIFileInputStream),i.init(a,1,0,!1),s=n["@mozilla.org/intl/converter-input-stream;1"].createInstance(o.nsIConverterInputStream),s.init(i,"utf-8",i.available(),o.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),s.readString(i.available(),h),s.close(),i.close(),e(h.value)}catch(l){throw new Error((a&&a.path||"")+": "+l)}}),e}),define("text!version.json",[],function(){return'{\n    "name": "Puppy",\n    "shortname": "pup",\n    "id": "com.absoluteherogames.PUPPY",\n    "major": 1,\n    "minor": 0,\n    "build": 18,\n    "date": "2014-07-15",\n    "time": "22:34:55",\n    "string": "1.0.18"\n}\n'}),define("version",["text!version.json"],function(t){var e=JSON.parse(t);return{name:function(){return e.name},id:function(){return e.id},version:function(){return e.string+"_"+e.date+"_"+e.time}}}),define("absolute/asyncqueue",[],function(){"use strict";var t=function(){this._initAsyncQueue()};return t.prototype._initAsyncQueue=function(){this.tasks=new Array,this.current=0},t.prototype.reset=function(){this.current=0},t.prototype.clear=function(){this.tasks=new Array,this.reset()},t.prototype.pushTask=function(t){this.tasks.push(t)},t.prototype.pushTasks=function(t){for(var e in t)this.tasks.push(t[e])},t.prototype.run=function(t,e){this.onProgress=t,this.onComplete=e;var i=this;if("function"!=typeof this.tasks[0])throw"Error: task is a "+typeof this.tasks[0]+" not a function!";this.tasks[this.current](function(t){i._updateProgress(t)},function(){i._runNext()})},t.prototype._runNext=function(){var t=this;if(++this.current<this.tasks.length){if("function"!=typeof this.tasks[this.current])throw"Error: task is a "+typeof this.tasks[0]+" not a function!";this.tasks[this.current](function(e){t._updateProgress(e)},function(){t._runNext()})}else this.onComplete()},t.prototype._updateProgress=function(t){var e=0;this.tasks.length>0&&(e=this.current/this.tasks.length+1/this.tasks.length*t),this.onProgress(e)},t}),define("absoluteaudio/audioclip",[],function(){var t=(navigator.userAgent.indexOf("iPhone OS")>=0,function(t,e){this.init(t,e)});return t.constructor=t,t.prototype.init=function(){},t.prototype.load=function(){},t.prototype.seek=function(){},t.prototype.play=function(){},t.prototype.pause=function(){},t.prototype.stop=function(){},t.prototype.setVolume=function(){},t.prototype.getVolume=function(){},t.prototype.mute=function(){},t.prototype.unmute=function(){},t.prototype.isMuted=function(){},t.prototype.prime=function(){},t}),define("absoluteaudio/webaudioclip",["absoluteaudio/audioclip"],function(t){var e=navigator.userAgent.indexOf("iPhone OS")>=0,i=function(t,e,i){this.init(t,e,i)};return i.constructor=i,i.prototype=Object.create(t.prototype),i.prototype.init=function(e,i,n){t.prototype.init.call(e,i),this.audioContext=n,this.url=e,this.volume=1,this.offset=0,this.sourceNode=null,this.gainNode=null,this.muted=!1,this.load(e,i)},i.prototype.load=function(t,e){var i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="arraybuffer",i.onload=function(){this.audioContext.decodeAudioData(i.response,function(t){this.buffer=t,e&&"function"==typeof e&&e()}.bind(this),function(){console.log("error loading audio clip "+t),e&&"function"==typeof e&&e()}.bind(this))}.bind(this),i.send()},i.prototype.play=function(t,i,n){var o=t||0;this.loop=!!i,this.onComplete=n,e&&this.muted||(this.sourceNode=this.audioContext.createBufferSource(),this.gainNode="undefined"!=typeof this.audioContext.createGainNode?this.audioContext.createGainNode():this.audioContext.createGain(),this.sourceNode.loop=i,this.sourceNode.buffer=this.buffer,this.sourceNode.onended=function(){n&&"function"==typeof n&&n()},this.gainNode.gain.value=this.muted?0:this.volume,this.sourceNode.connect(this.gainNode),this.gainNode.connect(this.audioContext.destination),0!==o&&(o+=this.audioContext.currentTime),"undefined"==typeof this.sourceNode.start?this.sourceNode.noteOn(o):this.sourceNode.start(o,this.offset))},i.prototype.pause=function(){this.stop(),this.offset=this.audioContext.currentTime},i.prototype.stop=function(){this.sourceNode&&(this.offset=0,"undefined"==typeof this.sourceNode.start?this.sourceNode.noteOff(0):this.sourceNode.stop(0),this.sourceNode=null,this.gainNode=null)},i.prototype.setVolume=function(t){0>t?t=0:t>1&&(t=1),this.volume=t,this.gainNode&&(this.gainNode.gain.value=t)},i.prototype.getVolume=function(){return this.volume},i.prototype.mute=function(){this.muted=!0,this.gainNode&&(this.gainNode.gain.value=0,e&&this.pause())},i.prototype.unmute=function(){this.muted=!1,this.gainNode&&(this.gainNode.gain.value=this.volume,e&&this.play(0,this.loop,this.onComplete))},i.prototype.isMuted=function(){return this.muted},i}),define("absoluteaudio/streamedwebaudioclip",[],function(){var t=(navigator.userAgent.indexOf("iPhone OS")>=0,function(t,e,i){this.init(t,e,i)});return t.prototype.init=function(t,e,i){this.audioContext=i,this.url=t,this.volume=1,this.offset=0,this.audioElement=null,this.source=null,this.gainNode=null,this.muted=!1,this.load(t,e)},t.prototype.load=function(t,e){this.audioElement=new Audio,this.audioElement.addEventListener("loadstart",function(){e&&"function"==typeof e&&e()},!1),this.audioElement.src=this.url},t.prototype.play=function(t,e,i){this.audioElement.loop=e,this.source||(this.source=this.audioContext.createMediaElementSource(this.audioElement),this.gainNode=this.audioContext.createGainNode(),this.source.connect(this.gainNode),this.gainNode.connect(this.audioContext.destination),this.gainNode.gain.value=this.muted?0:this.volume),this.audioElement.addEventListener("ended",function(){i&&"function"==typeof i&&i()},!1),this.audioElement.play()},t.prototype.pause=function(){this.audioElement&&this.audioElement.pause()},t.prototype.stop=function(){this.audioElement&&this.audioElement.pause()},t.prototype.setVolume=function(t){0>t?t=0:t>1&&(t=1),this.volume=t,this.gainNode&&(this.gainNode.gain.value=t)},t.prototype.getVolume=function(){return this.volume},t.prototype.mute=function(){this.muted=!0,this.gainNode&&(this.gainNode.gain.value=0)},t.prototype.unmute=function(){this.gainNode&&(this.gainNode.gain.value=this.volume),this.muted=!1},t.prototype.isMuted=function(){return this.muted},t}),define("absoluteaudio/html5audioelementclip",["absoluteaudio/audioclip"],function(t){var e=!0,i=function(t,e,i){this.init(t,e,i)};return i.constructor=i,i.prototype=Object.create(t.prototype),i.prototype.init=function(e,i,n){t.prototype.init.call(e,i),this.duration=n,this.url=e,this.volume=1,this.audioElement=null,this.muted=!1,this.loopTimer=null,this.delay=0,this.loop=!1,this.onComplete=null,this.paused=!0,this.offset=0,this.isSilent=!1,this.load(e,i)},i.prototype.load=function(t,e){this.audioElement=new Audio;var i=0,n=4,o=function(){4===this.audioElement.readyState||i++>n?e():setTimeout(o,250)}.bind(this);this.audioElement.addEventListener("loadstart",function(){o()}.bind(this),!1),this.audioElement.src=this.url},t.prototype.seek=function(t){this.offset=t},i.prototype.play=function(t,i,n){try{if(this.delay=t,this.loop=i,this.onComplete=n,this.muted&&e)return void(i&&(this.paused=!1));if("undefined"!=typeof this.duration){var o=function(){this.audioElement.currentTime>=this.duration?(this.paused=!1,i?(this.audioElement.pause(),this.audioElement.currentTime=this.offset,this.play(t,i,n)):(this.paused=!0,this.audioElement.pause(),n&&"function"==typeof n&&n())):this.audioElement.paused||requestAnimationFrame(o)}.bind(this);requestAnimationFrame(o)}this.audioElement.currentTime=this.offset,this.audioElement.play()}catch(r){}},i.prototype.pause=function(){this._actualPause(),this.paused=!0},i.prototype._actualPause=function(){this.audioElement&&(this.loopTimer&&(clearTimeout(this.loopTimer),this.loopTimer=null),this.audioElement.pause())},i.prototype.stop=function(){try{this.audioElement&&(this.loopTimer&&(clearTimeout(this.loopTimer),this.loopTimer=null),this.audioElement.pause(),this.audioElement.currentTime=this.offset)}catch(t){}},i.prototype.setVolume=function(t){0>t?t=0:t>1&&(t=1),this.volume=t,this.audioElement&&(this.audioElement=t)},i.prototype.getVolume=function(){return this.volume},i.prototype.mute=function(){this.muted=!0,this.audioElement&&e&&!this.paused&&this._actualPause()},i.prototype.unmute=function(){this.audioElement&&this.muted&&e&&!this.paused&&(this.muted=!1,this.play(this.delay,this.loop,this.onComplete)),this.muted=!1},i.prototype.isMuted=function(){return this.muted},i.prototype.prime=function(){this.audioElement&&(this.audioElement.play(),this.audioElement.pause())},i.prototype.playSilent=function(){this.isSilent=!0;var t=function(){if(this.isSilent){try{this.audioElement.currentTime=1e3}catch(e){}setTimeout(t,500)}}.bind(this);t()},i}),define("absoluteaudio/audiosprite",[],function(){var t=null,e=function(t,e,i){this.init(t,e,i)};return e.constructor=e,e.prototype.init=function(t,e,i){this.baseClip=t,this.start=e,this.end=i,this.cancelled=!1,this.muted=!1,this.paused=!0},e.prototype.seek=function(t){this.baseClip.seek(this.offset+t)},e.prototype.play=function(e,i,n){this.delay=e,this.loop=i,this.onComplete=n;var o=e||0;if(!this.muted){var r=function(){try{this.paused=!0,this.baseClip.audioElement.currentTime=this.start;var e=function(){this.baseClip.audioElement.currentTime=this.start,this.baseClip.audioElement.currentTime!==this.start?setTimeout(e,100):(this!==t&&(t&&(t.cancelled=!0),t=this,this.cancelled=!1),this.paused=!1,this.baseClip.audioElement.paused&&this.baseClip.audioElement.play(),this.baseClip.isSilent=!1,requestAnimationFrame(s))}.bind(this);e()}catch(i){}}.bind(this),s=function(){this.cancelled||(this.baseClip.audioElement.currentTime>=this.end?(this.paused=!1,i?r():(this.paused=!0,this.baseClip.playSilent(),n&&"function"==typeof n&&n())):this.paused||requestAnimationFrame(s))}.bind(this);o>0?setTimeout(function(){r()}.bind(this),1e3*o):r()}},e.prototype.pause=function(){this.baseClip.playSilent()},e.prototype.stop=function(){this.baseClip.playSilent(),this.cancelled=!0},e.prototype.setVolume=function(){this.baseClip.setVolume()},e.prototype.getVolume=function(){return this.baseClip.getVolume()},e.prototype.mute=function(){this.paused||this.cancelled||this.baseClip.playSilent(),this.muted=!0,this.cancelled=!0},e.prototype.unmute=function(){this.muted=!1,this.paused||this.play(this.delay,this.loop,this.onComplete)},e.prototype.isMuted=function(){return this.baseClip.isMuted()},e.prototype.prime=function(){},e}),define("absoluteaudio/cordovaclip",[],function(){var t=function(t,e){this.init(t,e)};return t.constructor=t,t.prototype.init=function(t,e){this.clip=new Media(t,function(){this.loop&&!this.cancelled?this.clip.play():this.onComplete&&"function"==typeof this.onComplete&&this.onComplete()}.bind(this)),this.muted=!1,this.cancelled=!1,this.paused=!0,e&&"function"==typeof e&&e()},t.prototype.seek=function(){},t.prototype.play=function(t,e,i){this.delay=t,this.loop=e,this.onComplete=i;var n=t||0;this.paused=!1,this.cancelled=!1,n>0?setTimeout(function(){this.clip.play()}.bind(this),1e3*n):this.clip.play()},t.prototype.pause=function(){this.clip.pause(),this.paused=!0},t.prototype.stop=function(){this.cancelled=!0,this.clip.stop()},t.prototype.setVolume=function(){},t.prototype.getVolume=function(){},t.prototype.mute=function(){setTimeout(function(){this.clip.setVolume("0.0"),this.muted=!0
}.bind(this),0)},t.prototype.unmute=function(){setTimeout(function(){this.clip.setVolume("1.0"),this.muted=!1}.bind(this),0)},t.prototype.isMuted=function(){return this.muted},t.prototype.prime=function(){},t}),define("absoluteaudio/debug",[],function(){for(var t,e={},i=/\+/g,n=/([^&=]+)=?([^&]*)/g,o=function(t){return decodeURIComponent(t.replace(i," "))},r=window.location.search.substring(1);t=n.exec(r);)e[o(t[1])]=o(t[2]);var s={enabled:e.debugAudio&&"true"===e.debugAudio};return s}),define("absoluteaudio/audio",["absoluteaudio/webaudioclip","absoluteaudio/streamedwebaudioclip","absoluteaudio/html5audioelementclip","absoluteaudio/audiosprite","absoluteaudio/cordovaclip","absoluteaudio/debug"],function(t,e,i,n,o,r){"use strict";var s=null;"undefined"!=typeof AudioContext?s=new AudioContext:"undefined"!=typeof webkitAudioContext?s=new webkitAudioContext:"undefined"!=typeof mozAudioContext&&(s=new mozAudioContext),r.enabled&&(s=null);var a={createAudioClip:function(n,r,a,h){return null!==s?a?new e(n,r,s):new t(n,r,s):"undefined"!=typeof Media?new o(n,r):new i(n,r,h)},createAudioSprite:function(t,e,i){return new n(t,e,i)},usingWebAudio:function(){return null!==s},usingCordovaAudio:function(){return"undefined"!=typeof Media}};return a}),define("absoluteaudio",["require","absoluteaudio/audio"],function(t){"use strict";return{version:"1.0",context:t("absoluteaudio/audio")}}),define("absolute/debug",[],function(){var t={enabled:!1,log:function(t){this.enabled&&console.log(t)}};return t}),define("absolute/storagemanager",["absolute/debug"],function(t){var e={prefix:null,store:function(e,i){if(!this.prefix)throw"Error: you must set StorageManager.prefix for this game!";try{localStorage[this.prefix+e]=JSON.stringify(i)}catch(n){t.log("error creating local storage "+n)}},fetch:function(e){if(!this.prefix)throw"Error: you must set StorageManager.prefix for this game!";try{var i=localStorage[this.prefix+e];if(i)return JSON.parse(i)}catch(n){t.log("error accessing local storage "+n)}return null}};return e}),define("absolute/gameconfig",["absolute/storagemanager"],function(t){var e={defaults:{},options:{},reset:function(){this.options=this.defaults,this.save()},load:function(e){if(this.defaults=e,this.options=t.fetch("options")||this.defaults,!this.options.version||this.options.version<this.defaults.version)for(var i in this.defaults)this.defaults.hasOwnProperty(i)&&!this.options.hasOwnProperty(i)&&(this.options[i]=this.defaults[i])},save:function(){t.store("options",this.options)},setVal:function(t,e){this.options[t]=e,this.save()},getVal:function(t){return this.options[t]}};return e}),function(){var t=this,e=e||{};e.WEBGL_RENDERER=0,e.CANVAS_RENDERER=1,e.VERSION="v1.5.3",e.blendModes={NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16},e.scaleModes={DEFAULT:0,LINEAR:0,NEAREST:1},e.INTERACTION_FREQUENCY=30,e.AUTO_PREVENT_DEFAULT=!0,e.RAD_TO_DEG=180/Math.PI,e.DEG_TO_RAD=Math.PI/180,e.Point=function(t,e){this.x=t||0,this.y=e||0},e.Point.prototype.clone=function(){return new e.Point(this.x,this.y)},e.Point.prototype.constructor=e.Point,e.Point.prototype.set=function(t,e){this.x=t||0,this.y=e||(0!==e?this.x:0)},e.Rectangle=function(t,e,i,n){this.x=t||0,this.y=e||0,this.width=i||0,this.height=n||0},e.Rectangle.prototype.clone=function(){return new e.Rectangle(this.x,this.y,this.width,this.height)},e.Rectangle.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var i=this.x;if(t>=i&&t<=i+this.width){var n=this.y;if(e>=n&&e<=n+this.height)return!0}return!1},e.Rectangle.prototype.constructor=e.Rectangle,e.EmptyRectangle=new e.Rectangle(0,0,0,0),e.Polygon=function(t){if(t instanceof Array||(t=Array.prototype.slice.call(arguments)),"number"==typeof t[0]){for(var i=[],n=0,o=t.length;o>n;n+=2)i.push(new e.Point(t[n],t[n+1]));t=i}this.points=t},e.Polygon.prototype.clone=function(){for(var t=[],i=0;i<this.points.length;i++)t.push(this.points[i].clone());return new e.Polygon(t)},e.Polygon.prototype.contains=function(t,e){for(var i=!1,n=0,o=this.points.length-1;n<this.points.length;o=n++){var r=this.points[n].x,s=this.points[n].y,a=this.points[o].x,h=this.points[o].y,l=s>e!=h>e&&(a-r)*(e-s)/(h-s)+r>t;l&&(i=!i)}return i},e.Polygon.prototype.constructor=e.Polygon,e.Circle=function(t,e,i){this.x=t||0,this.y=e||0,this.radius=i||0},e.Circle.prototype.clone=function(){return new e.Circle(this.x,this.y,this.radius)},e.Circle.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.x-t,n=this.y-e,o=this.radius*this.radius;return i*=i,n*=n,o>=i+n},e.Circle.prototype.constructor=e.Circle,e.Ellipse=function(t,e,i,n){this.x=t||0,this.y=e||0,this.width=i||0,this.height=n||0},e.Ellipse.prototype.clone=function(){return new e.Ellipse(this.x,this.y,this.width,this.height)},e.Ellipse.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,n=(e-this.y)/this.height;return i*=i,n*=n,1>=i+n},e.Ellipse.prototype.getBounds=function(){return new e.Rectangle(this.x,this.y,this.width,this.height)},e.Ellipse.prototype.constructor=e.Ellipse,e.determineMatrixArrayType=function(){return"undefined"!=typeof Float32Array?Float32Array:Array},e.Matrix2=e.determineMatrixArrayType(),e.Matrix=function(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0},e.Matrix.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},e.Matrix.prototype.toArray=function(t){this.array||(this.array=new Float32Array(9));var e=this.array;return t?(this.array[0]=this.a,this.array[1]=this.c,this.array[2]=0,this.array[3]=this.b,this.array[4]=this.d,this.array[5]=0,this.array[6]=this.tx,this.array[7]=this.ty,this.array[8]=1):(this.array[0]=this.a,this.array[1]=this.b,this.array[2]=this.tx,this.array[3]=this.c,this.array[4]=this.d,this.array[5]=this.ty,this.array[6]=0,this.array[7]=0,this.array[8]=1),e},e.identityMatrix=new e.Matrix,e.DisplayObject=function(){this.position=new e.Point,this.scale=new e.Point(1,1),this.pivot=new e.Point(0,0),this.rotation=0,this.alpha=1,this.visible=!0,this.hitArea=null,this.buttonMode=!1,this.renderable=!1,this.parent=null,this.stage=null,this.worldAlpha=1,this._interactive=!1,this.defaultCursor="pointer",this.worldTransform=new e.Matrix,this.color=[],this.dynamic=!0,this._sr=0,this._cr=1,this.filterArea=null,this._bounds=new e.Rectangle(0,0,1,1),this._currentBounds=null,this._mask=null,this._cacheAsBitmap=!1,this._cacheIsDirty=!1},e.DisplayObject.prototype.constructor=e.DisplayObject,e.DisplayObject.prototype.setInteractive=function(t){this.interactive=t},Object.defineProperty(e.DisplayObject.prototype,"interactive",{get:function(){return this._interactive},set:function(t){this._interactive=t,this.stage&&(this.stage.dirty=!0)}}),Object.defineProperty(e.DisplayObject.prototype,"worldVisible",{get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}}),Object.defineProperty(e.DisplayObject.prototype,"mask",{get:function(){return this._mask},set:function(t){this._mask&&(this._mask.isMask=!1),this._mask=t,this._mask&&(this._mask.isMask=!0)}}),Object.defineProperty(e.DisplayObject.prototype,"filters",{get:function(){return this._filters},set:function(t){if(t){for(var e=[],i=0;i<t.length;i++)for(var n=t[i].passes,o=0;o<n.length;o++)e.push(n[o]);this._filterBlock={target:this,filterPasses:e}}this._filters=t}}),Object.defineProperty(e.DisplayObject.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(t){this._cacheAsBitmap!==t&&(t?this._generateCachedSprite():this._destroyCachedSprite(),this._cacheAsBitmap=t)}}),e.DisplayObject.prototype.updateTransform=function(){this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation));var t=this.parent.worldTransform,e=this.worldTransform,i=this.pivot.x,n=this.pivot.y,o=this._cr*this.scale.x,r=-this._sr*this.scale.y,s=this._sr*this.scale.x,a=this._cr*this.scale.y,h=this.position.x-o*i-n*r,l=this.position.y-a*n-i*s,u=t.a,c=t.b,p=t.c,d=t.d;e.a=u*o+c*s,e.b=u*r+c*a,e.tx=u*h+c*l+t.tx,e.c=p*o+d*s,e.d=p*r+d*a,e.ty=p*h+d*l+t.ty,this.worldAlpha=this.alpha*this.parent.worldAlpha},e.DisplayObject.prototype.getBounds=function(t){return t=t,e.EmptyRectangle},e.DisplayObject.prototype.getLocalBounds=function(){return this.getBounds(e.identityMatrix)},e.DisplayObject.prototype.setStageReference=function(t){this.stage=t,this._interactive&&(this.stage.dirty=!0)},e.DisplayObject.prototype.generateTexture=function(t){var i=this.getLocalBounds(),n=new e.RenderTexture(0|i.width,0|i.height,t);return n.render(this,new e.Point(-i.x,-i.y)),n},e.DisplayObject.prototype.updateCache=function(){this._generateCachedSprite()},e.DisplayObject.prototype._renderCachedSprite=function(t){t.gl?e.Sprite.prototype._renderWebGL.call(this._cachedSprite,t):e.Sprite.prototype._renderCanvas.call(this._cachedSprite,t)},e.DisplayObject.prototype._generateCachedSprite=function(){this._cacheAsBitmap=!1;var t=this.getLocalBounds();if(this._cachedSprite)this._cachedSprite.texture.resize(0|t.width,0|t.height);else{var i=new e.RenderTexture(0|t.width,0|t.height);this._cachedSprite=new e.Sprite(i),this._cachedSprite.worldTransform=this.worldTransform}var n=this._filters;this._filters=null,this._cachedSprite.filters=n,this._cachedSprite.texture.render(this,new e.Point(-t.x,-t.y)),this._cachedSprite.anchor.x=-(t.x/t.width),this._cachedSprite.anchor.y=-(t.y/t.height),this._filters=n,this._cacheAsBitmap=!0},e.DisplayObject.prototype._destroyCachedSprite=function(){this._cachedSprite&&(this._cachedSprite.texture.destroy(!0),this._cachedSprite=null)},e.DisplayObject.prototype._renderWebGL=function(t){t=t},e.DisplayObject.prototype._renderCanvas=function(t){t=t},Object.defineProperty(e.DisplayObject.prototype,"x",{get:function(){return this.position.x},set:function(t){this.position.x=t}}),Object.defineProperty(e.DisplayObject.prototype,"y",{get:function(){return this.position.y},set:function(t){this.position.y=t}}),e.DisplayObjectContainer=function(){e.DisplayObject.call(this),this.children=[]},e.DisplayObjectContainer.prototype=Object.create(e.DisplayObject.prototype),e.DisplayObjectContainer.prototype.constructor=e.DisplayObjectContainer,e.DisplayObjectContainer.prototype.addChild=function(t){this.addChildAt(t,this.children.length)},e.DisplayObjectContainer.prototype.addChildAt=function(t,e){if(!(e>=0&&e<=this.children.length))throw new Error(t+" The index "+e+" supplied is out of bounds "+this.children.length);t.parent&&t.parent.removeChild(t),t.parent=this,this.children.splice(e,0,t),this.stage&&t.setStageReference(this.stage)},e.DisplayObjectContainer.prototype.swapChildren=function(t,e){if(t!==e){var i=this.children.indexOf(t),n=this.children.indexOf(e);if(0>i||0>n)throw new Error("swapChildren: Both the supplied DisplayObjects must be a child of the caller.");this.children[i]=e,this.children[n]=t}},e.DisplayObjectContainer.prototype.getChildAt=function(t){if(t>=0&&t<this.children.length)return this.children[t];throw new Error("Supplied index does not exist in the child list, or the supplied DisplayObject must be a child of the caller")},e.DisplayObjectContainer.prototype.removeChild=function(t){return this.removeChildAt(this.children.indexOf(t))},e.DisplayObjectContainer.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return this.stage&&e.removeStageReference(),e.parent=void 0,this.children.splice(t,1),e},e.DisplayObjectContainer.prototype.removeChildren=function(t,e){var i=t||0,n="number"==typeof e?e:this.children.length,o=n-i;if(o>0&&n>=o){for(var r=this.children.splice(i,o),s=0;s<r.length;s++){var a=r[s];this.stage&&a.removeStageReference(),a.parent=void 0}return r}throw new Error("Range Error, numeric values are outside the acceptable range")},e.DisplayObjectContainer.prototype.updateTransform=function(){if(this.visible&&(e.DisplayObject.prototype.updateTransform.call(this),!this._cacheAsBitmap))for(var t=0,i=this.children.length;i>t;t++)this.children[t].updateTransform()},e.DisplayObjectContainer.prototype.getBounds=function(t){if(0===this.children.length)return e.EmptyRectangle;if(t){var i=this.worldTransform;this.worldTransform=t,this.updateTransform(),this.worldTransform=i}for(var n,o,r,s=1/0,a=1/0,h=-1/0,l=-1/0,u=!1,c=0,p=this.children.length;p>c;c++){var d=this.children[c];d.visible&&(u=!0,n=this.children[c].getBounds(t),s=s<n.x?s:n.x,a=a<n.y?a:n.y,o=n.width+n.x,r=n.height+n.y,h=h>o?h:o,l=l>r?l:r)}if(!u)return e.EmptyRectangle;var f=this._bounds;return f.x=s,f.y=a,f.width=h-s,f.height=l-a,f},e.DisplayObjectContainer.prototype.getLocalBounds=function(){var t=this.worldTransform;this.worldTransform=e.identityMatrix;for(var i=0,n=this.children.length;n>i;i++)this.children[i].updateTransform();var o=this.getBounds();return this.worldTransform=t,o},e.DisplayObjectContainer.prototype.setStageReference=function(t){this.stage=t,this._interactive&&(this.stage.dirty=!0);for(var e=0,i=this.children.length;i>e;e++){var n=this.children[e];n.setStageReference(t)}},e.DisplayObjectContainer.prototype.removeStageReference=function(){for(var t=0,e=this.children.length;e>t;t++){var i=this.children[t];i.removeStageReference()}this._interactive&&(this.stage.dirty=!0),this.stage=null},e.DisplayObjectContainer.prototype._renderWebGL=function(t){if(this.visible&&!(this.alpha<=0)){if(this._cacheAsBitmap)return void this._renderCachedSprite(t);var e,i;if(this._mask||this._filters){for(this._mask&&(t.spriteBatch.stop(),t.maskManager.pushMask(this.mask,t),t.spriteBatch.start()),this._filters&&(t.spriteBatch.flush(),t.filterManager.pushFilter(this._filterBlock)),e=0,i=this.children.length;i>e;e++)this.children[e]._renderWebGL(t);t.spriteBatch.stop(),this._filters&&t.filterManager.popFilter(),this._mask&&t.maskManager.popMask(t),t.spriteBatch.start()}else for(e=0,i=this.children.length;i>e;e++)this.children[e]._renderWebGL(t)}},e.DisplayObjectContainer.prototype._renderCanvas=function(t){if(this.visible!==!1&&0!==this.alpha){if(this._cacheAsBitmap)return void this._renderCachedSprite(t);this._mask&&t.maskManager.pushMask(this._mask,t.context);for(var e=0,i=this.children.length;i>e;e++){var n=this.children[e];n._renderCanvas(t)}this._mask&&t.maskManager.popMask(t.context)}},e.Sprite=function(t){e.DisplayObjectContainer.call(this),this.anchor=new e.Point,this.texture=t,this._width=0,this._height=0,this.tint=16777215,this.blendMode=e.blendModes.NORMAL,t.baseTexture.hasLoaded?this.onTextureUpdate():(this.onTextureUpdateBind=this.onTextureUpdate.bind(this),this.texture.addEventListener("update",this.onTextureUpdateBind)),this.renderable=!0},e.Sprite.prototype=Object.create(e.DisplayObjectContainer.prototype),e.Sprite.prototype.constructor=e.Sprite,Object.defineProperty(e.Sprite.prototype,"width",{get:function(){return this.scale.x*this.texture.frame.width},set:function(t){this.scale.x=t/this.texture.frame.width,this._width=t}}),Object.defineProperty(e.Sprite.prototype,"height",{get:function(){return this.scale.y*this.texture.frame.height},set:function(t){this.scale.y=t/this.texture.frame.height,this._height=t}}),e.Sprite.prototype.setTexture=function(t){this.texture.baseTexture!==t.baseTexture?(this.textureChange=!0,this.texture=t):this.texture=t,this.cachedTint=16777215,this.updateFrame=!0},e.Sprite.prototype.onTextureUpdate=function(){this._width&&(this.scale.x=this._width/this.texture.frame.width),this._height&&(this.scale.y=this._height/this.texture.frame.height),this.updateFrame=!0},e.Sprite.prototype.getBounds=function(t){var e=this.texture.frame.width,i=this.texture.frame.height,n=e*(1-this.anchor.x),o=e*-this.anchor.x,r=i*(1-this.anchor.y),s=i*-this.anchor.y,a=t||this.worldTransform,h=a.a,l=a.c,u=a.b,c=a.d,p=a.tx,d=a.ty,f=h*o+u*s+p,g=c*s+l*o+d,m=h*n+u*s+p,y=c*s+l*n+d,v=h*n+u*r+p,b=c*r+l*n+d,x=h*o+u*r+p,w=c*r+l*o+d,S=-1/0,C=-1/0,T=1/0,_=1/0;T=T>f?f:T,T=T>m?m:T,T=T>v?v:T,T=T>x?x:T,_=_>g?g:_,_=_>y?y:_,_=_>b?b:_,_=_>w?w:_,S=f>S?f:S,S=m>S?m:S,S=v>S?v:S,S=x>S?x:S,C=g>C?g:C,C=y>C?y:C,C=b>C?b:C,C=w>C?w:C;var M=this._bounds;return M.x=T,M.width=S-T,M.y=_,M.height=C-_,this._currentBounds=M,M},e.Sprite.prototype._renderWebGL=function(t){if(this.visible&&!(this.alpha<=0)){var e,i;if(this._mask||this._filters){var n=t.spriteBatch;for(this._mask&&(n.stop(),t.maskManager.pushMask(this.mask,t),n.start()),this._filters&&(n.flush(),t.filterManager.pushFilter(this._filterBlock)),n.render(this),e=0,i=this.children.length;i>e;e++)this.children[e]._renderWebGL(t);n.stop(),this._filters&&t.filterManager.popFilter(),this._mask&&t.maskManager.popMask(t),n.start()}else for(t.spriteBatch.render(this),e=0,i=this.children.length;i>e;e++)this.children[e]._renderWebGL(t)}},e.Sprite.prototype._renderCanvas=function(t){if(this.visible!==!1&&0!==this.alpha){var i=this.texture.frame,n=t.context,o=this.texture;if(this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,n.globalCompositeOperation=e.blendModesCanvas[t.currentBlendMode]),this._mask&&t.maskManager.pushMask(this._mask,t.context),i&&i.width&&i.height&&o.baseTexture.source){n.globalAlpha=this.worldAlpha;var r=this.worldTransform;if(t.roundPixels?n.setTransform(r.a,r.c,r.b,r.d,0|r.tx,0|r.ty):n.setTransform(r.a,r.c,r.b,r.d,r.tx,r.ty),t.smoothProperty&&t.scaleMode!==this.texture.baseTexture.scaleMode&&(t.scaleMode=this.texture.baseTexture.scaleMode,n[t.smoothProperty]=t.scaleMode===e.scaleModes.LINEAR),16777215!==this.tint){if(this.cachedTint!==this.tint){if(!o.baseTexture.hasLoaded)return;this.cachedTint=this.tint,this.tintedTexture=e.CanvasTinter.getTintedTexture(this,this.tint)}n.drawImage(this.tintedTexture,0,0,i.width,i.height,this.anchor.x*-i.width,this.anchor.y*-i.height,i.width,i.height)}else if(o.trim){var s=o.trim;n.drawImage(this.texture.baseTexture.source,i.x,i.y,i.width,i.height,s.x-this.anchor.x*s.width,s.y-this.anchor.y*s.height,i.width,i.height)}else n.drawImage(this.texture.baseTexture.source,i.x,i.y,i.width,i.height,this.anchor.x*-i.width,this.anchor.y*-i.height,i.width,i.height)}for(var a=0,h=this.children.length;h>a;a++){var l=this.children[a];l._renderCanvas(t)}this._mask&&t.maskManager.popMask(t.context)}},e.Sprite.fromFrame=function(t){var i=e.TextureCache[t];if(!i)throw new Error('The frameId "'+t+'" does not exist in the texture cache'+this);return new e.Sprite(i)},e.Sprite.fromImage=function(t,i,n){var o=e.Texture.fromImage(t,i,n);return new e.Sprite(o)},e.SpriteBatch=function(t){e.DisplayObjectContainer.call(this),this.textureThing=t,this.ready=!1},e.SpriteBatch.prototype=Object.create(e.DisplayObjectContainer.prototype),e.SpriteBatch.constructor=e.SpriteBatch,e.SpriteBatch.prototype.initWebGL=function(t){this.fastSpriteBatch=new e.WebGLFastSpriteBatch(t),this.ready=!0},e.SpriteBatch.prototype.updateTransform=function(){e.DisplayObject.prototype.updateTransform.call(this)},e.SpriteBatch.prototype._renderWebGL=function(t){!this.visible||this.alpha<=0||!this.children.length||(this.ready||this.initWebGL(t.gl),t.spriteBatch.stop(),t.shaderManager.activateShader(t.shaderManager.fastShader),this.fastSpriteBatch.begin(this,t),this.fastSpriteBatch.render(this),t.shaderManager.activateShader(t.shaderManager.defaultShader),t.spriteBatch.start())},e.SpriteBatch.prototype._renderCanvas=function(t){var i=t.context;i.globalAlpha=this.worldAlpha,e.DisplayObject.prototype.updateTransform.call(this);for(var n=this.worldTransform,o=!0,r=0;r<this.children.length;r++){var s=this.children[r];if(s.visible){var a=s.texture,h=a.frame;if(i.globalAlpha=this.worldAlpha*s.alpha,s.rotation%(2*Math.PI)===0)o&&(i.setTransform(n.a,n.c,n.b,n.d,n.tx,n.ty),o=!1),i.drawImage(a.baseTexture.source,h.x,h.y,h.width,h.height,s.anchor.x*-h.width*s.scale.x+s.position.x+.5|0,s.anchor.y*-h.height*s.scale.y+s.position.y+.5|0,h.width*s.scale.x,h.height*s.scale.y);else{o||(o=!0),e.DisplayObject.prototype.updateTransform.call(s);var l=s.worldTransform;t.roundPixels?i.setTransform(l.a,l.c,l.b,l.d,0|l.tx,0|l.ty):i.setTransform(l.a,l.c,l.b,l.d,l.tx,l.ty),i.drawImage(a.baseTexture.source,h.x,h.y,h.width,h.height,s.anchor.x*-h.width+.5|0,s.anchor.y*-h.height+.5|0,h.width,h.height)}}}},e.MovieClip=function(t){e.Sprite.call(this,t[0]),this.textures=t,this.animationSpeed=1,this.loop=!0,this.onComplete=null,this.currentFrame=0,this.playing=!1},e.MovieClip.prototype=Object.create(e.Sprite.prototype),e.MovieClip.prototype.constructor=e.MovieClip,Object.defineProperty(e.MovieClip.prototype,"totalFrames",{get:function(){return this.textures.length}}),e.MovieClip.prototype.stop=function(){this.playing=!1},e.MovieClip.prototype.play=function(){this.playing=!0},e.MovieClip.prototype.gotoAndStop=function(t){this.playing=!1,this.currentFrame=t;var e=this.currentFrame+.5|0;this.setTexture(this.textures[e%this.textures.length])},e.MovieClip.prototype.gotoAndPlay=function(t){this.currentFrame=t,this.playing=!0},e.MovieClip.prototype.updateTransform=function(){if(e.Sprite.prototype.updateTransform.call(this),this.playing){this.currentFrame+=this.animationSpeed;var t=this.currentFrame+.5|0;this.loop||t<this.textures.length?this.setTexture(this.textures[t%this.textures.length]):t>=this.textures.length&&(this.gotoAndStop(this.textures.length-1),this.onComplete&&this.onComplete())}},e.MovieClip.prototype.fromFrames=function(t){for(var i=[],n=0;n<t.length;n++)i.push(new e.Texture.fromFrame(t[n]));return new e.MovieClip(i)},e.MovieClip.prototype.fromImages=function(t){for(var i=[],n=0;n<t.length;n++)i.push(new e.Texture.fromImage(t[n]));return new e.MovieClip(i)},e.FilterBlock=function(){this.visible=!0,this.renderable=!0},e.Text=function(t,i){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),e.Sprite.call(this,e.Texture.fromCanvas(this.canvas)),this.setText(t),this.setStyle(i),this.updateText(),this.dirty=!1},e.Text.prototype=Object.create(e.Sprite.prototype),e.Text.prototype.constructor=e.Text,e.Text.prototype.setStyle=function(t){t=t||{},t.font=t.font||"bold 20pt Arial",t.fill=t.fill||"black",t.align=t.align||"left",t.stroke=t.stroke||"black",t.strokeThickness=t.strokeThickness||0,t.wordWrap=t.wordWrap||!1,t.wordWrapWidth=t.wordWrapWidth||100,t.wordWrapWidth=t.wordWrapWidth||100,t.dropShadow=t.dropShadow||!1,t.dropShadowAngle=t.dropShadowAngle||Math.PI/6,t.dropShadowDistance=t.dropShadowDistance||4,t.dropShadowColor=t.dropShadowColor||"black",this.style=t,this.dirty=!0},e.Text.prototype.setText=function(t){this.text=t.toString()||" ",this.dirty=!0},e.Text.prototype.updateText=function(){this.context.font=this.style.font;var t=this.text;this.style.wordWrap&&(t=this.wordWrap(this.text));for(var e=t.split(/(?:\r\n|\r|\n)/),i=[],n=0,o=0;o<e.length;o++){var r=this.context.measureText(e[o]).width;i[o]=r,n=Math.max(n,r)}var s=n+this.style.strokeThickness;this.style.dropShadow&&(s+=this.style.dropShadowDistance),this.canvas.width=s+this.context.lineWidth;var a=this.determineFontHeight("font: "+this.style.font+";")+this.style.strokeThickness,h=a*e.length;this.style.dropShadow&&(h+=this.style.dropShadowDistance),this.canvas.height=h,navigator.isCocoonJS&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.font=this.style.font,this.context.strokeStyle=this.style.stroke,this.context.lineWidth=this.style.strokeThickness,this.context.textBaseline="top";var l,u;if(this.style.dropShadow){this.context.fillStyle=this.style.dropShadowColor;var c=Math.sin(this.style.dropShadowAngle)*this.style.dropShadowDistance,p=Math.cos(this.style.dropShadowAngle)*this.style.dropShadowDistance;for(o=0;o<e.length;o++)l=this.style.strokeThickness/2,u=this.style.strokeThickness/2+o*a,"right"===this.style.align?l+=n-i[o]:"center"===this.style.align&&(l+=(n-i[o])/2),this.style.fill&&this.context.fillText(e[o],l+c,u+p)}for(this.context.fillStyle=this.style.fill,o=0;o<e.length;o++)l=this.style.strokeThickness/2,u=this.style.strokeThickness/2+o*a,"right"===this.style.align?l+=n-i[o]:"center"===this.style.align&&(l+=(n-i[o])/2),this.style.stroke&&this.style.strokeThickness&&this.context.strokeText(e[o],l,u),this.style.fill&&this.context.fillText(e[o],l,u);this.updateTexture()},e.Text.prototype.updateTexture=function(){this.texture.baseTexture.width=this.canvas.width,this.texture.baseTexture.height=this.canvas.height,this.texture.frame.width=this.canvas.width,this.texture.frame.height=this.canvas.height,this._width=this.canvas.width,this._height=this.canvas.height,this.requiresUpdate=!0},e.Text.prototype._renderWebGL=function(t){this.requiresUpdate&&(this.requiresUpdate=!1,e.updateWebGLTexture(this.texture.baseTexture,t.gl)),e.Sprite.prototype._renderWebGL.call(this,t)},e.Text.prototype.updateTransform=function(){this.dirty&&(this.updateText(),this.dirty=!1),e.Sprite.prototype.updateTransform.call(this)},e.Text.prototype.determineFontHeight=function(t){var i=e.Text.heightCache[t];if(!i){var n=document.getElementsByTagName("body")[0],o=document.createElement("div"),r=document.createTextNode("M");o.appendChild(r),o.setAttribute("style",t+";position:absolute;top:0;left:0"),n.appendChild(o),i=o.offsetHeight,e.Text.heightCache[t]=i,n.removeChild(o)}return i},e.Text.prototype.wordWrap=function(t){for(var e="",i=t.split("\n"),n=0;n<i.length;n++){for(var o=this.style.wordWrapWidth,r=i[n].split(" "),s=0;s<r.length;s++){var a=this.context.measureText(r[s]).width,h=a+this.context.measureText(" ").width;0===s||h>o?(s>0&&(e+="\n"),e+=r[s],o=this.style.wordWrapWidth-a):(o-=h,e+=" "+r[s])}n<i.length-1&&(e+="\n")}return e},e.Text.prototype.destroy=function(t){t&&this.texture.destroy()},e.Text.heightCache={},e.BitmapText=function(t,i){e.DisplayObjectContainer.call(this),this._pool=[],this.setText(t),this.setStyle(i),this.updateText(),this.dirty=!1},e.BitmapText.prototype=Object.create(e.DisplayObjectContainer.prototype),e.BitmapText.prototype.constructor=e.BitmapText,e.BitmapText.prototype.setText=function(t){this.text=t||" ",this.dirty=!0},e.BitmapText.prototype.setStyle=function(t){t=t||{},t.align=t.align||"left",this.style=t;var i=t.font.split(" ");this.fontName=i[i.length-1],this.fontSize=i.length>=2?parseInt(i[i.length-2],10):e.BitmapText.fonts[this.fontName].size,this.dirty=!0,this.tint=t.tint},e.BitmapText.prototype.updateText=function(){for(var t=e.BitmapText.fonts[this.fontName],i=new e.Point,n=null,o=[],r=0,s=[],a=0,h=this.fontSize/t.size,l=0;l<this.text.length;l++){var u=this.text.charCodeAt(l);if(/(?:\r\n|\r|\n)/.test(this.text.charAt(l)))s.push(i.x),r=Math.max(r,i.x),a++,i.x=0,i.y+=t.lineHeight,n=null;else{var c=t.chars[u];c&&(n&&c[n]&&(i.x+=c.kerning[n]),o.push({texture:c.texture,line:a,charCode:u,position:new e.Point(i.x+c.xOffset,i.y+c.yOffset)}),i.x+=c.xAdvance,n=u)}}s.push(i.x),r=Math.max(r,i.x);var p=[];for(l=0;a>=l;l++){var d=0;"right"===this.style.align?d=r-s[l]:"center"===this.style.align&&(d=(r-s[l])/2),p.push(d)}var f=this.children.length,g=o.length,m=this.tint||16777215;for(l=0;g>l;l++){var y=f>l?this.children[l]:this._pool.pop();y?y.setTexture(o[l].texture):y=new e.Sprite(o[l].texture),y.position.x=(o[l].position.x+p[o[l].line])*h,y.position.y=o[l].position.y*h,y.scale.x=y.scale.y=h,y.tint=m,y.parent||this.addChild(y)}for(;this.children.length>g;){var v=this.getChildAt(this.children.length-1);this._pool.push(v),this.removeChild(v)}this.textWidth=r*h,this.textHeight=(i.y+t.lineHeight)*h},e.BitmapText.prototype.updateTransform=function(){this.dirty&&(this.updateText(),this.dirty=!1),e.DisplayObjectContainer.prototype.updateTransform.call(this)},e.BitmapText.fonts={},e.InteractionData=function(){this.global=new e.Point,this.target=null,this.originalEvent=null},e.InteractionData.prototype.getLocalPosition=function(t){var i=t.worldTransform,n=this.global,o=i.a,r=i.b,s=i.tx,a=i.c,h=i.d,l=i.ty,u=1/(o*h+r*-a);return new e.Point(h*u*n.x+-r*u*n.y+(l*r-s*h)*u,o*u*n.y+-a*u*n.x+(-l*o+s*a)*u)},e.InteractionData.prototype.constructor=e.InteractionData,e.InteractionManager=function(t){this.stage=t,this.mouse=new e.InteractionData,this.touchs={},this.tempPoint=new e.Point,this.mouseoverEnabled=!0,this.pool=[],this.interactiveItems=[],this.interactionDOMElement=null,this.onMouseMove=this.onMouseMove.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.last=0,this.currentCursorStyle="inherit",this.mouseOut=!1},e.InteractionManager.prototype.constructor=e.InteractionManager,e.InteractionManager.prototype.collectInteractiveSprite=function(t,e){for(var i=t.children,n=i.length,o=n-1;o>=0;o--){var r=i[o];r._interactive?(e.interactiveChildren=!0,this.interactiveItems.push(r),r.children.length>0&&this.collectInteractiveSprite(r,r)):(r.__iParent=null,r.children.length>0&&this.collectInteractiveSprite(r,e))}},e.InteractionManager.prototype.setTarget=function(t){this.target=t,null===this.interactionDOMElement&&this.setTargetDomElement(t.view)},e.InteractionManager.prototype.setTargetDomElement=function(t){this.removeEvents(),window.navigator.msPointerEnabled&&(t.style["-ms-content-zooming"]="none",t.style["-ms-touch-action"]="none"),this.interactionDOMElement=t,t.addEventListener("mousemove",this.onMouseMove,!0),t.addEventListener("mousedown",this.onMouseDown,!0),t.addEventListener("mouseout",this.onMouseOut,!0),t.addEventListener("touchstart",this.onTouchStart,!0),t.addEventListener("touchend",this.onTouchEnd,!0),t.addEventListener("touchmove",this.onTouchMove,!0),window.addEventListener("mouseup",this.onMouseUp,!0)},e.InteractionManager.prototype.removeEvents=function(){this.interactionDOMElement&&(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]="",this.interactionDOMElement.removeEventListener("mousemove",this.onMouseMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onMouseDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onMouseOut,!0),this.interactionDOMElement.removeEventListener("touchstart",this.onTouchStart,!0),this.interactionDOMElement.removeEventListener("touchend",this.onTouchEnd,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onTouchMove,!0),this.interactionDOMElement=null,window.removeEventListener("mouseup",this.onMouseUp,!0))},e.InteractionManager.prototype.update=function(){if(this.target){var t=Date.now(),i=t-this.last;if(i=i*e.INTERACTION_FREQUENCY/1e3,!(1>i)){this.last=t;var n=0;if(this.dirty){this.dirty=!1;var o=this.interactiveItems.length;for(n=0;o>n;n++)this.interactiveItems[n].interactiveChildren=!1;this.interactiveItems=[],this.stage.interactive&&this.interactiveItems.push(this.stage),this.collectInteractiveSprite(this.stage,this.stage)}var r=this.interactiveItems.length,s="inherit",a=!1;for(n=0;r>n;n++){var h=this.interactiveItems[n];h.__hit=this.hitTest(h,this.mouse),this.mouse.target=h,h.__hit&&!a?(h.buttonMode&&(s=h.defaultCursor),h.interactiveChildren||(a=!0),h.__isOver||(h.mouseover&&h.mouseover(this.mouse),h.__isOver=!0)):h.__isOver&&(h.mouseout&&h.mouseout(this.mouse),h.__isOver=!1)}this.currentCursorStyle!==s&&(this.currentCursorStyle=s,this.interactionDOMElement.style.cursor=s)}}},e.InteractionManager.prototype.onMouseMove=function(t){this.mouse.originalEvent=t||window.event;var e=this.interactionDOMElement.getBoundingClientRect();this.mouse.global.x=(t.clientX-e.left)*(this.target.width/e.width),this.mouse.global.y=(t.clientY-e.top)*(this.target.height/e.height);for(var i=this.interactiveItems.length,n=0;i>n;n++){var o=this.interactiveItems[n];o.mousemove&&o.mousemove(this.mouse)}},e.InteractionManager.prototype.onMouseDown=function(t){this.mouse.originalEvent=t||window.event,e.AUTO_PREVENT_DEFAULT&&this.mouse.originalEvent.preventDefault();for(var i=this.interactiveItems.length,n=0;i>n;n++){var o=this.interactiveItems[n];if((o.mousedown||o.click)&&(o.__mouseIsDown=!0,o.__hit=this.hitTest(o,this.mouse),o.__hit&&(o.mousedown&&o.mousedown(this.mouse),o.__isDown=!0,!o.interactiveChildren)))break
}},e.InteractionManager.prototype.onMouseOut=function(){var t=this.interactiveItems.length;this.interactionDOMElement.style.cursor="inherit";for(var e=0;t>e;e++){var i=this.interactiveItems[e];i.__isOver&&(this.mouse.target=i,i.mouseout&&i.mouseout(this.mouse),i.__isOver=!1)}this.mouseOut=!0,this.mouse.global.x=-1e4,this.mouse.global.y=-1e4},e.InteractionManager.prototype.onMouseUp=function(t){this.mouse.originalEvent=t||window.event;for(var e=this.interactiveItems.length,i=!1,n=0;e>n;n++){var o=this.interactiveItems[n];o.__hit=this.hitTest(o,this.mouse),o.__hit&&!i?(o.mouseup&&o.mouseup(this.mouse),o.__isDown&&o.click&&o.click(this.mouse),o.interactiveChildren||(i=!0)):o.__isDown&&o.mouseupoutside&&o.mouseupoutside(this.mouse),o.__isDown=!1}},e.InteractionManager.prototype.hitTest=function(t,i){var n=i.global;if(!t.worldVisible)return!1;var o=t instanceof e.Sprite,r=t.worldTransform,s=r.a,a=r.b,h=r.tx,l=r.c,u=r.d,c=r.ty,p=1/(s*u+a*-l),d=u*p*n.x+-a*p*n.y+(c*a-h*u)*p,f=s*p*n.y+-l*p*n.x+(-c*s+h*l)*p;if(i.target=t,t.hitArea&&t.hitArea.contains)return t.hitArea.contains(d,f)?(i.target=t,!0):!1;if(o){var g,m=t.texture.frame.width,y=t.texture.frame.height,v=-m*t.anchor.x;if(d>v&&v+m>d&&(g=-y*t.anchor.y,f>g&&g+y>f))return i.target=t,!0}for(var b=t.children.length,x=0;b>x;x++){var w=t.children[x],S=this.hitTest(w,i);if(S)return i.target=t,!0}return!1},e.InteractionManager.prototype.onTouchMove=function(t){var e,i=this.interactionDOMElement.getBoundingClientRect(),n=t.changedTouches,o=0;for(o=0;o<n.length;o++){var r=n[o];e=this.touchs[r.identifier],e.originalEvent=t||window.event,e.global.x=(r.clientX-i.left)*(this.target.width/i.width),e.global.y=(r.clientY-i.top)*(this.target.height/i.height),navigator.isCocoonJS&&(e.global.x=r.clientX,e.global.y=r.clientY);for(var s=0;s<this.interactiveItems.length;s++){var a=this.interactiveItems[s];a.touchmove&&a.__touchData[r.identifier]&&a.touchmove(e)}}},e.InteractionManager.prototype.onTouchStart=function(t){var i=this.interactionDOMElement.getBoundingClientRect();e.AUTO_PREVENT_DEFAULT&&t.preventDefault();for(var n=t.changedTouches,o=0;o<n.length;o++){var r=n[o],s=this.pool.pop();s||(s=new e.InteractionData),s.originalEvent=t||window.event,this.touchs[r.identifier]=s,s.global.x=(r.clientX-i.left)*(this.target.width/i.width),s.global.y=(r.clientY-i.top)*(this.target.height/i.height),navigator.isCocoonJS&&(s.global.x=r.clientX,s.global.y=r.clientY);for(var a=this.interactiveItems.length,h=0;a>h;h++){var l=this.interactiveItems[h];if((l.touchstart||l.tap)&&(l.__hit=this.hitTest(l,s),l.__hit&&(l.touchstart&&l.touchstart(s),l.__isDown=!0,l.__touchData=l.__touchData||{},l.__touchData[r.identifier]=s,!l.interactiveChildren)))break}}},e.InteractionManager.prototype.onTouchEnd=function(t){for(var e=this.interactionDOMElement.getBoundingClientRect(),i=t.changedTouches,n=0;n<i.length;n++){var o=i[n],r=this.touchs[o.identifier],s=!1;r.global.x=(o.clientX-e.left)*(this.target.width/e.width),r.global.y=(o.clientY-e.top)*(this.target.height/e.height),navigator.isCocoonJS&&(r.global.x=o.clientX,r.global.y=o.clientY);for(var a=this.interactiveItems.length,h=0;a>h;h++){var l=this.interactiveItems[h];l.__touchData&&l.__touchData[o.identifier]&&(l.__hit=this.hitTest(l,l.__touchData[o.identifier]),r.originalEvent=t||window.event,(l.touchend||l.tap)&&(l.__hit&&!s?(l.touchend&&l.touchend(r),l.__isDown&&l.tap&&l.tap(r),l.interactiveChildren||(s=!0)):l.__isDown&&l.touchendoutside&&l.touchendoutside(r),l.__isDown=!1),l.__touchData[o.identifier]=null)}this.pool.push(r),this.touchs[o.identifier]=null}},e.Stage=function(t){e.DisplayObjectContainer.call(this),this.worldTransform=new e.Matrix,this.interactive=!0,this.interactionManager=new e.InteractionManager(this),this.dirty=!0,this.stage=this,this.stage.hitArea=new e.Rectangle(0,0,1e5,1e5),this.setBackgroundColor(t)},e.Stage.prototype=Object.create(e.DisplayObjectContainer.prototype),e.Stage.prototype.constructor=e.Stage,e.Stage.prototype.setInteractionDelegate=function(t){this.interactionManager.setTargetDomElement(t)},e.Stage.prototype.updateTransform=function(){this.worldAlpha=1;for(var t=0,e=this.children.length;e>t;t++)this.children[t].updateTransform();this.dirty&&(this.dirty=!1,this.interactionManager.dirty=!0),this.interactive&&this.interactionManager.update()},e.Stage.prototype.setBackgroundColor=function(t){this.backgroundColor=t||0,this.backgroundColorSplit=e.hex2rgb(this.backgroundColor);var i=this.backgroundColor.toString(16);i="000000".substr(0,6-i.length)+i,this.backgroundColorString="#"+i},e.Stage.prototype.getMousePosition=function(){return this.interactionManager.mouse.global};for(var i=0,n=["ms","moz","webkit","o"],o=0;o<n.length&&!window.requestAnimationFrame;++o)window.requestAnimationFrame=window[n[o]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[n[o]+"CancelAnimationFrame"]||window[n[o]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var e=(new Date).getTime(),n=Math.max(0,16-(e-i)),o=window.setTimeout(function(){t(e+n)},n);return i=e+n,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)}),window.requestAnimFrame=window.requestAnimationFrame,e.hex2rgb=function(t){return[(t>>16&255)/255,(t>>8&255)/255,(255&t)/255]},e.rgb2hex=function(t){return(255*t[0]<<16)+(255*t[1]<<8)+255*t[2]},"function"!=typeof Function.prototype.bind&&(Function.prototype.bind=function(){var t=Array.prototype.slice;return function(e){function i(){var r=o.concat(t.call(arguments));n.apply(this instanceof i?this:e,r)}var n=this,o=t.call(arguments,1);if("function"!=typeof n)throw new TypeError;return i.prototype=function r(t){return t&&(r.prototype=t),this instanceof r?void 0:new r}(n.prototype),i}}()),e.AjaxRequest=function(){var t=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"];if(!window.ActiveXObject)return window.XMLHttpRequest?new window.XMLHttpRequest:!1;for(var e=0;e<t.length;e++)try{return new window.ActiveXObject(t[e])}catch(i){}},e.canUseNewCanvasBlendModes=function(){var t=document.createElement("canvas");t.width=1,t.height=1;var e=t.getContext("2d");return e.fillStyle="#000",e.fillRect(0,0,1,1),e.globalCompositeOperation="multiply",e.fillStyle="#fff",e.fillRect(0,0,1,1),0===e.getImageData(0,0,1,1).data[0]},e.getNextPowerOfTwo=function(t){if(t>0&&0===(t&t-1))return t;for(var e=1;t>e;)e<<=1;return e},e.EventTarget=function(){var t={};this.addEventListener=this.on=function(e,i){void 0===t[e]&&(t[e]=[]),-1===t[e].indexOf(i)&&t[e].push(i)},this.dispatchEvent=this.emit=function(e){if(t[e.type]&&t[e.type].length)for(var i=0,n=t[e.type].length;n>i;i++)t[e.type][i](e)},this.removeEventListener=this.off=function(e,i){var n=t[e].indexOf(i);-1!==n&&t[e].splice(n,1)},this.removeAllEventListeners=function(e){var i=t[e];i&&(i.length=0)}},e.autoDetectRenderer=function(t,i,n,o,r){t||(t=800),i||(i=600);var s=function(){try{var t=document.createElement("canvas");return!!window.WebGLRenderingContext&&(t.getContext("webgl")||t.getContext("experimental-webgl"))}catch(e){return!1}}();return s?new e.WebGLRenderer(t,i,n,o,r):new e.CanvasRenderer(t,i,n,o)},e.autoDetectRecommendedRenderer=function(t,i,n,o,r){t||(t=800),i||(i=600);var s=function(){try{var t=document.createElement("canvas");return!!window.WebGLRenderingContext&&(t.getContext("webgl")||t.getContext("experimental-webgl"))}catch(e){return!1}}(),a=/Android/i.test(navigator.userAgent);return s&&!a?new e.WebGLRenderer(t,i,n,o,r):new e.CanvasRenderer(t,i,n,o)},e.PolyK={},e.PolyK.Triangulate=function(t){var i=!0,n=t.length>>1;if(3>n)return[];for(var o=[],r=[],s=0;n>s;s++)r.push(s);s=0;for(var a=n;a>3;){var h=r[(s+0)%a],l=r[(s+1)%a],u=r[(s+2)%a],c=t[2*h],p=t[2*h+1],d=t[2*l],f=t[2*l+1],g=t[2*u],m=t[2*u+1],y=!1;if(e.PolyK._convex(c,p,d,f,g,m,i)){y=!0;for(var v=0;a>v;v++){var b=r[v];if(b!==h&&b!==l&&b!==u&&e.PolyK._PointInTriangle(t[2*b],t[2*b+1],c,p,d,f,g,m)){y=!1;break}}}if(y)o.push(h,l,u),r.splice((s+1)%a,1),a--,s=0;else if(s++>3*a){if(!i)return window.console.log("PIXI Warning: shape too complex to fill"),[];for(o=[],r=[],s=0;n>s;s++)r.push(s);s=0,a=n,i=!1}}return o.push(r[0],r[1],r[2]),o},e.PolyK._PointInTriangle=function(t,e,i,n,o,r,s,a){var h=s-i,l=a-n,u=o-i,c=r-n,p=t-i,d=e-n,f=h*h+l*l,g=h*u+l*c,m=h*p+l*d,y=u*u+c*c,v=u*p+c*d,b=1/(f*y-g*g),x=(y*m-g*v)*b,w=(f*v-g*m)*b;return x>=0&&w>=0&&1>x+w},e.PolyK._convex=function(t,e,i,n,o,r,s){return(e-n)*(o-i)+(i-t)*(r-n)>=0===s},e.initDefaultShaders=function(){},e.CompileVertexShader=function(t,i){return e._CompileShader(t,i,t.VERTEX_SHADER)},e.CompileFragmentShader=function(t,i){return e._CompileShader(t,i,t.FRAGMENT_SHADER)},e._CompileShader=function(t,e,i){var n=e.join("\n"),o=t.createShader(i);return t.shaderSource(o,n),t.compileShader(o),t.getShaderParameter(o,t.COMPILE_STATUS)?o:(window.console.log(t.getShaderInfoLog(o)),null)},e.compileProgram=function(t,i,n){var o=e.CompileFragmentShader(t,n),r=e.CompileVertexShader(t,i),s=t.createProgram();return t.attachShader(s,r),t.attachShader(s,o),t.linkProgram(s),t.getProgramParameter(s,t.LINK_STATUS)||window.console.log("Could not initialise shaders"),s},e.PixiShader=function(t){this.gl=t,this.program=null,this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"],this.textureCount=0,this.attributes=[],this.init()},e.PixiShader.prototype.init=function(){var t=this.gl,i=e.compileProgram(t,this.vertexSrc||e.PixiShader.defaultVertexSrc,this.fragmentSrc);t.useProgram(i),this.uSampler=t.getUniformLocation(i,"uSampler"),this.projectionVector=t.getUniformLocation(i,"projectionVector"),this.offsetVector=t.getUniformLocation(i,"offsetVector"),this.dimensions=t.getUniformLocation(i,"dimensions"),this.aVertexPosition=t.getAttribLocation(i,"aVertexPosition"),this.aTextureCoord=t.getAttribLocation(i,"aTextureCoord"),this.colorAttribute=t.getAttribLocation(i,"aColor"),-1===this.colorAttribute&&(this.colorAttribute=2),this.attributes=[this.aVertexPosition,this.aTextureCoord,this.colorAttribute];for(var n in this.uniforms)this.uniforms[n].uniformLocation=t.getUniformLocation(i,n);this.initUniforms(),this.program=i},e.PixiShader.prototype.initUniforms=function(){this.textureCount=1;var t,e=this.gl;for(var i in this.uniforms){t=this.uniforms[i];var n=t.type;"sampler2D"===n?(t._init=!1,null!==t.value&&this.initSampler2D(t)):"mat2"===n||"mat3"===n||"mat4"===n?(t.glMatrix=!0,t.glValueLength=1,"mat2"===n?t.glFunc=e.uniformMatrix2fv:"mat3"===n?t.glFunc=e.uniformMatrix3fv:"mat4"===n&&(t.glFunc=e.uniformMatrix4fv)):(t.glFunc=e["uniform"+n],t.glValueLength="2f"===n||"2i"===n?2:"3f"===n||"3i"===n?3:"4f"===n||"4i"===n?4:1)}},e.PixiShader.prototype.initSampler2D=function(t){if(t.value&&t.value.baseTexture&&t.value.baseTexture.hasLoaded){var e=this.gl;if(e.activeTexture(e["TEXTURE"+this.textureCount]),e.bindTexture(e.TEXTURE_2D,t.value.baseTexture._glTextures[e.id]),t.textureData){var i=t.textureData,n=i.magFilter?i.magFilter:e.LINEAR,o=i.minFilter?i.minFilter:e.LINEAR,r=i.wrapS?i.wrapS:e.CLAMP_TO_EDGE,s=i.wrapT?i.wrapT:e.CLAMP_TO_EDGE,a=i.luminance?e.LUMINANCE:e.RGBA;if(i.repeat&&(r=e.REPEAT,s=e.REPEAT),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!!i.flipY),i.width){var h=i.width?i.width:512,l=i.height?i.height:2,u=i.border?i.border:0;e.texImage2D(e.TEXTURE_2D,0,a,h,l,u,a,e.UNSIGNED_BYTE,null)}else e.texImage2D(e.TEXTURE_2D,0,a,e.RGBA,e.UNSIGNED_BYTE,t.value.baseTexture.source);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,o),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,s)}e.uniform1i(t.uniformLocation,this.textureCount),t._init=!0,this.textureCount++}},e.PixiShader.prototype.syncUniforms=function(){this.textureCount=1;var t,i=this.gl;for(var n in this.uniforms)t=this.uniforms[n],1===t.glValueLength?t.glMatrix===!0?t.glFunc.call(i,t.uniformLocation,t.transpose,t.value):t.glFunc.call(i,t.uniformLocation,t.value):2===t.glValueLength?t.glFunc.call(i,t.uniformLocation,t.value.x,t.value.y):3===t.glValueLength?t.glFunc.call(i,t.uniformLocation,t.value.x,t.value.y,t.value.z):4===t.glValueLength?t.glFunc.call(i,t.uniformLocation,t.value.x,t.value.y,t.value.z,t.value.w):"sampler2D"===t.type&&(t._init?(i.activeTexture(i["TEXTURE"+this.textureCount]),i.bindTexture(i.TEXTURE_2D,t.value.baseTexture._glTextures[i.id]||e.createWebGLTexture(t.value.baseTexture,i)),i.uniform1i(t.uniformLocation,this.textureCount),this.textureCount++):this.initSampler2D(t))},e.PixiShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attributes=null},e.PixiShader.defaultVertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec2 aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","varying vec4 vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   gl_Position = vec4( ((aVertexPosition + offsetVector) / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vec3 color = mod(vec3(aColor.y/65536.0, aColor.y/256.0, aColor.y), 256.0) / 256.0;","   vColor = vec4(color * aColor.x, aColor.x);","}"],e.PixiFastShader=function(t){this.gl=t,this.program=null,this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aPositionCoord;","attribute vec2 aScale;","attribute float aRotation;","attribute vec2 aTextureCoord;","attribute float aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform mat3 uMatrix;","varying vec2 vTextureCoord;","varying float vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   vec2 v;","   vec2 sv = aVertexPosition * aScale;","   v.x = (sv.x) * cos(aRotation) - (sv.y) * sin(aRotation);","   v.y = (sv.x) * sin(aRotation) + (sv.y) * cos(aRotation);","   v = ( uMatrix * vec3(v + aPositionCoord , 1.0) ).xy ;","   gl_Position = vec4( ( v / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"],this.textureCount=0,this.init()},e.PixiFastShader.prototype.init=function(){var t=this.gl,i=e.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(i),this.uSampler=t.getUniformLocation(i,"uSampler"),this.projectionVector=t.getUniformLocation(i,"projectionVector"),this.offsetVector=t.getUniformLocation(i,"offsetVector"),this.dimensions=t.getUniformLocation(i,"dimensions"),this.uMatrix=t.getUniformLocation(i,"uMatrix"),this.aVertexPosition=t.getAttribLocation(i,"aVertexPosition"),this.aPositionCoord=t.getAttribLocation(i,"aPositionCoord"),this.aScale=t.getAttribLocation(i,"aScale"),this.aRotation=t.getAttribLocation(i,"aRotation"),this.aTextureCoord=t.getAttribLocation(i,"aTextureCoord"),this.colorAttribute=t.getAttribLocation(i,"aColor"),-1===this.colorAttribute&&(this.colorAttribute=2),this.attributes=[this.aVertexPosition,this.aPositionCoord,this.aScale,this.aRotation,this.aTextureCoord,this.colorAttribute],this.program=i},e.PixiFastShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attributes=null},e.StripShader=function(){this.program=null,this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying float vColor;","uniform float alpha;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y));","   gl_FragColor = gl_FragColor * alpha;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute float aColor;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","varying vec2 vTextureCoord;","uniform vec2 offsetVector;","varying float vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition, 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / projectionVector.y + 1.0 , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"]},e.StripShader.prototype.init=function(){var t=e.gl,i=e.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(i),this.uSampler=t.getUniformLocation(i,"uSampler"),this.projectionVector=t.getUniformLocation(i,"projectionVector"),this.offsetVector=t.getUniformLocation(i,"offsetVector"),this.colorAttribute=t.getAttribLocation(i,"aColor"),this.aVertexPosition=t.getAttribLocation(i,"aVertexPosition"),this.aTextureCoord=t.getAttribLocation(i,"aTextureCoord"),this.translationMatrix=t.getUniformLocation(i,"translationMatrix"),this.alpha=t.getUniformLocation(i,"alpha"),this.program=i},e.PrimitiveShader=function(t){this.gl=t,this.program=null,this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform float alpha;","uniform vec3 tint;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"],this.init()},e.PrimitiveShader.prototype.init=function(){var t=this.gl,i=e.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(i),this.projectionVector=t.getUniformLocation(i,"projectionVector"),this.offsetVector=t.getUniformLocation(i,"offsetVector"),this.tintColor=t.getUniformLocation(i,"tint"),this.aVertexPosition=t.getAttribLocation(i,"aVertexPosition"),this.colorAttribute=t.getAttribLocation(i,"aColor"),this.attributes=[this.aVertexPosition,this.colorAttribute],this.translationMatrix=t.getUniformLocation(i,"translationMatrix"),this.alpha=t.getUniformLocation(i,"alpha"),this.program=i},e.PrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attribute=null},e.WebGLGraphics=function(){},e.WebGLGraphics.renderGraphics=function(t,i){var n=i.gl,o=i.projection,r=i.offset,s=i.shaderManager.primitiveShader;t._webGL[n.id]||(t._webGL[n.id]={points:[],indices:[],lastIndex:0,buffer:n.createBuffer(),indexBuffer:n.createBuffer()});var a=t._webGL[n.id];t.dirty&&(t.dirty=!1,t.clearDirty&&(t.clearDirty=!1,a.lastIndex=0,a.points=[],a.indices=[]),e.WebGLGraphics.updateGraphics(t,n)),i.shaderManager.activatePrimitiveShader(),n.blendFunc(n.ONE,n.ONE_MINUS_SRC_ALPHA),n.uniformMatrix3fv(s.translationMatrix,!1,t.worldTransform.toArray(!0)),n.uniform2f(s.projectionVector,o.x,-o.y),n.uniform2f(s.offsetVector,-r.x,-r.y),n.uniform3fv(s.tintColor,e.hex2rgb(t.tint)),n.uniform1f(s.alpha,t.worldAlpha),n.bindBuffer(n.ARRAY_BUFFER,a.buffer),n.vertexAttribPointer(s.aVertexPosition,2,n.FLOAT,!1,24,0),n.vertexAttribPointer(s.colorAttribute,4,n.FLOAT,!1,24,8),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,a.indexBuffer),n.drawElements(n.TRIANGLE_STRIP,a.indices.length,n.UNSIGNED_SHORT,0),i.shaderManager.deactivatePrimitiveShader()},e.WebGLGraphics.updateGraphics=function(t,i){for(var n=t._webGL[i.id],o=n.lastIndex;o<t.graphicsData.length;o++){var r=t.graphicsData[o];r.type===e.Graphics.POLY?(r.fill&&r.points.length>3&&e.WebGLGraphics.buildPoly(r,n),r.lineWidth>0&&e.WebGLGraphics.buildLine(r,n)):r.type===e.Graphics.RECT?e.WebGLGraphics.buildRectangle(r,n):(r.type===e.Graphics.CIRC||r.type===e.Graphics.ELIP)&&e.WebGLGraphics.buildCircle(r,n)}n.lastIndex=t.graphicsData.length,n.glPoints=new Float32Array(n.points),i.bindBuffer(i.ARRAY_BUFFER,n.buffer),i.bufferData(i.ARRAY_BUFFER,n.glPoints,i.STATIC_DRAW),n.glIndicies=new Uint16Array(n.indices),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,n.indexBuffer),i.bufferData(i.ELEMENT_ARRAY_BUFFER,n.glIndicies,i.STATIC_DRAW)},e.WebGLGraphics.buildRectangle=function(t,i){var n=t.points,o=n[0],r=n[1],s=n[2],a=n[3];if(t.fill){var h=e.hex2rgb(t.fillColor),l=t.fillAlpha,u=h[0]*l,c=h[1]*l,p=h[2]*l,d=i.points,f=i.indices,g=d.length/6;d.push(o,r),d.push(u,c,p,l),d.push(o+s,r),d.push(u,c,p,l),d.push(o,r+a),d.push(u,c,p,l),d.push(o+s,r+a),d.push(u,c,p,l),f.push(g,g,g+1,g+2,g+3,g+3)}if(t.lineWidth){var m=t.points;t.points=[o,r,o+s,r,o+s,r+a,o,r+a,o,r],e.WebGLGraphics.buildLine(t,i),t.points=m}},e.WebGLGraphics.buildCircle=function(t,i){var n=t.points,o=n[0],r=n[1],s=n[2],a=n[3],h=40,l=2*Math.PI/h,u=0;if(t.fill){var c=e.hex2rgb(t.fillColor),p=t.fillAlpha,d=c[0]*p,f=c[1]*p,g=c[2]*p,m=i.points,y=i.indices,v=m.length/6;for(y.push(v),u=0;h+1>u;u++)m.push(o,r,d,f,g,p),m.push(o+Math.sin(l*u)*s,r+Math.cos(l*u)*a,d,f,g,p),y.push(v++,v++);y.push(v-1)}if(t.lineWidth){var b=t.points;for(t.points=[],u=0;h+1>u;u++)t.points.push(o+Math.sin(l*u)*s,r+Math.cos(l*u)*a);e.WebGLGraphics.buildLine(t,i),t.points=b}},e.WebGLGraphics.buildLine=function(t,i){var n=0,o=t.points;if(0!==o.length){if(t.lineWidth%2)for(n=0;n<o.length;n++)o[n]+=.5;var r=new e.Point(o[0],o[1]),s=new e.Point(o[o.length-2],o[o.length-1]);if(r.x===s.x&&r.y===s.y){o.pop(),o.pop(),s=new e.Point(o[o.length-2],o[o.length-1]);var a=s.x+.5*(r.x-s.x),h=s.y+.5*(r.y-s.y);o.unshift(a,h),o.push(a,h)}var l,u,c,p,d,f,g,m,y,v,b,x,w,S,C,T,_,M,E,A,B,k,O,P=i.points,R=i.indices,L=o.length/2,F=o.length,D=P.length/6,I=t.lineWidth/2,j=e.hex2rgb(t.lineColor),G=t.lineAlpha,N=j[0]*G,W=j[1]*G,H=j[2]*G;for(c=o[0],p=o[1],d=o[2],f=o[3],y=-(p-f),v=c-d,O=Math.sqrt(y*y+v*v),y/=O,v/=O,y*=I,v*=I,P.push(c-y,p-v,N,W,H,G),P.push(c+y,p+v,N,W,H,G),n=1;L-1>n;n++)c=o[2*(n-1)],p=o[2*(n-1)+1],d=o[2*n],f=o[2*n+1],g=o[2*(n+1)],m=o[2*(n+1)+1],y=-(p-f),v=c-d,O=Math.sqrt(y*y+v*v),y/=O,v/=O,y*=I,v*=I,b=-(f-m),x=d-g,O=Math.sqrt(b*b+x*x),b/=O,x/=O,b*=I,x*=I,C=-v+p-(-v+f),T=-y+d-(-y+c),_=(-y+c)*(-v+f)-(-y+d)*(-v+p),M=-x+m-(-x+f),E=-b+d-(-b+g),A=(-b+g)*(-x+f)-(-b+d)*(-x+m),B=C*E-M*T,Math.abs(B)<.1?(B+=10.1,P.push(d-y,f-v,N,W,H,G),P.push(d+y,f+v,N,W,H,G)):(l=(T*A-E*_)/B,u=(M*_-C*A)/B,k=(l-d)*(l-d)+(u-f)+(u-f),k>19600?(w=y-b,S=v-x,O=Math.sqrt(w*w+S*S),w/=O,S/=O,w*=I,S*=I,P.push(d-w,f-S),P.push(N,W,H,G),P.push(d+w,f+S),P.push(N,W,H,G),P.push(d-w,f-S),P.push(N,W,H,G),F++):(P.push(l,u),P.push(N,W,H,G),P.push(d-(l-d),f-(u-f)),P.push(N,W,H,G)));for(c=o[2*(L-2)],p=o[2*(L-2)+1],d=o[2*(L-1)],f=o[2*(L-1)+1],y=-(p-f),v=c-d,O=Math.sqrt(y*y+v*v),y/=O,v/=O,y*=I,v*=I,P.push(d-y,f-v),P.push(N,W,H,G),P.push(d+y,f+v),P.push(N,W,H,G),R.push(D),n=0;F>n;n++)R.push(D++);R.push(D-1)}},e.WebGLGraphics.buildPoly=function(t,i){var n=t.points;if(!(n.length<6)){var o=i.points,r=i.indices,s=n.length/2,a=e.hex2rgb(t.fillColor),h=t.fillAlpha,l=a[0]*h,u=a[1]*h,c=a[2]*h,p=e.PolyK.Triangulate(n),d=o.length/6,f=0;for(f=0;f<p.length;f+=3)r.push(p[f]+d),r.push(p[f]+d),r.push(p[f+1]+d),r.push(p[f+2]+d),r.push(p[f+2]+d);for(f=0;s>f;f++)o.push(n[2*f],n[2*f+1],l,u,c,h)}},e.glContexts=[],e.WebGLRenderer=function(t,i,n,o,r){e.defaultRenderer||(e.defaultRenderer=this),this.type=e.WEBGL_RENDERER,this.transparent=!!o,this.width=t||800,this.height=i||600,this.view=n||document.createElement("canvas"),this.view.width=this.width,this.view.height=this.height,this.contextLost=this.handleContextLost.bind(this),this.contextRestoredLost=this.handleContextRestored.bind(this),this.view.addEventListener("webglcontextlost",this.contextLost,!1),this.view.addEventListener("webglcontextrestored",this.contextRestoredLost,!1),this.options={alpha:this.transparent,antialias:!!r,premultipliedAlpha:!!o,stencil:!0};try{this.gl=this.view.getContext("experimental-webgl",this.options)}catch(s){try{this.gl=this.view.getContext("webgl",this.options)}catch(a){throw new Error(" This browser does not support webGL. Try using the canvas renderer"+this)}}var h=this.gl;this.glContextId=h.id=e.WebGLRenderer.glContextId++,e.glContexts[this.glContextId]=h,e.blendModesWebGL||(e.blendModesWebGL=[],e.blendModesWebGL[e.blendModes.NORMAL]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.ADD]=[h.SRC_ALPHA,h.DST_ALPHA],e.blendModesWebGL[e.blendModes.MULTIPLY]=[h.DST_COLOR,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.SCREEN]=[h.SRC_ALPHA,h.ONE],e.blendModesWebGL[e.blendModes.OVERLAY]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.DARKEN]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.LIGHTEN]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.COLOR_DODGE]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.COLOR_BURN]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.HARD_LIGHT]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.SOFT_LIGHT]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.DIFFERENCE]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.EXCLUSION]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.HUE]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.SATURATION]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.COLOR]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.LUMINOSITY]=[h.ONE,h.ONE_MINUS_SRC_ALPHA]),this.projection=new e.Point,this.projection.x=this.width/2,this.projection.y=-this.height/2,this.offset=new e.Point(0,0),this.resize(this.width,this.height),this.contextLost=!1,this.shaderManager=new e.WebGLShaderManager(h),this.spriteBatch=new e.WebGLSpriteBatch(h),this.maskManager=new e.WebGLMaskManager(h),this.filterManager=new e.WebGLFilterManager(h,this.transparent),this.renderSession={},this.renderSession.gl=this.gl,this.renderSession.drawCount=0,this.renderSession.shaderManager=this.shaderManager,this.renderSession.maskManager=this.maskManager,this.renderSession.filterManager=this.filterManager,this.renderSession.spriteBatch=this.spriteBatch,this.renderSession.renderer=this,h.useProgram(this.shaderManager.defaultShader.program),h.disable(h.DEPTH_TEST),h.disable(h.CULL_FACE),h.enable(h.BLEND),h.colorMask(!0,!0,!0,this.transparent)},e.WebGLRenderer.prototype.constructor=e.WebGLRenderer,e.WebGLRenderer.prototype.render=function(t){if(!this.contextLost){this.__stage!==t&&(t.interactive&&t.interactionManager.removeEvents(),this.__stage=t),e.WebGLRenderer.updateTextures(),t.updateTransform(),t._interactive&&(t._interactiveEventsAdded||(t._interactiveEventsAdded=!0,t.interactionManager.setTarget(this)));var i=this.gl;i.viewport(0,0,this.width,this.height),i.bindFramebuffer(i.FRAMEBUFFER,null),this.transparent?i.clearColor(0,0,0,0):i.clearColor(t.backgroundColorSplit[0],t.backgroundColorSplit[1],t.backgroundColorSplit[2],1),i.clear(i.COLOR_BUFFER_BIT),this.renderDisplayObject(t,this.projection),t.interactive?t._interactiveEventsAdded||(t._interactiveEventsAdded=!0,t.interactionManager.setTarget(this)):t._interactiveEventsAdded&&(t._interactiveEventsAdded=!1,t.interactionManager.setTarget(this))}},e.WebGLRenderer.prototype.renderDisplayObject=function(t,e,i){this.renderSession.drawCount=0,this.renderSession.currentBlendMode=9999,this.renderSession.projection=e,this.renderSession.offset=this.offset,this.spriteBatch.begin(this.renderSession),this.filterManager.begin(this.renderSession,i),t._renderWebGL(this.renderSession),this.spriteBatch.end()},e.WebGLRenderer.updateTextures=function(){var t=0;for(t=0;t<e.Texture.frameUpdates.length;t++)e.WebGLRenderer.updateTextureFrame(e.Texture.frameUpdates[t]);for(t=0;t<e.texturesToDestroy.length;t++)e.WebGLRenderer.destroyTexture(e.texturesToDestroy[t]);e.texturesToUpdate.length=0,e.texturesToDestroy.length=0,e.Texture.frameUpdates.length=0},e.WebGLRenderer.destroyTexture=function(t){for(var i=t._glTextures.length-1;i>=0;i--){var n=t._glTextures[i],o=e.glContexts[i];o&&n&&o.deleteTexture(n)}t._glTextures.length=0},e.WebGLRenderer.updateTextureFrame=function(t){t.updateFrame=!1,t._updateWebGLuvs()},e.WebGLRenderer.prototype.resize=function(t,e){this.width=t,this.height=e,this.view.width=t,this.view.height=e,this.gl.viewport(0,0,this.width,this.height),this.projection.x=this.width/2,this.projection.y=-this.height/2},e.createWebGLTexture=function(t,i){return t.hasLoaded&&(t._glTextures[i.id]=i.createTexture(),i.bindTexture(i.TEXTURE_2D,t._glTextures[i.id]),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t.source),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,t.scaleMode===e.scaleModes.LINEAR?i.LINEAR:i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,t.scaleMode===e.scaleModes.LINEAR?i.LINEAR:i.NEAREST),t._powerOf2?(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.REPEAT)):(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE)),i.bindTexture(i.TEXTURE_2D,null)),t._glTextures[i.id]},e.updateWebGLTexture=function(t,i){t._glTextures[i.id]&&(i.bindTexture(i.TEXTURE_2D,t._glTextures[i.id]),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t.source),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,t.scaleMode===e.scaleModes.LINEAR?i.LINEAR:i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,t.scaleMode===e.scaleModes.LINEAR?i.LINEAR:i.NEAREST),t._powerOf2?(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.REPEAT)):(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE)),i.bindTexture(i.TEXTURE_2D,null))},e.WebGLRenderer.prototype.handleContextLost=function(t){t.preventDefault(),this.contextLost=!0},e.WebGLRenderer.prototype.handleContextRestored=function(){try{this.gl=this.view.getContext("experimental-webgl",this.options)}catch(t){try{this.gl=this.view.getContext("webgl",this.options)}catch(i){throw new Error(" This browser does not support webGL. Try using the canvas renderer"+this)}}var n=this.gl;n.id=e.WebGLRenderer.glContextId++,this.shaderManager.setContext(n),this.spriteBatch.setContext(n),this.maskManager.setContext(n),this.filterManager.setContext(n),this.renderSession.gl=this.gl,n.disable(n.DEPTH_TEST),n.disable(n.CULL_FACE),n.enable(n.BLEND),n.colorMask(!0,!0,!0,this.transparent),this.gl.viewport(0,0,this.width,this.height);for(var o in e.TextureCache){var r=e.TextureCache[o].baseTexture;r._glTextures=[]}this.contextLost=!1},e.WebGLRenderer.prototype.destroy=function(){this.view.removeEventListener("webglcontextlost",this.contextLost),this.view.removeEventListener("webglcontextrestored",this.contextRestoredLost),e.glContexts[this.glContextId]=null,this.projection=null,this.offset=null,this.shaderManager.destroy(),this.spriteBatch.destroy(),this.maskManager.destroy(),this.filterManager.destroy(),this.shaderManager=null,this.spriteBatch=null,this.maskManager=null,this.filterManager=null,this.gl=null,this.renderSession=null},e.WebGLRenderer.glContextId=0,e.WebGLMaskManager=function(t){this.maskStack=[],this.maskPosition=0,this.setContext(t)},e.WebGLMaskManager.prototype.setContext=function(t){this.gl=t},e.WebGLMaskManager.prototype.pushMask=function(t,i){var n=this.gl;0===this.maskStack.length&&(n.enable(n.STENCIL_TEST),n.stencilFunc(n.ALWAYS,1,1)),this.maskStack.push(t),n.colorMask(!1,!1,!1,!1),n.stencilOp(n.KEEP,n.KEEP,n.INCR),e.WebGLGraphics.renderGraphics(t,i),n.colorMask(!0,!0,!0,!0),n.stencilFunc(n.NOTEQUAL,0,this.maskStack.length),n.stencilOp(n.KEEP,n.KEEP,n.KEEP)},e.WebGLMaskManager.prototype.popMask=function(t){var i=this.gl,n=this.maskStack.pop();n&&(i.colorMask(!1,!1,!1,!1),i.stencilOp(i.KEEP,i.KEEP,i.DECR),e.WebGLGraphics.renderGraphics(n,t),i.colorMask(!0,!0,!0,!0),i.stencilFunc(i.NOTEQUAL,0,this.maskStack.length),i.stencilOp(i.KEEP,i.KEEP,i.KEEP)),0===this.maskStack.length&&i.disable(i.STENCIL_TEST)},e.WebGLMaskManager.prototype.destroy=function(){this.maskStack=null,this.gl=null
},e.WebGLShaderManager=function(t){this.maxAttibs=10,this.attribState=[],this.tempAttribState=[];for(var e=0;e<this.maxAttibs;e++)this.attribState[e]=!1;this.setContext(t)},e.WebGLShaderManager.prototype.setContext=function(t){this.gl=t,this.primitiveShader=new e.PrimitiveShader(t),this.defaultShader=new e.PixiShader(t),this.fastShader=new e.PixiFastShader(t),this.activateShader(this.defaultShader)},e.WebGLShaderManager.prototype.setAttribs=function(t){var e;for(e=0;e<this.tempAttribState.length;e++)this.tempAttribState[e]=!1;for(e=0;e<t.length;e++){var i=t[e];this.tempAttribState[i]=!0}var n=this.gl;for(e=0;e<this.attribState.length;e++)this.attribState[e]!==this.tempAttribState[e]&&(this.attribState[e]=this.tempAttribState[e],this.tempAttribState[e]?n.enableVertexAttribArray(e):n.disableVertexAttribArray(e))},e.WebGLShaderManager.prototype.activateShader=function(t){this.currentShader=t,this.gl.useProgram(t.program),this.setAttribs(t.attributes)},e.WebGLShaderManager.prototype.activatePrimitiveShader=function(){var t=this.gl;t.useProgram(this.primitiveShader.program),this.setAttribs(this.primitiveShader.attributes)},e.WebGLShaderManager.prototype.deactivatePrimitiveShader=function(){var t=this.gl;t.useProgram(this.defaultShader.program),this.setAttribs(this.defaultShader.attributes)},e.WebGLShaderManager.prototype.destroy=function(){this.attribState=null,this.tempAttribState=null,this.primitiveShader.destroy(),this.defaultShader.destroy(),this.fastShader.destroy(),this.gl=null},e.WebGLSpriteBatch=function(t){this.vertSize=6,this.size=2e3;var e=4*this.size*this.vertSize,i=6*this.size;this.vertices=new Float32Array(e),this.indices=new Uint16Array(i),this.lastIndexCount=0;for(var n=0,o=0;i>n;n+=6,o+=4)this.indices[n+0]=o+0,this.indices[n+1]=o+1,this.indices[n+2]=o+2,this.indices[n+3]=o+0,this.indices[n+4]=o+2,this.indices[n+5]=o+3;this.drawing=!1,this.currentBatchSize=0,this.currentBaseTexture=null,this.setContext(t)},e.WebGLSpriteBatch.prototype.setContext=function(t){this.gl=t,this.vertexBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),this.currentBlendMode=99999},e.WebGLSpriteBatch.prototype.begin=function(t){this.renderSession=t,this.shader=this.renderSession.shaderManager.defaultShader,this.start()},e.WebGLSpriteBatch.prototype.end=function(){this.flush()},e.WebGLSpriteBatch.prototype.render=function(t){var e=t.texture;(e.baseTexture!==this.currentBaseTexture||this.currentBatchSize>=this.size)&&(this.flush(),this.currentBaseTexture=e.baseTexture),t.blendMode!==this.currentBlendMode&&this.setBlendMode(t.blendMode);var i=t._uvs||t.texture._uvs;if(i){var n,o,r,s,a=t.worldAlpha,h=t.tint,l=this.vertices,u=t.anchor.x,c=t.anchor.y;if(t.texture.trim){var p=t.texture.trim;o=p.x-u*p.width,n=o+e.frame.width,s=p.y-c*p.height,r=s+e.frame.height}else n=e.frame.width*(1-u),o=e.frame.width*-u,r=e.frame.height*(1-c),s=e.frame.height*-c;var d=4*this.currentBatchSize*this.vertSize,f=t.worldTransform,g=f.a,m=f.c,y=f.b,v=f.d,b=f.tx,x=f.ty;l[d++]=g*o+y*s+b,l[d++]=v*s+m*o+x,l[d++]=i.x0,l[d++]=i.y0,l[d++]=a,l[d++]=h,l[d++]=g*n+y*s+b,l[d++]=v*s+m*n+x,l[d++]=i.x1,l[d++]=i.y1,l[d++]=a,l[d++]=h,l[d++]=g*n+y*r+b,l[d++]=v*r+m*n+x,l[d++]=i.x2,l[d++]=i.y2,l[d++]=a,l[d++]=h,l[d++]=g*o+y*r+b,l[d++]=v*r+m*o+x,l[d++]=i.x3,l[d++]=i.y3,l[d++]=a,l[d++]=h,this.currentBatchSize++}},e.WebGLSpriteBatch.prototype.renderTilingSprite=function(t){var i=t.tilingTexture;(i.baseTexture!==this.currentBaseTexture||this.currentBatchSize>=this.size)&&(this.flush(),this.currentBaseTexture=i.baseTexture),t.blendMode!==this.currentBlendMode&&this.setBlendMode(t.blendMode),t._uvs||(t._uvs=new e.TextureUvs);var n=t._uvs;t.tilePosition.x%=i.baseTexture.width*t.tileScaleOffset.x,t.tilePosition.y%=i.baseTexture.height*t.tileScaleOffset.y;var o=t.tilePosition.x/(i.baseTexture.width*t.tileScaleOffset.x),r=t.tilePosition.y/(i.baseTexture.height*t.tileScaleOffset.y),s=t.width/i.baseTexture.width/(t.tileScale.x*t.tileScaleOffset.x),a=t.height/i.baseTexture.height/(t.tileScale.y*t.tileScaleOffset.y);n.x0=0-o,n.y0=0-r,n.x1=1*s-o,n.y1=0-r,n.x2=1*s-o,n.y2=1*a-r,n.x3=0-o,n.y3=1*a-r;var h=t.worldAlpha,l=t.tint,u=this.vertices,c=t.width,p=t.height,d=t.anchor.x,f=t.anchor.y,g=c*(1-d),m=c*-d,y=p*(1-f),v=p*-f,b=4*this.currentBatchSize*this.vertSize,x=t.worldTransform,w=x.a,S=x.c,C=x.b,T=x.d,_=x.tx,M=x.ty;u[b++]=w*m+C*v+_,u[b++]=T*v+S*m+M,u[b++]=n.x0,u[b++]=n.y0,u[b++]=h,u[b++]=l,u[b++]=w*g+C*v+_,u[b++]=T*v+S*g+M,u[b++]=n.x1,u[b++]=n.y1,u[b++]=h,u[b++]=l,u[b++]=w*g+C*y+_,u[b++]=T*y+S*g+M,u[b++]=n.x2,u[b++]=n.y2,u[b++]=h,u[b++]=l,u[b++]=w*m+C*y+_,u[b++]=T*y+S*m+M,u[b++]=n.x3,u[b++]=n.y3,u[b++]=h,u[b++]=l,this.currentBatchSize++},e.WebGLSpriteBatch.prototype.flush=function(){if(0!==this.currentBatchSize){var t=this.gl;if(t.bindTexture(t.TEXTURE_2D,this.currentBaseTexture._glTextures[t.id]||e.createWebGLTexture(this.currentBaseTexture,t)),this.currentBatchSize>.5*this.size)t.bufferSubData(t.ARRAY_BUFFER,0,this.vertices);else{var i=this.vertices.subarray(0,4*this.currentBatchSize*this.vertSize);t.bufferSubData(t.ARRAY_BUFFER,0,i)}t.drawElements(t.TRIANGLES,6*this.currentBatchSize,t.UNSIGNED_SHORT,0),this.currentBatchSize=0,this.renderSession.drawCount++}},e.WebGLSpriteBatch.prototype.stop=function(){this.flush()},e.WebGLSpriteBatch.prototype.start=function(){var t=this.gl;t.activeTexture(t.TEXTURE0),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var i=this.renderSession.projection;t.uniform2f(this.shader.projectionVector,i.x,i.y);var n=4*this.vertSize;t.vertexAttribPointer(this.shader.aVertexPosition,2,t.FLOAT,!1,n,0),t.vertexAttribPointer(this.shader.aTextureCoord,2,t.FLOAT,!1,n,8),t.vertexAttribPointer(this.shader.colorAttribute,2,t.FLOAT,!1,n,16),this.currentBlendMode!==e.blendModes.NORMAL&&this.setBlendMode(e.blendModes.NORMAL)},e.WebGLSpriteBatch.prototype.setBlendMode=function(t){this.flush(),this.currentBlendMode=t;var i=e.blendModesWebGL[this.currentBlendMode];this.gl.blendFunc(i[0],i[1])},e.WebGLSpriteBatch.prototype.destroy=function(){this.vertices=null,this.indices=null,this.gl.deleteBuffer(this.vertexBuffer),this.gl.deleteBuffer(this.indexBuffer),this.currentBaseTexture=null,this.gl=null},e.WebGLFastSpriteBatch=function(t){this.vertSize=10,this.maxSize=6e3,this.size=this.maxSize;var e=4*this.size*this.vertSize,i=6*this.maxSize;this.vertices=new Float32Array(e),this.indices=new Uint16Array(i),this.vertexBuffer=null,this.indexBuffer=null,this.lastIndexCount=0;for(var n=0,o=0;i>n;n+=6,o+=4)this.indices[n+0]=o+0,this.indices[n+1]=o+1,this.indices[n+2]=o+2,this.indices[n+3]=o+0,this.indices[n+4]=o+2,this.indices[n+5]=o+3;this.drawing=!1,this.currentBatchSize=0,this.currentBaseTexture=null,this.currentBlendMode=0,this.renderSession=null,this.shader=null,this.matrix=null,this.setContext(t)},e.WebGLFastSpriteBatch.prototype.setContext=function(t){this.gl=t,this.vertexBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),this.currentBlendMode=99999},e.WebGLFastSpriteBatch.prototype.begin=function(t,e){this.renderSession=e,this.shader=this.renderSession.shaderManager.fastShader,this.matrix=t.worldTransform.toArray(!0),this.start()},e.WebGLFastSpriteBatch.prototype.end=function(){this.flush()},e.WebGLFastSpriteBatch.prototype.render=function(t){var e=t.children,i=e[0];if(i.texture._uvs){this.currentBaseTexture=i.texture.baseTexture,i.blendMode!==this.currentBlendMode&&this.setBlendMode(i.blendMode);for(var n=0,o=e.length;o>n;n++)this.renderSprite(e[n]);this.flush()}},e.WebGLFastSpriteBatch.prototype.renderSprite=function(t){if(t.visible&&(t.texture.baseTexture===this.currentBaseTexture||(this.flush(),this.currentBaseTexture=t.texture.baseTexture,t.texture._uvs))){var e,i,n,o,r,s,a,h,l=this.vertices;if(e=t.texture._uvs,i=t.texture.frame.width,n=t.texture.frame.height,t.texture.trim){var u=t.texture.trim;r=u.x-t.anchor.x*u.width,o=r+t.texture.frame.width,a=u.y-t.anchor.y*u.height,s=a+t.texture.frame.height}else o=t.texture.frame.width*(1-t.anchor.x),r=t.texture.frame.width*-t.anchor.x,s=t.texture.frame.height*(1-t.anchor.y),a=t.texture.frame.height*-t.anchor.y;h=4*this.currentBatchSize*this.vertSize,l[h++]=r,l[h++]=a,l[h++]=t.position.x,l[h++]=t.position.y,l[h++]=t.scale.x,l[h++]=t.scale.y,l[h++]=t.rotation,l[h++]=e.x0,l[h++]=e.y1,l[h++]=t.alpha,l[h++]=o,l[h++]=a,l[h++]=t.position.x,l[h++]=t.position.y,l[h++]=t.scale.x,l[h++]=t.scale.y,l[h++]=t.rotation,l[h++]=e.x1,l[h++]=e.y1,l[h++]=t.alpha,l[h++]=o,l[h++]=s,l[h++]=t.position.x,l[h++]=t.position.y,l[h++]=t.scale.x,l[h++]=t.scale.y,l[h++]=t.rotation,l[h++]=e.x2,l[h++]=e.y2,l[h++]=t.alpha,l[h++]=r,l[h++]=s,l[h++]=t.position.x,l[h++]=t.position.y,l[h++]=t.scale.x,l[h++]=t.scale.y,l[h++]=t.rotation,l[h++]=e.x3,l[h++]=e.y3,l[h++]=t.alpha,this.currentBatchSize++,this.currentBatchSize>=this.size&&this.flush()}},e.WebGLFastSpriteBatch.prototype.flush=function(){if(0!==this.currentBatchSize){var t=this.gl;if(this.currentBaseTexture._glTextures[t.id]||e.createWebGLTexture(this.currentBaseTexture,t),t.bindTexture(t.TEXTURE_2D,this.currentBaseTexture._glTextures[t.id]),this.currentBatchSize>.5*this.size)t.bufferSubData(t.ARRAY_BUFFER,0,this.vertices);else{var i=this.vertices.subarray(0,4*this.currentBatchSize*this.vertSize);t.bufferSubData(t.ARRAY_BUFFER,0,i)}t.drawElements(t.TRIANGLES,6*this.currentBatchSize,t.UNSIGNED_SHORT,0),this.currentBatchSize=0,this.renderSession.drawCount++}},e.WebGLFastSpriteBatch.prototype.stop=function(){this.flush()},e.WebGLFastSpriteBatch.prototype.start=function(){var t=this.gl;t.activeTexture(t.TEXTURE0),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var i=this.renderSession.projection;t.uniform2f(this.shader.projectionVector,i.x,i.y),t.uniformMatrix3fv(this.shader.uMatrix,!1,this.matrix);var n=4*this.vertSize;t.vertexAttribPointer(this.shader.aVertexPosition,2,t.FLOAT,!1,n,0),t.vertexAttribPointer(this.shader.aPositionCoord,2,t.FLOAT,!1,n,8),t.vertexAttribPointer(this.shader.aScale,2,t.FLOAT,!1,n,16),t.vertexAttribPointer(this.shader.aRotation,1,t.FLOAT,!1,n,24),t.vertexAttribPointer(this.shader.aTextureCoord,2,t.FLOAT,!1,n,28),t.vertexAttribPointer(this.shader.colorAttribute,1,t.FLOAT,!1,n,36),this.currentBlendMode!==e.blendModes.NORMAL&&this.setBlendMode(e.blendModes.NORMAL)},e.WebGLFastSpriteBatch.prototype.setBlendMode=function(t){this.flush(),this.currentBlendMode=t;var i=e.blendModesWebGL[this.currentBlendMode];this.gl.blendFunc(i[0],i[1])},e.WebGLFilterManager=function(t,e){this.transparent=e,this.filterStack=[],this.offsetX=0,this.offsetY=0,this.setContext(t)},e.WebGLFilterManager.prototype.setContext=function(t){this.gl=t,this.texturePool=[],this.initShaderBuffers()},e.WebGLFilterManager.prototype.begin=function(t,e){this.renderSession=t,this.defaultShader=t.shaderManager.defaultShader;var i=this.renderSession.projection;this.width=2*i.x,this.height=2*-i.y,this.buffer=e},e.WebGLFilterManager.prototype.pushFilter=function(t){var i=this.gl,n=this.renderSession.projection,o=this.renderSession.offset;t._filterArea=t.target.filterArea||t.target.getBounds(),this.filterStack.push(t);var r=t.filterPasses[0];this.offsetX+=t._filterArea.x,this.offsetY+=t._filterArea.y;var s=this.texturePool.pop();s?s.resize(this.width,this.height):s=new e.FilterTexture(this.gl,this.width,this.height),i.bindTexture(i.TEXTURE_2D,s.texture);var a=t._filterArea,h=r.padding;a.x-=h,a.y-=h,a.width+=2*h,a.height+=2*h,a.x<0&&(a.x=0),a.width>this.width&&(a.width=this.width),a.y<0&&(a.y=0),a.height>this.height&&(a.height=this.height),i.bindFramebuffer(i.FRAMEBUFFER,s.frameBuffer),i.viewport(0,0,a.width,a.height),n.x=a.width/2,n.y=-a.height/2,o.x=-a.x,o.y=-a.y,i.uniform2f(this.defaultShader.projectionVector,a.width/2,-a.height/2),i.uniform2f(this.defaultShader.offsetVector,-a.x,-a.y),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT),t._glFilterTexture=s},e.WebGLFilterManager.prototype.popFilter=function(){var t=this.gl,i=this.filterStack.pop(),n=i._filterArea,o=i._glFilterTexture,r=this.renderSession.projection,s=this.renderSession.offset;if(i.filterPasses.length>1){t.viewport(0,0,n.width,n.height),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),this.vertexArray[0]=0,this.vertexArray[1]=n.height,this.vertexArray[2]=n.width,this.vertexArray[3]=n.height,this.vertexArray[4]=0,this.vertexArray[5]=0,this.vertexArray[6]=n.width,this.vertexArray[7]=0,t.bufferSubData(t.ARRAY_BUFFER,0,this.vertexArray),t.bindBuffer(t.ARRAY_BUFFER,this.uvBuffer),this.uvArray[2]=n.width/this.width,this.uvArray[5]=n.height/this.height,this.uvArray[6]=n.width/this.width,this.uvArray[7]=n.height/this.height,t.bufferSubData(t.ARRAY_BUFFER,0,this.uvArray);var a=o,h=this.texturePool.pop();h||(h=new e.FilterTexture(this.gl,this.width,this.height)),h.resize(this.width,this.height),t.bindFramebuffer(t.FRAMEBUFFER,h.frameBuffer),t.clear(t.COLOR_BUFFER_BIT),t.disable(t.BLEND);for(var l=0;l<i.filterPasses.length-1;l++){var u=i.filterPasses[l];t.bindFramebuffer(t.FRAMEBUFFER,h.frameBuffer),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,a.texture),this.applyFilterPass(u,n,n.width,n.height);var c=a;a=h,h=c}t.enable(t.BLEND),o=a,this.texturePool.push(h)}var p=i.filterPasses[i.filterPasses.length-1];this.offsetX-=n.x,this.offsetY-=n.y;var d=this.width,f=this.height,g=0,m=0,y=this.buffer;if(0===this.filterStack.length)t.colorMask(!0,!0,!0,!0);else{var v=this.filterStack[this.filterStack.length-1];n=v._filterArea,d=n.width,f=n.height,g=n.x,m=n.y,y=v._glFilterTexture.frameBuffer}r.x=d/2,r.y=-f/2,s.x=g,s.y=m,n=i._filterArea;var b=n.x-g,x=n.y-m;t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),this.vertexArray[0]=b,this.vertexArray[1]=x+n.height,this.vertexArray[2]=b+n.width,this.vertexArray[3]=x+n.height,this.vertexArray[4]=b,this.vertexArray[5]=x,this.vertexArray[6]=b+n.width,this.vertexArray[7]=x,t.bufferSubData(t.ARRAY_BUFFER,0,this.vertexArray),t.bindBuffer(t.ARRAY_BUFFER,this.uvBuffer),this.uvArray[2]=n.width/this.width,this.uvArray[5]=n.height/this.height,this.uvArray[6]=n.width/this.width,this.uvArray[7]=n.height/this.height,t.bufferSubData(t.ARRAY_BUFFER,0,this.uvArray),t.viewport(0,0,d,f),t.bindFramebuffer(t.FRAMEBUFFER,y),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,o.texture),this.applyFilterPass(p,n,d,f),t.useProgram(this.defaultShader.program),t.uniform2f(this.defaultShader.projectionVector,d/2,-f/2),t.uniform2f(this.defaultShader.offsetVector,-g,-m),this.texturePool.push(o),i._glFilterTexture=null},e.WebGLFilterManager.prototype.applyFilterPass=function(t,i,n,o){var r=this.gl,s=t.shaders[r.id];s||(s=new e.PixiShader(r),s.fragmentSrc=t.fragmentSrc,s.uniforms=t.uniforms,s.init(),t.shaders[r.id]=s),r.useProgram(s.program),r.uniform2f(s.projectionVector,n/2,-o/2),r.uniform2f(s.offsetVector,0,0),t.uniforms.dimensions&&(t.uniforms.dimensions.value[0]=this.width,t.uniforms.dimensions.value[1]=this.height,t.uniforms.dimensions.value[2]=this.vertexArray[0],t.uniforms.dimensions.value[3]=this.vertexArray[5]),s.syncUniforms(),r.bindBuffer(r.ARRAY_BUFFER,this.vertexBuffer),r.vertexAttribPointer(s.aVertexPosition,2,r.FLOAT,!1,0,0),r.bindBuffer(r.ARRAY_BUFFER,this.uvBuffer),r.vertexAttribPointer(s.aTextureCoord,2,r.FLOAT,!1,0,0),r.bindBuffer(r.ARRAY_BUFFER,this.colorBuffer),r.vertexAttribPointer(s.colorAttribute,2,r.FLOAT,!1,0,0),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,this.indexBuffer),r.drawElements(r.TRIANGLES,6,r.UNSIGNED_SHORT,0),this.renderSession.drawCount++},e.WebGLFilterManager.prototype.initShaderBuffers=function(){var t=this.gl;this.vertexBuffer=t.createBuffer(),this.uvBuffer=t.createBuffer(),this.colorBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),this.vertexArray=new Float32Array([0,0,1,0,0,1,1,1]),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertexArray,t.STATIC_DRAW),this.uvArray=new Float32Array([0,0,1,0,0,1,1,1]),t.bindBuffer(t.ARRAY_BUFFER,this.uvBuffer),t.bufferData(t.ARRAY_BUFFER,this.uvArray,t.STATIC_DRAW),this.colorArray=new Float32Array([1,16777215,1,16777215,1,16777215,1,16777215]),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,this.colorArray,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,1,3,2]),t.STATIC_DRAW)},e.WebGLFilterManager.prototype.destroy=function(){var t=this.gl;this.filterStack=null,this.offsetX=0,this.offsetY=0;for(var e=0;e<this.texturePool.length;e++)this.texturePool.destroy();this.texturePool=null,t.deleteBuffer(this.vertexBuffer),t.deleteBuffer(this.uvBuffer),t.deleteBuffer(this.colorBuffer),t.deleteBuffer(this.indexBuffer)},e.FilterTexture=function(t,i,n,o){this.gl=t,this.frameBuffer=t.createFramebuffer(),this.texture=t.createTexture(),o=o||e.scaleModes.DEFAULT,t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,o===e.scaleModes.LINEAR?t.LINEAR:t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,o===e.scaleModes.LINEAR?t.LINEAR:t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer),t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture,0),this.renderBuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.renderBuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,this.renderBuffer),this.resize(i,n)},e.FilterTexture.prototype.clear=function(){var t=this.gl;t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT)},e.FilterTexture.prototype.resize=function(t,e){if(this.width!==t||this.height!==e){this.width=t,this.height=e;var i=this.gl;i.bindTexture(i.TEXTURE_2D,this.texture),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,t,e,0,i.RGBA,i.UNSIGNED_BYTE,null),i.bindRenderbuffer(i.RENDERBUFFER,this.renderBuffer),i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,t,e)}},e.FilterTexture.prototype.destroy=function(){var t=this.gl;t.deleteFramebuffer(this.frameBuffer),t.deleteTexture(this.texture),this.frameBuffer=null,this.texture=null},e.CanvasMaskManager=function(){},e.CanvasMaskManager.prototype.pushMask=function(t,i){i.save();var n=t.alpha,o=t.worldTransform;i.setTransform(o.a,o.c,o.b,o.d,o.tx,o.ty),e.CanvasGraphics.renderGraphicsMask(t,i),i.clip(),t.worldAlpha=n},e.CanvasMaskManager.prototype.popMask=function(t){t.restore()},e.CanvasTinter=function(){},e.CanvasTinter.getTintedTexture=function(t,i){var n=t.texture;i=e.CanvasTinter.roundColor(i);var o="#"+("00000"+(0|i).toString(16)).substr(-6);if(n.tintCache=n.tintCache||{},n.tintCache[o])return n.tintCache[o];var r=e.CanvasTinter.canvas||document.createElement("canvas");if(e.CanvasTinter.tintMethod(n,i,r),e.CanvasTinter.convertTintToImage){var s=new Image;s.src=r.toDataURL(),n.tintCache[o]=s}else n.tintCache[o]=r,e.CanvasTinter.canvas=null;return r},e.CanvasTinter.tintWithMultiply=function(t,e,i){var n=i.getContext("2d"),o=t.frame;i.width=o.width,i.height=o.height,n.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),n.fillRect(0,0,o.width,o.height),n.globalCompositeOperation="multiply",n.drawImage(t.baseTexture.source,o.x,o.y,o.width,o.height,0,0,o.width,o.height),n.globalCompositeOperation="destination-atop",n.drawImage(t.baseTexture.source,o.x,o.y,o.width,o.height,0,0,o.width,o.height)},e.CanvasTinter.tintWithOverlay=function(t,e,i){var n=i.getContext("2d"),o=t.frame;i.width=o.width,i.height=o.height,n.globalCompositeOperation="copy",n.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),n.fillRect(0,0,o.width,o.height),n.globalCompositeOperation="destination-atop",n.drawImage(t.baseTexture.source,o.x,o.y,o.width,o.height,0,0,o.width,o.height)},e.CanvasTinter.tintWithPerPixel=function(t,i,n){var o=n.getContext("2d"),r=t.frame;n.width=r.width,n.height=r.height,o.globalCompositeOperation="copy",o.drawImage(t.baseTexture.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height);for(var s=e.hex2rgb(i),a=s[0],h=s[1],l=s[2],u=o.getImageData(0,0,r.width,r.height),c=u.data,p=0;p<c.length;p+=4)c[p+0]*=a,c[p+1]*=h,c[p+2]*=l;o.putImageData(u,0,0)},e.CanvasTinter.roundColor=function(t){var i=e.CanvasTinter.cacheStepsPerColorChannel,n=e.hex2rgb(t);return n[0]=Math.min(255,n[0]/i*i),n[1]=Math.min(255,n[1]/i*i),n[2]=Math.min(255,n[2]/i*i),e.rgb2hex(n)},e.CanvasTinter.cacheStepsPerColorChannel=8,e.CanvasTinter.convertTintToImage=!1,e.CanvasTinter.canUseMultiply=e.canUseNewCanvasBlendModes(),e.CanvasTinter.tintMethod=e.CanvasTinter.canUseMultiply?e.CanvasTinter.tintWithMultiply:e.CanvasTinter.tintWithPerPixel,e.CanvasRenderer=function(t,i,n,o){e.defaultRenderer=e.defaultRenderer||this,this.type=e.CANVAS_RENDERER,this.clearBeforeRender=!0,this.roundPixels=!1,this.transparent=!!o,e.blendModesCanvas||(e.blendModesCanvas=[],e.canUseNewCanvasBlendModes()?(e.blendModesCanvas[e.blendModes.NORMAL]="source-over",e.blendModesCanvas[e.blendModes.ADD]="lighter",e.blendModesCanvas[e.blendModes.MULTIPLY]="multiply",e.blendModesCanvas[e.blendModes.SCREEN]="screen",e.blendModesCanvas[e.blendModes.OVERLAY]="overlay",e.blendModesCanvas[e.blendModes.DARKEN]="darken",e.blendModesCanvas[e.blendModes.LIGHTEN]="lighten",e.blendModesCanvas[e.blendModes.COLOR_DODGE]="color-dodge",e.blendModesCanvas[e.blendModes.COLOR_BURN]="color-burn",e.blendModesCanvas[e.blendModes.HARD_LIGHT]="hard-light",e.blendModesCanvas[e.blendModes.SOFT_LIGHT]="soft-light",e.blendModesCanvas[e.blendModes.DIFFERENCE]="difference",e.blendModesCanvas[e.blendModes.EXCLUSION]="exclusion",e.blendModesCanvas[e.blendModes.HUE]="hue",e.blendModesCanvas[e.blendModes.SATURATION]="saturation",e.blendModesCanvas[e.blendModes.COLOR]="color",e.blendModesCanvas[e.blendModes.LUMINOSITY]="luminosity"):(e.blendModesCanvas[e.blendModes.NORMAL]="source-over",e.blendModesCanvas[e.blendModes.ADD]="lighter",e.blendModesCanvas[e.blendModes.MULTIPLY]="source-over",e.blendModesCanvas[e.blendModes.SCREEN]="source-over",e.blendModesCanvas[e.blendModes.OVERLAY]="source-over",e.blendModesCanvas[e.blendModes.DARKEN]="source-over",e.blendModesCanvas[e.blendModes.LIGHTEN]="source-over",e.blendModesCanvas[e.blendModes.COLOR_DODGE]="source-over",e.blendModesCanvas[e.blendModes.COLOR_BURN]="source-over",e.blendModesCanvas[e.blendModes.HARD_LIGHT]="source-over",e.blendModesCanvas[e.blendModes.SOFT_LIGHT]="source-over",e.blendModesCanvas[e.blendModes.DIFFERENCE]="source-over",e.blendModesCanvas[e.blendModes.EXCLUSION]="source-over",e.blendModesCanvas[e.blendModes.HUE]="source-over",e.blendModesCanvas[e.blendModes.SATURATION]="source-over",e.blendModesCanvas[e.blendModes.COLOR]="source-over",e.blendModesCanvas[e.blendModes.LUMINOSITY]="source-over")),this.width=t||800,this.height=i||600,this.view=n||document.createElement("canvas"),this.context=this.view.getContext("2d",{alpha:this.transparent}),this.refresh=!0,this.view.width=this.width,this.view.height=this.height,this.count=0,this.maskManager=new e.CanvasMaskManager,this.renderSession={context:this.context,maskManager:this.maskManager,scaleMode:null,smoothProperty:null},"imageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="imageSmoothingEnabled":"webkitImageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="webkitImageSmoothingEnabled":"mozImageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="mozImageSmoothingEnabled":"oImageSmoothingEnabled"in this.context&&(this.renderSession.smoothProperty="oImageSmoothingEnabled")},e.CanvasRenderer.prototype.constructor=e.CanvasRenderer,e.CanvasRenderer.prototype.render=function(t){e.texturesToUpdate.length=0,e.texturesToDestroy.length=0,t.updateTransform(),this.context.setTransform(1,0,0,1,0,0),this.context.globalAlpha=1,!this.transparent&&this.clearBeforeRender?(this.context.fillStyle=t.backgroundColorString,this.context.fillRect(0,0,this.width,this.height)):this.transparent&&this.clearBeforeRender&&this.context.clearRect(0,0,this.width,this.height),this.renderDisplayObject(t),t.interactive&&(t._interactiveEventsAdded||(t._interactiveEventsAdded=!0,t.interactionManager.setTarget(this))),e.Texture.frameUpdates.length>0&&(e.Texture.frameUpdates.length=0)},e.CanvasRenderer.prototype.resize=function(t,e){this.width=t,this.height=e,this.view.width=t,this.view.height=e},e.CanvasRenderer.prototype.renderDisplayObject=function(t,e){this.renderSession.context=e||this.context,t._renderCanvas(this.renderSession)},e.CanvasRenderer.prototype.renderStripFlat=function(t){var e=this.context,i=t.verticies,n=i.length/2;this.count++,e.beginPath();for(var o=1;n-2>o;o++){var r=2*o,s=i[r],a=i[r+2],h=i[r+4],l=i[r+1],u=i[r+3],c=i[r+5];e.moveTo(s,l),e.lineTo(a,u),e.lineTo(h,c)}e.fillStyle="#FF0000",e.fill(),e.closePath()},e.CanvasRenderer.prototype.renderStrip=function(t){var e=this.context,i=t.verticies,n=t.uvs,o=i.length/2;this.count++;for(var r=1;o-2>r;r++){var s=2*r,a=i[s],h=i[s+2],l=i[s+4],u=i[s+1],c=i[s+3],p=i[s+5],d=n[s]*t.texture.width,f=n[s+2]*t.texture.width,g=n[s+4]*t.texture.width,m=n[s+1]*t.texture.height,y=n[s+3]*t.texture.height,v=n[s+5]*t.texture.height;e.save(),e.beginPath(),e.moveTo(a,u),e.lineTo(h,c),e.lineTo(l,p),e.closePath(),e.clip();var b=d*y+m*g+f*v-y*g-m*f-d*v,x=a*y+m*l+h*v-y*l-m*h-a*v,w=d*h+a*g+f*l-h*g-a*f-d*l,S=d*y*l+m*h*g+a*f*v-a*y*g-m*f*l-d*h*v,C=u*y+m*p+c*v-y*p-m*c-u*v,T=d*c+u*g+f*p-c*g-u*f-d*p,_=d*y*p+m*c*g+u*f*v-u*y*g-m*f*p-d*c*v;e.transform(x/b,C/b,w/b,T/b,S/b,_/b),e.drawImage(t.texture.baseTexture.source,0,0),e.restore()}},e.CanvasBuffer=function(t,e){this.width=t,this.height=e,this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.canvas.width=t,this.canvas.height=e},e.CanvasBuffer.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},e.CanvasBuffer.prototype.resize=function(t,e){this.width=this.canvas.width=t,this.height=this.canvas.height=e},e.CanvasGraphics=function(){},e.CanvasGraphics.renderGraphics=function(t,i){for(var n=t.worldAlpha,o="",r=0;r<t.graphicsData.length;r++){var s=t.graphicsData[r],a=s.points;if(i.strokeStyle=o="#"+("00000"+(0|s.lineColor).toString(16)).substr(-6),i.lineWidth=s.lineWidth,s.type===e.Graphics.POLY){i.beginPath(),i.moveTo(a[0],a[1]);for(var h=1;h<a.length/2;h++)i.lineTo(a[2*h],a[2*h+1]);a[0]===a[a.length-2]&&a[1]===a[a.length-1]&&i.closePath(),s.fill&&(i.globalAlpha=s.fillAlpha*n,i.fillStyle=o="#"+("00000"+(0|s.fillColor).toString(16)).substr(-6),i.fill()),s.lineWidth&&(i.globalAlpha=s.lineAlpha*n,i.stroke())}else if(s.type===e.Graphics.RECT)(s.fillColor||0===s.fillColor)&&(i.globalAlpha=s.fillAlpha*n,i.fillStyle=o="#"+("00000"+(0|s.fillColor).toString(16)).substr(-6),i.fillRect(a[0],a[1],a[2],a[3])),s.lineWidth&&(i.globalAlpha=s.lineAlpha*n,i.strokeRect(a[0],a[1],a[2],a[3]));else if(s.type===e.Graphics.CIRC)i.beginPath(),i.arc(a[0],a[1],a[2],0,2*Math.PI),i.closePath(),s.fill&&(i.globalAlpha=s.fillAlpha*n,i.fillStyle=o="#"+("00000"+(0|s.fillColor).toString(16)).substr(-6),i.fill()),s.lineWidth&&(i.globalAlpha=s.lineAlpha*n,i.stroke());else if(s.type===e.Graphics.ELIP){var l=s.points,u=2*l[2],c=2*l[3],p=l[0]-u/2,d=l[1]-c/2;i.beginPath();var f=.5522848,g=u/2*f,m=c/2*f,y=p+u,v=d+c,b=p+u/2,x=d+c/2;i.moveTo(p,x),i.bezierCurveTo(p,x-m,b-g,d,b,d),i.bezierCurveTo(b+g,d,y,x-m,y,x),i.bezierCurveTo(y,x+m,b+g,v,b,v),i.bezierCurveTo(b-g,v,p,x+m,p,x),i.closePath(),s.fill&&(i.globalAlpha=s.fillAlpha*n,i.fillStyle=o="#"+("00000"+(0|s.fillColor).toString(16)).substr(-6),i.fill()),s.lineWidth&&(i.globalAlpha=s.lineAlpha*n,i.stroke())}}},e.CanvasGraphics.renderGraphicsMask=function(t,i){var n=t.graphicsData.length;if(0!==n){n>1&&(n=1,window.console.log("Pixi.js warning: masks in canvas can only mask using the first path in the graphics object"));for(var o=0;1>o;o++){var r=t.graphicsData[o],s=r.points;if(r.type===e.Graphics.POLY){i.beginPath(),i.moveTo(s[0],s[1]);for(var a=1;a<s.length/2;a++)i.lineTo(s[2*a],s[2*a+1]);s[0]===s[s.length-2]&&s[1]===s[s.length-1]&&i.closePath()}else if(r.type===e.Graphics.RECT)i.beginPath(),i.rect(s[0],s[1],s[2],s[3]),i.closePath();else if(r.type===e.Graphics.CIRC)i.beginPath(),i.arc(s[0],s[1],s[2],0,2*Math.PI),i.closePath();else if(r.type===e.Graphics.ELIP){var h=r.points,l=2*h[2],u=2*h[3],c=h[0]-l/2,p=h[1]-u/2;i.beginPath();var d=.5522848,f=l/2*d,g=u/2*d,m=c+l,y=p+u,v=c+l/2,b=p+u/2;i.moveTo(c,b),i.bezierCurveTo(c,b-g,v-f,p,v,p),i.bezierCurveTo(v+f,p,m,b-g,m,b),i.bezierCurveTo(m,b+g,v+f,y,v,y),i.bezierCurveTo(v-f,y,c,b+g,c,b),i.closePath()}}}},e.Graphics=function(){e.DisplayObjectContainer.call(this),this.renderable=!0,this.fillAlpha=1,this.lineWidth=0,this.lineColor="black",this.graphicsData=[],this.tint=16777215,this.blendMode=e.blendModes.NORMAL,this.currentPath={points:[]},this._webGL=[],this.isMask=!1,this.bounds=null,this.boundsPadding=10},e.Graphics.prototype=Object.create(e.DisplayObjectContainer.prototype),e.Graphics.prototype.constructor=e.Graphics,Object.defineProperty(e.Graphics.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(t){this._cacheAsBitmap=t,this._cacheAsBitmap?this._generateCachedSprite():(this.destroyCachedSprite(),this.dirty=!0)}}),e.Graphics.prototype.lineStyle=function(t,i,n){return this.currentPath.points.length||this.graphicsData.pop(),this.lineWidth=t||0,this.lineColor=i||0,this.lineAlpha=arguments.length<3?1:n,this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[],type:e.Graphics.POLY},this.graphicsData.push(this.currentPath),this},e.Graphics.prototype.moveTo=function(t,i){return this.currentPath.points.length||this.graphicsData.pop(),this.currentPath=this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[],type:e.Graphics.POLY},this.currentPath.points.push(t,i),this.graphicsData.push(this.currentPath),this},e.Graphics.prototype.lineTo=function(t,e){return this.currentPath.points.push(t,e),this.dirty=!0,this},e.Graphics.prototype.beginFill=function(t,e){return this.filling=!0,this.fillColor=t||0,this.fillAlpha=arguments.length<2?1:e,this},e.Graphics.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this},e.Graphics.prototype.drawRect=function(t,i,n,o){return this.currentPath.points.length||this.graphicsData.pop(),this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[t,i,n,o],type:e.Graphics.RECT},this.graphicsData.push(this.currentPath),this.dirty=!0,this},e.Graphics.prototype.drawCircle=function(t,i,n){return this.currentPath.points.length||this.graphicsData.pop(),this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[t,i,n,n],type:e.Graphics.CIRC},this.graphicsData.push(this.currentPath),this.dirty=!0,this},e.Graphics.prototype.drawEllipse=function(t,i,n,o){return this.currentPath.points.length||this.graphicsData.pop(),this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[t,i,n,o],type:e.Graphics.ELIP},this.graphicsData.push(this.currentPath),this.dirty=!0,this},e.Graphics.prototype.clear=function(){return this.lineWidth=0,this.filling=!1,this.dirty=!0,this.clearDirty=!0,this.graphicsData=[],this.bounds=null,this},e.Graphics.prototype.generateTexture=function(){var t=this.getBounds(),i=new e.CanvasBuffer(t.width,t.height),n=e.Texture.fromCanvas(i.canvas);
return i.context.translate(-t.x,-t.y),e.CanvasGraphics.renderGraphics(this,i.context),n},e.Graphics.prototype._renderWebGL=function(t){if(this.visible!==!1&&0!==this.alpha&&this.isMask!==!0){if(this._cacheAsBitmap)return this.dirty&&(this._generateCachedSprite(),e.updateWebGLTexture(this._cachedSprite.texture.baseTexture,t.gl),this.dirty=!1),this._cachedSprite.alpha=this.alpha,void e.Sprite.prototype._renderWebGL.call(this._cachedSprite,t);if(t.spriteBatch.stop(),this._mask&&t.maskManager.pushMask(this.mask,t),this._filters&&t.filterManager.pushFilter(this._filterBlock),this.blendMode!==t.spriteBatch.currentBlendMode){t.spriteBatch.currentBlendMode=this.blendMode;var i=e.blendModesWebGL[t.spriteBatch.currentBlendMode];t.spriteBatch.gl.blendFunc(i[0],i[1])}if(e.WebGLGraphics.renderGraphics(this,t),this.children.length){t.spriteBatch.start();for(var n=0,o=this.children.length;o>n;n++)this.children[n]._renderWebGL(t);t.spriteBatch.stop()}this._filters&&t.filterManager.popFilter(),this._mask&&t.maskManager.popMask(t),t.drawCount++,t.spriteBatch.start()}},e.Graphics.prototype._renderCanvas=function(t){if(this.visible!==!1&&0!==this.alpha&&this.isMask!==!0){var i=t.context,n=this.worldTransform;this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,i.globalCompositeOperation=e.blendModesCanvas[t.currentBlendMode]),i.setTransform(n.a,n.c,n.b,n.d,n.tx,n.ty),e.CanvasGraphics.renderGraphics(this,i);for(var o=0,r=this.children.length;r>o;o++)this.children[o]._renderCanvas(t)}},e.Graphics.prototype.getBounds=function(t){this.bounds||this.updateBounds();var e=this.bounds.x,i=this.bounds.width+this.bounds.x,n=this.bounds.y,o=this.bounds.height+this.bounds.y,r=t||this.worldTransform,s=r.a,a=r.c,h=r.b,l=r.d,u=r.tx,c=r.ty,p=s*i+h*o+u,d=l*o+a*i+c,f=s*e+h*o+u,g=l*o+a*e+c,m=s*e+h*n+u,y=l*n+a*e+c,v=s*i+h*n+u,b=l*n+a*i+c,x=p,w=d,S=p,C=d;S=S>f?f:S,S=S>m?m:S,S=S>v?v:S,C=C>g?g:C,C=C>y?y:C,C=C>b?b:C,x=f>x?f:x,x=m>x?m:x,x=v>x?v:x,w=g>w?g:w,w=y>w?y:w,w=b>w?b:w;var T=this._bounds;return T.x=S,T.width=x-S,T.y=C,T.height=w-C,T},e.Graphics.prototype.updateBounds=function(){for(var t,i,n,o,r,s=1/0,a=-1/0,h=1/0,l=-1/0,u=0;u<this.graphicsData.length;u++){var c=this.graphicsData[u],p=c.type,d=c.lineWidth;if(t=c.points,p===e.Graphics.RECT)i=t[0]-d/2,n=t[1]-d/2,o=t[2]+d,r=t[3]+d,s=s>i?i:s,a=i+o>a?i+o:a,h=h>n?i:h,l=n+r>l?n+r:l;else if(p===e.Graphics.CIRC||p===e.Graphics.ELIP)i=t[0],n=t[1],o=t[2]+d/2,r=t[3]+d/2,s=s>i-o?i-o:s,a=i+o>a?i+o:a,h=h>n-r?n-r:h,l=n+r>l?n+r:l;else for(var f=0;f<t.length;f+=2)i=t[f],n=t[f+1],s=s>i-d?i-d:s,a=i+d>a?i+d:a,h=h>n-d?n-d:h,l=n+d>l?n+d:l}var g=this.boundsPadding;this.bounds=new e.Rectangle(s-g,h-g,a-s+2*g,l-h+2*g)},e.Graphics.prototype._generateCachedSprite=function(){var t=this.getLocalBounds();if(this._cachedSprite)this._cachedSprite.buffer.resize(t.width,t.height);else{var i=new e.CanvasBuffer(t.width,t.height),n=e.Texture.fromCanvas(i.canvas);this._cachedSprite=new e.Sprite(n),this._cachedSprite.buffer=i,this._cachedSprite.worldTransform=this.worldTransform}this._cachedSprite.anchor.x=-(t.x/t.width),this._cachedSprite.anchor.y=-(t.y/t.height),this._cachedSprite.buffer.context.translate(-t.x,-t.y),e.CanvasGraphics.renderGraphics(this,this._cachedSprite.buffer.context),this._cachedSprite.alpha=this.alpha},e.Graphics.prototype.destroyCachedSprite=function(){this._cachedSprite.texture.destroy(!0),this._cachedSprite=null},e.Graphics.POLY=0,e.Graphics.RECT=1,e.Graphics.CIRC=2,e.Graphics.ELIP=3,e.Strip=function(t,i,n){e.Sprite.call(this,t),this.width=i,this.height=n,this.texture=t,this.blendMode=e.blendModes.NORMAL;try{this.uvs=new Float32Array([0,1,1,1,1,0,0,1]),this.verticies=new Float32Array([0,0,0,0,0,0,0,0,0]),this.colors=new Float32Array([1,1,1,1]),this.indices=new Uint16Array([0,1,2,3])}catch(o){this.uvs=[0,1,1,1,1,0,0,1],this.verticies=[0,0,0,0,0,0,0,0,0],this.colors=[1,1,1,1],this.indices=[0,1,2,3]}t.baseTexture.hasLoaded?(this.width=this.texture.frame.width,this.height=this.texture.frame.height,this.updateFrame=!0):(this.onTextureUpdateBind=this.onTextureUpdate.bind(this),this.texture.addEventListener("update",this.onTextureUpdateBind)),this.renderable=!0},e.Strip.prototype=Object.create(e.Sprite.prototype),e.Strip.prototype.constructor=e.Strip,e.Strip.prototype.onTextureUpdate=function(){this.updateFrame=!0},e.Rope=function(t,i){e.Strip.call(this,t),this.points=i;try{this.verticies=new Float32Array(4*i.length),this.uvs=new Float32Array(4*i.length),this.colors=new Float32Array(2*i.length),this.indices=new Uint16Array(2*i.length)}catch(n){this.verticies=new Array(4*i.length),this.uvs=new Array(4*i.length),this.colors=new Array(2*i.length),this.indices=new Array(2*i.length)}this.refresh()},e.Rope.prototype=Object.create(e.Strip.prototype),e.Rope.prototype.constructor=e.Rope,e.Rope.prototype.refresh=function(){var t=this.points;if(!(t.length<1)){var e=this.uvs,i=t[0],n=this.indices,o=this.colors;this.count-=.2,e[0]=0,e[1]=1,e[2]=0,e[3]=1,o[0]=1,o[1]=1,n[0]=0,n[1]=1;for(var r,s,a,h=t.length,l=1;h>l;l++)r=t[l],s=4*l,a=l/(h-1),l%2?(e[s]=a,e[s+1]=0,e[s+2]=a,e[s+3]=1):(e[s]=a,e[s+1]=0,e[s+2]=a,e[s+3]=1),s=2*l,o[s]=1,o[s+1]=1,s=2*l,n[s]=s,n[s+1]=s+1,i=r}},e.Rope.prototype.updateTransform=function(){var t=this.points;if(!(t.length<1)){var i,n=t[0],o={x:0,y:0};this.count-=.2;var r=this.verticies;r[0]=n.x+o.x,r[1]=n.y+o.y,r[2]=n.x-o.x,r[3]=n.y-o.y;for(var s,a,h,l,u,c=t.length,p=1;c>p;p++)s=t[p],a=4*p,i=p<t.length-1?t[p+1]:s,o.y=-(i.x-n.x),o.x=i.y-n.y,h=10*(1-p/(c-1)),h>1&&(h=1),l=Math.sqrt(o.x*o.x+o.y*o.y),u=this.texture.height/2,o.x/=l,o.y/=l,o.x*=u,o.y*=u,r[a]=s.x+o.x,r[a+1]=s.y+o.y,r[a+2]=s.x-o.x,r[a+3]=s.y-o.y,n=s;e.DisplayObjectContainer.prototype.updateTransform.call(this)}},e.Rope.prototype.setTexture=function(t){this.texture=t,this.updateFrame=!0},e.TilingSprite=function(t,i,n){e.Sprite.call(this,t),this.width=i||100,this.height=n||100,this.tileScale=new e.Point(1,1),this.tileScaleOffset=new e.Point(1,1),this.tilePosition=new e.Point(0,0),this.renderable=!0,this.tint=16777215,this.blendMode=e.blendModes.NORMAL},e.TilingSprite.prototype=Object.create(e.Sprite.prototype),e.TilingSprite.prototype.constructor=e.TilingSprite,Object.defineProperty(e.TilingSprite.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t}}),Object.defineProperty(e.TilingSprite.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t}}),e.TilingSprite.prototype.onTextureUpdate=function(){this.updateFrame=!0},e.TilingSprite.prototype.setTexture=function(t){this.texture!==t&&(this.texture=t,this.refreshTexture=!0,this.cachedTint=16777215)},e.TilingSprite.prototype._renderWebGL=function(t){if(this.visible!==!1&&0!==this.alpha){var i,n;for(this.mask&&(t.spriteBatch.stop(),t.maskManager.pushMask(this.mask,t),t.spriteBatch.start()),this.filters&&(t.spriteBatch.flush(),t.filterManager.pushFilter(this._filterBlock)),!this.tilingTexture||this.refreshTexture?(this.generateTilingTexture(!0),this.tilingTexture&&this.tilingTexture.needsUpdate&&(e.updateWebGLTexture(this.tilingTexture.baseTexture,t.gl),this.tilingTexture.needsUpdate=!1)):t.spriteBatch.renderTilingSprite(this),i=0,n=this.children.length;n>i;i++)this.children[i]._renderWebGL(t);t.spriteBatch.stop(),this.filters&&t.filterManager.popFilter(),this.mask&&t.maskManager.popMask(t),t.spriteBatch.start()}},e.TilingSprite.prototype._renderCanvas=function(t){if(this.visible!==!1&&0!==this.alpha){var i=t.context;this._mask&&t.maskManager.pushMask(this._mask,i),i.globalAlpha=this.worldAlpha;var n=this.worldTransform;if(i.setTransform(n.a,n.c,n.b,n.d,n.tx,n.ty),!this.__tilePattern||this.refreshTexture){if(this.generateTilingTexture(!1),!this.tilingTexture)return;this.__tilePattern=i.createPattern(this.tilingTexture.baseTexture.source,"repeat")}this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,i.globalCompositeOperation=e.blendModesCanvas[t.currentBlendMode]),i.beginPath();var o=this.tilePosition,r=this.tileScale;o.x%=this.tilingTexture.baseTexture.width,o.y%=this.tilingTexture.baseTexture.height,i.scale(r.x,r.y),i.translate(o.x,o.y),i.fillStyle=this.__tilePattern,i.fillRect(-o.x+this.anchor.x*-this._width,-o.y+this.anchor.y*-this._height,this._width/r.x,this._height/r.y),i.scale(1/r.x,1/r.y),i.translate(-o.x,-o.y),i.closePath(),this._mask&&t.maskManager.popMask(t.context)}},e.TilingSprite.prototype.getBounds=function(){var t=this._width,e=this._height,i=t*(1-this.anchor.x),n=t*-this.anchor.x,o=e*(1-this.anchor.y),r=e*-this.anchor.y,s=this.worldTransform,a=s.a,h=s.c,l=s.b,u=s.d,c=s.tx,p=s.ty,d=a*n+l*r+c,f=u*r+h*n+p,g=a*i+l*r+c,m=u*r+h*i+p,y=a*i+l*o+c,v=u*o+h*i+p,b=a*n+l*o+c,x=u*o+h*n+p,w=-1/0,S=-1/0,C=1/0,T=1/0;C=C>d?d:C,C=C>g?g:C,C=C>y?y:C,C=C>b?b:C,T=T>f?f:T,T=T>m?m:T,T=T>v?v:T,T=T>x?x:T,w=d>w?d:w,w=g>w?g:w,w=y>w?y:w,w=b>w?b:w,S=f>S?f:S,S=m>S?m:S,S=v>S?v:S,S=x>S?x:S;var _=this._bounds;return _.x=C,_.width=w-C,_.y=T,_.height=S-T,this._currentBounds=_,_},e.TilingSprite.prototype.generateTilingTexture=function(t){var i=this.texture;if(i.baseTexture.hasLoaded){var n,o,r=i.baseTexture,s=i.frame,a=s.width!==r.width||s.height!==r.height,h=!1;if(t?(n=e.getNextPowerOfTwo(s.width),o=e.getNextPowerOfTwo(s.height),s.width!==n&&s.height!==o&&(h=!0)):a&&(n=s.width,o=s.height,h=!0),h){var l;this.tilingTexture&&this.tilingTexture.isTiling?(l=this.tilingTexture.canvasBuffer,l.resize(n,o),this.tilingTexture.baseTexture.width=n,this.tilingTexture.baseTexture.height=o,this.tilingTexture.needsUpdate=!0):(l=new e.CanvasBuffer(n,o),this.tilingTexture=e.Texture.fromCanvas(l.canvas),this.tilingTexture.canvasBuffer=l,this.tilingTexture.isTiling=!0),l.context.drawImage(i.baseTexture.source,s.x,s.y,s.width,s.height,0,0,n,o),this.tileScaleOffset.x=s.width/n,this.tileScaleOffset.y=s.height/o}else this.tilingTexture&&this.tilingTexture.isTiling&&this.tilingTexture.destroy(!0),this.tileScaleOffset.x=1,this.tileScaleOffset.y=1,this.tilingTexture=i;this.refreshTexture=!1,this.tilingTexture.baseTexture._powerOf2=!0}};var s={};s.BoneData=function(t,e){this.name=t,this.parent=e},s.BoneData.prototype={length:0,x:0,y:0,rotation:0,scaleX:1,scaleY:1},s.SlotData=function(t,e){this.name=t,this.boneData=e},s.SlotData.prototype={r:1,g:1,b:1,a:1,attachmentName:null},s.Bone=function(t,e){this.data=t,this.parent=e,this.setToSetupPose()},s.Bone.yDown=!1,s.Bone.prototype={x:0,y:0,rotation:0,scaleX:1,scaleY:1,m00:0,m01:0,worldX:0,m10:0,m11:0,worldY:0,worldRotation:0,worldScaleX:1,worldScaleY:1,updateWorldTransform:function(t,e){var i=this.parent;null!=i?(this.worldX=this.x*i.m00+this.y*i.m01+i.worldX,this.worldY=this.x*i.m10+this.y*i.m11+i.worldY,this.worldScaleX=i.worldScaleX*this.scaleX,this.worldScaleY=i.worldScaleY*this.scaleY,this.worldRotation=i.worldRotation+this.rotation):(this.worldX=this.x,this.worldY=this.y,this.worldScaleX=this.scaleX,this.worldScaleY=this.scaleY,this.worldRotation=this.rotation);var n=this.worldRotation*Math.PI/180,o=Math.cos(n),r=Math.sin(n);this.m00=o*this.worldScaleX,this.m10=r*this.worldScaleX,this.m01=-r*this.worldScaleY,this.m11=o*this.worldScaleY,t&&(this.m00=-this.m00,this.m01=-this.m01),e&&(this.m10=-this.m10,this.m11=-this.m11),s.Bone.yDown&&(this.m10=-this.m10,this.m11=-this.m11)},setToSetupPose:function(){var t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY}},s.Slot=function(t,e,i){this.data=t,this.skeleton=e,this.bone=i,this.setToSetupPose()},s.Slot.prototype={r:1,g:1,b:1,a:1,_attachmentTime:0,attachment:null,setAttachment:function(t){this.attachment=t,this._attachmentTime=this.skeleton.time},setAttachmentTime:function(t){this._attachmentTime=this.skeleton.time-t},getAttachmentTime:function(){return this.skeleton.time-this._attachmentTime},setToSetupPose:function(){var t=this.data;this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a;for(var e=this.skeleton.data.slots,i=0,n=e.length;n>i;i++)if(e[i]==t){this.setAttachment(t.attachmentName?this.skeleton.getAttachmentBySlotIndex(i,t.attachmentName):null);break}}},s.Skin=function(t){this.name=t,this.attachments={}},s.Skin.prototype={addAttachment:function(t,e,i){this.attachments[t+":"+e]=i},getAttachment:function(t,e){return this.attachments[t+":"+e]},_attachAll:function(t,e){for(var i in e.attachments){var n=i.indexOf(":"),o=parseInt(i.substring(0,n),10),r=i.substring(n+1),s=t.slots[o];if(s.attachment&&s.attachment.name==r){var a=this.getAttachment(o,r);a&&s.setAttachment(a)}}}},s.Animation=function(t,e,i){this.name=t,this.timelines=e,this.duration=i},s.Animation.prototype={apply:function(t,e,i){i&&this.duration&&(e%=this.duration);for(var n=this.timelines,o=0,r=n.length;r>o;o++)n[o].apply(t,e,1)},mix:function(t,e,i,n){i&&this.duration&&(e%=this.duration);for(var o=this.timelines,r=0,s=o.length;s>r;r++)o[r].apply(t,e,n)}},s.binarySearch=function(t,e,i){var n=0,o=Math.floor(t.length/i)-2;if(!o)return i;for(var r=o>>>1;;){if(t[(r+1)*i]<=e?n=r+1:o=r,n==o)return(n+1)*i;r=n+o>>>1}},s.linearSearch=function(t,e,i){for(var n=0,o=t.length-i;o>=n;n+=i)if(t[n]>e)return n;return-1},s.Curves=function(t){this.curves=[],this.curves.length=6*(t-1)},s.Curves.prototype={setLinear:function(t){this.curves[6*t]=0},setStepped:function(t){this.curves[6*t]=-1},setCurve:function(t,e,i,n,o){var r=.1,s=r*r,a=s*r,h=3*r,l=3*s,u=6*s,c=6*a,p=2*-e+n,d=2*-i+o,f=3*(e-n)+1,g=3*(i-o)+1,m=6*t,y=this.curves;y[m]=e*h+p*l+f*a,y[m+1]=i*h+d*l+g*a,y[m+2]=p*u+f*c,y[m+3]=d*u+g*c,y[m+4]=f*c,y[m+5]=g*c},getCurvePercent:function(t,e){e=0>e?0:e>1?1:e;var i=6*t,n=this.curves,o=n[i];if(!o)return e;if(-1==o)return 0;for(var r=n[i+1],s=n[i+2],a=n[i+3],h=n[i+4],l=n[i+5],u=o,c=r,p=8;;){if(u>=e){var d=u-o,f=c-r;return f+(c-f)*(e-d)/(u-d)}if(!p)break;p--,o+=s,r+=a,s+=h,a+=l,u+=o,c+=r}return c+(1-c)*(e-u)/(1-u)}},s.RotateTimeline=function(t){this.curves=new s.Curves(t),this.frames=[],this.frames.length=2*t},s.RotateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(t,e,i){t*=2,this.frames[t]=e,this.frames[t+1]=i},apply:function(t,e,i){var n,o=this.frames;if(!(e<o[0])){var r=t.bones[this.boneIndex];if(e>=o[o.length-2]){for(n=r.data.rotation+o[o.length-1]-r.rotation;n>180;)n-=360;for(;-180>n;)n+=360;return void(r.rotation+=n*i)}var a=s.binarySearch(o,e,2),h=o[a-1],l=o[a],u=1-(e-l)/(o[a-2]-l);for(u=this.curves.getCurvePercent(a/2-1,u),n=o[a+1]-h;n>180;)n-=360;for(;-180>n;)n+=360;for(n=r.data.rotation+(h+n*u)-r.rotation;n>180;)n-=360;for(;-180>n;)n+=360;r.rotation+=n*i}}},s.TranslateTimeline=function(t){this.curves=new s.Curves(t),this.frames=[],this.frames.length=3*t},s.TranslateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(t,e,i,n){t*=3,this.frames[t]=e,this.frames[t+1]=i,this.frames[t+2]=n},apply:function(t,e,i){var n=this.frames;if(!(e<n[0])){var o=t.bones[this.boneIndex];if(e>=n[n.length-3])return o.x+=(o.data.x+n[n.length-2]-o.x)*i,void(o.y+=(o.data.y+n[n.length-1]-o.y)*i);var r=s.binarySearch(n,e,3),a=n[r-2],h=n[r-1],l=n[r],u=1-(e-l)/(n[r+-3]-l);u=this.curves.getCurvePercent(r/3-1,u),o.x+=(o.data.x+a+(n[r+1]-a)*u-o.x)*i,o.y+=(o.data.y+h+(n[r+2]-h)*u-o.y)*i}}},s.ScaleTimeline=function(t){this.curves=new s.Curves(t),this.frames=[],this.frames.length=3*t},s.ScaleTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(t,e,i,n){t*=3,this.frames[t]=e,this.frames[t+1]=i,this.frames[t+2]=n},apply:function(t,e,i){var n=this.frames;if(!(e<n[0])){var o=t.bones[this.boneIndex];if(e>=n[n.length-3])return o.scaleX+=(o.data.scaleX-1+n[n.length-2]-o.scaleX)*i,void(o.scaleY+=(o.data.scaleY-1+n[n.length-1]-o.scaleY)*i);var r=s.binarySearch(n,e,3),a=n[r-2],h=n[r-1],l=n[r],u=1-(e-l)/(n[r+-3]-l);u=this.curves.getCurvePercent(r/3-1,u),o.scaleX+=(o.data.scaleX-1+a+(n[r+1]-a)*u-o.scaleX)*i,o.scaleY+=(o.data.scaleY-1+h+(n[r+2]-h)*u-o.scaleY)*i}}},s.ColorTimeline=function(t){this.curves=new s.Curves(t),this.frames=[],this.frames.length=5*t},s.ColorTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(t,e){t*=5,this.frames[t]=e,this.frames[t+1]=r,this.frames[t+2]=g,this.frames[t+3]=b,this.frames[t+4]=a},apply:function(t,e,i){var n=this.frames;if(!(e<n[0])){var o=t.slots[this.slotIndex];if(e>=n[n.length-5]){var r=n.length-1;return o.r=n[r-3],o.g=n[r-2],o.b=n[r-1],void(o.a=n[r])}var a=s.binarySearch(n,e,5),h=n[a-4],l=n[a-3],u=n[a-2],c=n[a-1],p=n[a],d=1-(e-p)/(n[a-5]-p);d=this.curves.getCurvePercent(a/5-1,d);var f=h+(n[a+1]-h)*d,g=l+(n[a+2]-l)*d,m=u+(n[a+3]-u)*d,y=c+(n[a+4]-c)*d;1>i?(o.r+=(f-o.r)*i,o.g+=(g-o.g)*i,o.b+=(m-o.b)*i,o.a+=(y-o.a)*i):(o.r=f,o.g=g,o.b=m,o.a=y)}}},s.AttachmentTimeline=function(t){this.curves=new s.Curves(t),this.frames=[],this.frames.length=t,this.attachmentNames=[],this.attachmentNames.length=t},s.AttachmentTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length},setFrame:function(t,e,i){this.frames[t]=e,this.attachmentNames[t]=i},apply:function(t,e){var i=this.frames;if(!(e<i[0])){var n;n=e>=i[i.length-1]?i.length-1:s.binarySearch(i,e,1)-1;var o=this.attachmentNames[n];t.slots[this.slotIndex].setAttachment(o?t.getAttachmentBySlotIndex(this.slotIndex,o):null)}}},s.SkeletonData=function(){this.bones=[],this.slots=[],this.skins=[],this.animations=[]},s.SkeletonData.prototype={defaultSkin:null,findBone:function(t){for(var e=this.bones,i=0,n=e.length;n>i;i++)if(e[i].name==t)return e[i];return null},findBoneIndex:function(t){for(var e=this.bones,i=0,n=e.length;n>i;i++)if(e[i].name==t)return i;return-1},findSlot:function(t){for(var e=this.slots,i=0,n=e.length;n>i;i++)if(e[i].name==t)return slot[i];return null},findSlotIndex:function(t){for(var e=this.slots,i=0,n=e.length;n>i;i++)if(e[i].name==t)return i;return-1},findSkin:function(t){for(var e=this.skins,i=0,n=e.length;n>i;i++)if(e[i].name==t)return e[i];return null},findAnimation:function(t){for(var e=this.animations,i=0,n=e.length;n>i;i++)if(e[i].name==t)return e[i];return null}},s.Skeleton=function(t){this.data=t,this.bones=[];for(var e=0,i=t.bones.length;i>e;e++){var n=t.bones[e],o=n.parent?this.bones[t.bones.indexOf(n.parent)]:null;this.bones.push(new s.Bone(n,o))}for(this.slots=[],this.drawOrder=[],e=0,i=t.slots.length;i>e;e++){var r=t.slots[e],a=this.bones[t.bones.indexOf(r.boneData)],h=new s.Slot(r,this,a);this.slots.push(h),this.drawOrder.push(h)}},s.Skeleton.prototype={x:0,y:0,skin:null,r:1,g:1,b:1,a:1,time:0,flipX:!1,flipY:!1,updateWorldTransform:function(){for(var t=this.flipX,e=this.flipY,i=this.bones,n=0,o=i.length;o>n;n++)i[n].updateWorldTransform(t,e)},setToSetupPose:function(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()},setBonesToSetupPose:function(){for(var t=this.bones,e=0,i=t.length;i>e;e++)t[e].setToSetupPose()},setSlotsToSetupPose:function(){for(var t=this.slots,e=0,i=t.length;i>e;e++)t[e].setToSetupPose(e)},getRootBone:function(){return this.bones.length?this.bones[0]:null},findBone:function(t){for(var e=this.bones,i=0,n=e.length;n>i;i++)if(e[i].data.name==t)return e[i];return null},findBoneIndex:function(t){for(var e=this.bones,i=0,n=e.length;n>i;i++)if(e[i].data.name==t)return i;return-1},findSlot:function(t){for(var e=this.slots,i=0,n=e.length;n>i;i++)if(e[i].data.name==t)return e[i];return null},findSlotIndex:function(t){for(var e=this.slots,i=0,n=e.length;n>i;i++)if(e[i].data.name==t)return i;return-1},setSkinByName:function(t){var e=this.data.findSkin(t);if(!e)throw"Skin not found: "+t;this.setSkin(e)},setSkin:function(t){this.skin&&t&&t._attachAll(this,this.skin),this.skin=t},getAttachmentBySlotName:function(t,e){return this.getAttachmentBySlotIndex(this.data.findSlotIndex(t),e)},getAttachmentBySlotIndex:function(t,e){if(this.skin){var i=this.skin.getAttachment(t,e);if(i)return i}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(t,e):null},setAttachment:function(t,e){for(var i=this.slots,n=0,o=i.size;o>n;n++){var r=i[n];if(r.data.name==t){var s=null;if(e&&(s=this.getAttachment(n,e),null==s))throw"Attachment not found: "+e+", for slot: "+t;return void r.setAttachment(s)}}throw"Slot not found: "+t},update:function(t){time+=t}},s.AttachmentType={region:0},s.RegionAttachment=function(){this.offset=[],this.offset.length=8,this.uvs=[],this.uvs.length=8},s.RegionAttachment.prototype={x:0,y:0,rotation:0,scaleX:1,scaleY:1,width:0,height:0,rendererObject:null,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,setUVs:function(t,e,i,n,o){var r=this.uvs;o?(r[2]=t,r[3]=n,r[4]=t,r[5]=e,r[6]=i,r[7]=e,r[0]=i,r[1]=n):(r[0]=t,r[1]=n,r[2]=t,r[3]=e,r[4]=i,r[5]=e,r[6]=i,r[7]=n)},updateOffset:function(){var t=this.width/this.regionOriginalWidth*this.scaleX,e=this.height/this.regionOriginalHeight*this.scaleY,i=-this.width/2*this.scaleX+this.regionOffsetX*t,n=-this.height/2*this.scaleY+this.regionOffsetY*e,o=i+this.regionWidth*t,r=n+this.regionHeight*e,s=this.rotation*Math.PI/180,a=Math.cos(s),h=Math.sin(s),l=i*a+this.x,u=i*h,c=n*a+this.y,p=n*h,d=o*a+this.x,f=o*h,g=r*a+this.y,m=r*h,y=this.offset;y[0]=l-p,y[1]=c+u,y[2]=l-m,y[3]=g+u,y[4]=d-m,y[5]=g+f,y[6]=d-p,y[7]=c+f},computeVertices:function(t,e,i,n){t+=i.worldX,e+=i.worldY;var o=i.m00,r=i.m01,s=i.m10,a=i.m11,h=this.offset;n[0]=h[0]*o+h[1]*r+t,n[1]=h[0]*s+h[1]*a+e,n[2]=h[2]*o+h[3]*r+t,n[3]=h[2]*s+h[3]*a+e,n[4]=h[4]*o+h[5]*r+t,n[5]=h[4]*s+h[5]*a+e,n[6]=h[6]*o+h[7]*r+t,n[7]=h[6]*s+h[7]*a+e}},s.AnimationStateData=function(t){this.skeletonData=t,this.animationToMixTime={}},s.AnimationStateData.prototype={defaultMix:0,setMixByName:function(t,e,i){var n=this.skeletonData.findAnimation(t);if(!n)throw"Animation not found: "+t;var o=this.skeletonData.findAnimation(e);if(!o)throw"Animation not found: "+e;this.setMix(n,o,i)},setMix:function(t,e,i){this.animationToMixTime[t.name+":"+e.name]=i},getMix:function(t,e){var i=this.animationToMixTime[t.name+":"+e.name];return i?i:this.defaultMix}},s.AnimationState=function(t){this.data=t,this.queue=[]},s.AnimationState.prototype={current:null,previous:null,currentTime:0,previousTime:0,currentLoop:!1,previousLoop:!1,mixTime:0,mixDuration:0,update:function(t){if(this.currentTime+=t,this.previousTime+=t,this.mixTime+=t,this.queue.length>0){var e=this.queue[0];this.currentTime>=e.delay&&(this._setAnimation(e.animation,e.loop),this.queue.shift())}},apply:function(t){if(this.current)if(this.previous){this.previous.apply(t,this.previousTime,this.previousLoop);var e=this.mixTime/this.mixDuration;e>=1&&(e=1,this.previous=null),this.current.mix(t,this.currentTime,this.currentLoop,e)}else this.current.apply(t,this.currentTime,this.currentLoop)},clearAnimation:function(){this.previous=null,this.current=null,this.queue.length=0},_setAnimation:function(t,e){this.previous=null,t&&this.current&&(this.mixDuration=this.data.getMix(this.current,t),this.mixDuration>0&&(this.mixTime=0,this.previous=this.current,this.previousTime=this.currentTime,this.previousLoop=this.currentLoop)),this.current=t,this.currentLoop=e,this.currentTime=0},setAnimationByName:function(t,e){var i=this.data.skeletonData.findAnimation(t);if(!i)throw"Animation not found: "+t;this.setAnimation(i,e)},setAnimation:function(t,e){this.queue.length=0,this._setAnimation(t,e)},addAnimationByName:function(t,e,i){var n=this.data.skeletonData.findAnimation(t);if(!n)throw"Animation not found: "+t;this.addAnimation(n,e,i)},addAnimation:function(t,e,i){var n={};if(n.animation=t,n.loop=e,!i||0>=i){var o=this.queue.length?this.queue[this.queue.length-1].animation:this.current;i=null!=o?o.duration-this.data.getMix(o,t)+(i||0):0}n.delay=i,this.queue.push(n)},isComplete:function(){return!this.current||this.currentTime>=this.current.duration}},s.SkeletonJson=function(t){this.attachmentLoader=t},s.SkeletonJson.prototype={scale:1,readSkeletonData:function(t){for(var e,i=new s.SkeletonData,n=t.bones,o=0,r=n.length;r>o;o++){var a=n[o],h=null;if(a.parent&&(h=i.findBone(a.parent),!h))throw"Parent bone not found: "+a.parent;e=new s.BoneData(a.name,h),e.length=(a.length||0)*this.scale,e.x=(a.x||0)*this.scale,e.y=(a.y||0)*this.scale,e.rotation=a.rotation||0,e.scaleX=a.scaleX||1,e.scaleY=a.scaleY||1,i.bones.push(e)}var l=t.slots;for(o=0,r=l.length;r>o;o++){var u=l[o];if(e=i.findBone(u.bone),!e)throw"Slot bone not found: "+u.bone;var c=new s.SlotData(u.name,e),p=u.color;p&&(c.r=s.SkeletonJson.toColor(p,0),c.g=s.SkeletonJson.toColor(p,1),c.b=s.SkeletonJson.toColor(p,2),c.a=s.SkeletonJson.toColor(p,3)),c.attachmentName=u.attachment,i.slots.push(c)}var d=t.skins;for(var f in d)if(d.hasOwnProperty(f)){var g=d[f],m=new s.Skin(f);for(var y in g)if(g.hasOwnProperty(y)){var v=i.findSlotIndex(y),b=g[y];for(var x in b)if(b.hasOwnProperty(x)){var w=this.readAttachment(m,x,b[x]);null!=w&&m.addAttachment(v,x,w)}}i.skins.push(m),"default"==m.name&&(i.defaultSkin=m)}var S=t.animations;for(var C in S)S.hasOwnProperty(C)&&this.readAnimation(C,S[C],i);return i},readAttachment:function(t,e,i){e=i.name||e;var n=s.AttachmentType[i.type||"region"];if(n==s.AttachmentType.region){var o=new s.RegionAttachment;return o.x=(i.x||0)*this.scale,o.y=(i.y||0)*this.scale,o.scaleX=i.scaleX||1,o.scaleY=i.scaleY||1,o.rotation=i.rotation||0,o.width=(i.width||32)*this.scale,o.height=(i.height||32)*this.scale,o.updateOffset(),o.rendererObject={},o.rendererObject.name=e,o.rendererObject.scale={},o.rendererObject.scale.x=o.scaleX,o.rendererObject.scale.y=o.scaleY,o.rendererObject.rotation=-o.rotation*Math.PI/180,o}throw"Unknown attachment type: "+n},readAnimation:function(t,e,i){var n,o,r,a,h,l,u,c=[],p=0,d=e.bones;for(var f in d)if(d.hasOwnProperty(f)){var g=i.findBoneIndex(f);if(-1==g)throw"Bone not found: "+f;var m=d[f];for(r in m)if(m.hasOwnProperty(r))if(h=m[r],"rotate"==r){for(o=new s.RotateTimeline(h.length),o.boneIndex=g,n=0,l=0,u=h.length;u>l;l++)a=h[l],o.setFrame(n,a.time,a.angle),s.SkeletonJson.readCurve(o,n,a),n++;c.push(o),p=Math.max(p,o.frames[2*o.getFrameCount()-2])}else{if("translate"!=r&&"scale"!=r)throw"Invalid timeline type for a bone: "+r+" ("+f+")";var y=1;for("scale"==r?o=new s.ScaleTimeline(h.length):(o=new s.TranslateTimeline(h.length),y=this.scale),o.boneIndex=g,n=0,l=0,u=h.length;u>l;l++){a=h[l];var v=(a.x||0)*y,b=(a.y||0)*y;o.setFrame(n,a.time,v,b),s.SkeletonJson.readCurve(o,n,a),n++}c.push(o),p=Math.max(p,o.frames[3*o.getFrameCount()-3])}}var x=e.slots;for(var w in x)if(x.hasOwnProperty(w)){var S=x[w],C=i.findSlotIndex(w);for(r in S)if(S.hasOwnProperty(r))if(h=S[r],"color"==r){for(o=new s.ColorTimeline(h.length),o.slotIndex=C,n=0,l=0,u=h.length;u>l;l++){a=h[l];var T=a.color,_=s.SkeletonJson.toColor(T,0),M=s.SkeletonJson.toColor(T,1),E=s.SkeletonJson.toColor(T,2),A=s.SkeletonJson.toColor(T,3);o.setFrame(n,a.time,_,M,E,A),s.SkeletonJson.readCurve(o,n,a),n++}c.push(o),p=Math.max(p,o.frames[5*o.getFrameCount()-5])}else{if("attachment"!=r)throw"Invalid timeline type for a slot: "+r+" ("+w+")";for(o=new s.AttachmentTimeline(h.length),o.slotIndex=C,n=0,l=0,u=h.length;u>l;l++)a=h[l],o.setFrame(n++,a.time,a.name);c.push(o),p=Math.max(p,o.frames[o.getFrameCount()-1])}}i.animations.push(new s.Animation(t,c,p))}},s.SkeletonJson.readCurve=function(t,e,i){var n=i.curve;n&&("stepped"==n?t.curves.setStepped(e):n instanceof Array&&t.curves.setCurve(e,n[0],n[1],n[2],n[3]))},s.SkeletonJson.toColor=function(t,e){if(8!=t.length)throw"Color hexidecimal length must be 8, recieved: "+t;return parseInt(t.substring(2*e,2),16)/255},s.Atlas=function(t,e){this.textureLoader=e,this.pages=[],this.regions=[];var i=new s.AtlasReader(t),n=[];n.length=4;for(var o=null;;){var r=i.readLine();if(null==r)break;if(r=i.trim(r),r.length)if(o){var a=new s.AtlasRegion;a.name=r,a.page=o,a.rotate="true"==i.readValue(),i.readTuple(n);var h=parseInt(n[0],10),l=parseInt(n[1],10);i.readTuple(n);var u=parseInt(n[0],10),c=parseInt(n[1],10);a.u=h/o.width,a.v=l/o.height,a.rotate?(a.u2=(h+c)/o.width,a.v2=(l+u)/o.height):(a.u2=(h+u)/o.width,a.v2=(l+c)/o.height),a.x=h,a.y=l,a.width=Math.abs(u),a.height=Math.abs(c),4==i.readTuple(n)&&(a.splits=[parseInt(n[0],10),parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3],10)],4==i.readTuple(n)&&(a.pads=[parseInt(n[0],10),parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3],10)],i.readTuple(n))),a.originalWidth=parseInt(n[0],10),a.originalHeight=parseInt(n[1],10),i.readTuple(n),a.offsetX=parseInt(n[0],10),a.offsetY=parseInt(n[1],10),a.index=parseInt(i.readValue(),10),this.regions.push(a)}else{o=new s.AtlasPage,o.name=r,o.format=s.Atlas.Format[i.readValue()],i.readTuple(n),o.minFilter=s.Atlas.TextureFilter[n[0]],o.magFilter=s.Atlas.TextureFilter[n[1]];var p=i.readValue();o.uWrap=s.Atlas.TextureWrap.clampToEdge,o.vWrap=s.Atlas.TextureWrap.clampToEdge,"x"==p?o.uWrap=s.Atlas.TextureWrap.repeat:"y"==p?o.vWrap=s.Atlas.TextureWrap.repeat:"xy"==p&&(o.uWrap=o.vWrap=s.Atlas.TextureWrap.repeat),e.load(o,r),this.pages.push(o)}else o=null}},s.Atlas.prototype={findRegion:function(t){for(var e=this.regions,i=0,n=e.length;n>i;i++)if(e[i].name==t)return e[i];return null},dispose:function(){for(var t=this.pages,e=0,i=t.length;i>e;e++)this.textureLoader.unload(t[e].rendererObject)},updateUVs:function(t){for(var e=this.regions,i=0,n=e.length;n>i;i++){var o=e[i];o.page==t&&(o.u=o.x/t.width,o.v=o.y/t.height,o.rotate?(o.u2=(o.x+o.height)/t.width,o.v2=(o.y+o.width)/t.height):(o.u2=(o.x+o.width)/t.width,o.v2=(o.y+o.height)/t.height))}}},s.Atlas.Format={alpha:0,intensity:1,luminanceAlpha:2,rgb565:3,rgba4444:4,rgb888:5,rgba8888:6},s.Atlas.TextureFilter={nearest:0,linear:1,mipMap:2,mipMapNearestNearest:3,mipMapLinearNearest:4,mipMapNearestLinear:5,mipMapLinearLinear:6},s.Atlas.TextureWrap={mirroredRepeat:0,clampToEdge:1,repeat:2},s.AtlasPage=function(){},s.AtlasPage.prototype={name:null,format:null,minFilter:null,magFilter:null,uWrap:null,vWrap:null,rendererObject:null,width:0,height:0},s.AtlasRegion=function(){},s.AtlasRegion.prototype={page:null,name:null,x:0,y:0,width:0,height:0,u:0,v:0,u2:0,v2:0,offsetX:0,offsetY:0,originalWidth:0,originalHeight:0,index:0,rotate:!1,splits:null,pads:null},s.AtlasReader=function(t){this.lines=t.split(/\r\n|\r|\n/)},s.AtlasReader.prototype={index:0,trim:function(t){return t.replace(/^\s+|\s+$/g,"")},readLine:function(){return this.index>=this.lines.length?null:this.lines[this.index++]},readValue:function(){var t=this.readLine(),e=t.indexOf(":");if(-1==e)throw"Invalid line: "+t;return this.trim(t.substring(e+1))},readTuple:function(t){var e=this.readLine(),i=e.indexOf(":");if(-1==i)throw"Invalid line: "+e;for(var n=0,o=i+1;3>n;n++){var r=e.indexOf(",",o);if(-1==r){if(!n)throw"Invalid line: "+e;break}t[n]=this.trim(e.substr(o,r-o)),o=r+1}return t[n]=this.trim(e.substring(o)),n+1}},s.AtlasAttachmentLoader=function(t){this.atlas=t},s.AtlasAttachmentLoader.prototype={newAttachment:function(t,e,i){switch(e){case s.AttachmentType.region:var n=this.atlas.findRegion(i);if(!n)throw"Region not found in atlas: "+i+" ("+e+")";var o=new s.RegionAttachment(i);return o.rendererObject=n,o.setUVs(n.u,n.v,n.u2,n.v2,n.rotate),o.regionOffsetX=n.offsetX,o.regionOffsetY=n.offsetY,o.regionWidth=n.width,o.regionHeight=n.height,o.regionOriginalWidth=n.originalWidth,o.regionOriginalHeight=n.originalHeight,o}throw"Unknown attachment type: "+e}},s.Bone.yDown=!0,e.AnimCache={},e.Spine=function(t){if(e.DisplayObjectContainer.call(this),this.spineData=e.AnimCache[t],!this.spineData)throw new Error("Spine data must be preloaded using PIXI.SpineLoader or PIXI.AssetLoader: "+t);this.skeleton=new s.Skeleton(this.spineData),this.skeleton.updateWorldTransform(),this.stateData=new s.AnimationStateData(this.spineData),this.state=new s.AnimationState(this.stateData),this.slotContainers=[];for(var i=0,n=this.skeleton.drawOrder.length;n>i;i++){var o=this.skeleton.drawOrder[i],r=o.attachment,a=new e.DisplayObjectContainer;if(this.slotContainers.push(a),this.addChild(a),r instanceof s.RegionAttachment){var h=r.rendererObject.name,l=this.createSprite(o,r.rendererObject);o.currentSprite=l,o.currentSpriteName=h,a.addChild(l)}}},e.Spine.prototype=Object.create(e.DisplayObjectContainer.prototype),e.Spine.prototype.constructor=e.Spine,e.Spine.prototype.updateTransform=function(){this.lastTime=this.lastTime||Date.now();
var t=.001*(Date.now()-this.lastTime);this.lastTime=Date.now(),this.state.update(t),this.state.apply(this.skeleton),this.skeleton.updateWorldTransform();for(var i=this.skeleton.drawOrder,n=0,o=i.length;o>n;n++){var r=i[n],a=r.attachment,h=this.slotContainers[n];if(a instanceof s.RegionAttachment){if(a.rendererObject&&(!r.currentSpriteName||r.currentSpriteName!=a.name)){var l=a.rendererObject.name;if(void 0!==r.currentSprite&&(r.currentSprite.visible=!1),r.sprites=r.sprites||{},void 0!==r.sprites[l])r.sprites[l].visible=!0;else{var u=this.createSprite(r,a.rendererObject);h.addChild(u)}r.currentSprite=r.sprites[l],r.currentSpriteName=l}h.visible=!0;var c=r.bone;h.position.x=c.worldX+a.x*c.m00+a.y*c.m01,h.position.y=c.worldY+a.x*c.m10+a.y*c.m11,h.scale.x=c.worldScaleX,h.scale.y=c.worldScaleY,h.rotation=-(r.bone.worldRotation*Math.PI/180)}else h.visible=!1}e.DisplayObjectContainer.prototype.updateTransform.call(this)},e.Spine.prototype.createSprite=function(t,i){var n=e.TextureCache[i.name]?i.name:i.name+".png",o=new e.Sprite(e.Texture.fromFrame(n));return o.scale=i.scale,o.rotation=i.rotation,o.anchor.x=o.anchor.y=.5,t.sprites=t.sprites||{},t.sprites[i.name]=o,o},e.BaseTextureCache={},e.texturesToUpdate=[],e.texturesToDestroy=[],e.BaseTextureCacheIdGenerator=0,e.BaseTexture=function(t,i){if(e.EventTarget.call(this),this.width=100,this.height=100,this.scaleMode=i||e.scaleModes.DEFAULT,this.hasLoaded=!1,this.source=t,this.id=e.BaseTextureCacheIdGenerator++,this._glTextures=[],t){if((this.source.complete||this.source.getContext)&&this.source.width&&this.source.height)this.hasLoaded=!0,this.width=this.source.width,this.height=this.source.height,e.texturesToUpdate.push(this);else{var n=this;this.source.onload=function(){n.hasLoaded=!0,n.width=n.source.width,n.height=n.source.height,e.texturesToUpdate.push(n),n.dispatchEvent({type:"loaded",content:n})}}this.imageUrl=null,this._powerOf2=!1}},e.BaseTexture.prototype.constructor=e.BaseTexture,e.BaseTexture.prototype.destroy=function(){this.imageUrl&&(delete e.BaseTextureCache[this.imageUrl],this.imageUrl=null,this.source.src=null),this.source=null,e.texturesToDestroy.push(this)},e.BaseTexture.prototype.updateSourceImage=function(t){this.hasLoaded=!1,this.source.src=null,this.source.src=t},e.BaseTexture.fromImage=function(t,i,n){var o=e.BaseTextureCache[t];if(void 0===i&&-1===t.indexOf("data:")&&(i=!0),!o){var r=new Image;i&&(r.crossOrigin=""),r.src=t,o=new e.BaseTexture(r,n),o.imageUrl=t,e.BaseTextureCache[t]=o}return o},e.BaseTexture.fromCanvas=function(t,i){t._pixiId||(t._pixiId="canvas_"+e.TextureCacheIdGenerator++);var n=e.BaseTextureCache[t._pixiId];return n||(n=new e.BaseTexture(t,i),e.BaseTextureCache[t._pixiId]=n),n},e.TextureCache={},e.FrameCache={},e.TextureCacheIdGenerator=0,e.Texture=function(t,i){if(e.EventTarget.call(this),i||(this.noFrame=!0,i=new e.Rectangle(0,0,1,1)),t instanceof e.Texture&&(t=t.baseTexture),this.baseTexture=t,this.frame=i,this.trim=null,this.scope=this,this._uvs=null,t.hasLoaded)this.noFrame&&(i=new e.Rectangle(0,0,t.width,t.height)),this.setFrame(i);else{var n=this;t.addEventListener("loaded",function(){n.onBaseTextureLoaded()})}},e.Texture.prototype.constructor=e.Texture,e.Texture.prototype.onBaseTextureLoaded=function(){var t=this.baseTexture;t.removeEventListener("loaded",this.onLoaded),this.noFrame&&(this.frame=new e.Rectangle(0,0,t.width,t.height)),this.setFrame(this.frame),this.scope.dispatchEvent({type:"update",content:this})},e.Texture.prototype.destroy=function(t){t&&this.baseTexture.destroy()},e.Texture.prototype.setFrame=function(t){if(this.frame=t,this.width=t.width,this.height=t.height,t.x+t.width>this.baseTexture.width||t.y+t.height>this.baseTexture.height)throw new Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);this.updateFrame=!0,e.Texture.frameUpdates.push(this)},e.Texture.prototype._updateWebGLuvs=function(){this._uvs||(this._uvs=new e.TextureUvs);var t=this.frame,i=this.baseTexture.width,n=this.baseTexture.height;this._uvs.x0=t.x/i,this._uvs.y0=t.y/n,this._uvs.x1=(t.x+t.width)/i,this._uvs.y1=t.y/n,this._uvs.x2=(t.x+t.width)/i,this._uvs.y2=(t.y+t.height)/n,this._uvs.x3=t.x/i,this._uvs.y3=(t.y+t.height)/n},e.Texture.fromImage=function(t,i,n){var o=e.TextureCache[t];return o||(o=new e.Texture(e.BaseTexture.fromImage(t,i,n)),e.TextureCache[t]=o),o},e.Texture.fromFrame=function(t){var i=e.TextureCache[t];if(!i)throw new Error('The frameId "'+t+'" does not exist in the texture cache ');return i},e.Texture.fromCanvas=function(t,i){var n=e.BaseTexture.fromCanvas(t,i);return new e.Texture(n)},e.Texture.addTextureToCache=function(t,i){e.TextureCache[i]=t},e.Texture.removeTextureFromCache=function(t){var i=e.TextureCache[t];return delete e.TextureCache[t],delete e.BaseTextureCache[t],i},e.Texture.frameUpdates=[],e.TextureUvs=function(){this.x0=0,this.y0=0,this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.x3=0,this.y4=0},e.RenderTexture=function(t,i,n,o){if(e.EventTarget.call(this),this.width=t||100,this.height=i||100,this.frame=new e.Rectangle(0,0,this.width,this.height),this.baseTexture=new e.BaseTexture,this.baseTexture.width=this.width,this.baseTexture.height=this.height,this.baseTexture._glTextures=[],this.baseTexture.scaleMode=o||e.scaleModes.DEFAULT,this.baseTexture.hasLoaded=!0,this.renderer=n||e.defaultRenderer,this.renderer.type===e.WEBGL_RENDERER){var r=this.renderer.gl;this.textureBuffer=new e.FilterTexture(r,this.width,this.height,this.baseTexture.scaleMode),this.baseTexture._glTextures[r.id]=this.textureBuffer.texture,this.render=this.renderWebGL,this.projection=new e.Point(this.width/2,-this.height/2)}else this.render=this.renderCanvas,this.textureBuffer=new e.CanvasBuffer(this.width,this.height),this.baseTexture.source=this.textureBuffer.canvas;e.Texture.frameUpdates.push(this)},e.RenderTexture.prototype=Object.create(e.Texture.prototype),e.RenderTexture.prototype.constructor=e.RenderTexture,e.RenderTexture.prototype.resize=function(t,i){if(this.width=t,this.height=i,this.frame.width=this.width,this.frame.height=this.height,this.renderer.type===e.WEBGL_RENDERER){this.projection.x=this.width/2,this.projection.y=-this.height/2;var n=this.renderer.gl;n.bindTexture(n.TEXTURE_2D,this.baseTexture._glTextures[n.id]),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,this.width,this.height,0,n.RGBA,n.UNSIGNED_BYTE,null)}else this.textureBuffer.resize(this.width,this.height);e.Texture.frameUpdates.push(this)},e.RenderTexture.prototype.renderWebGL=function(t,i,n){var o=this.renderer.gl;o.colorMask(!0,!0,!0,!0),o.viewport(0,0,this.width,this.height),o.bindFramebuffer(o.FRAMEBUFFER,this.textureBuffer.frameBuffer),n&&this.textureBuffer.clear();var r=t.children,s=t.worldTransform;t.worldTransform=e.RenderTexture.tempMatrix,t.worldTransform.d=-1,t.worldTransform.ty=-2*this.projection.y,i&&(t.worldTransform.tx=i.x,t.worldTransform.ty-=i.y);for(var a=0,h=r.length;h>a;a++)r[a].updateTransform();e.WebGLRenderer.updateTextures(),this.renderer.renderDisplayObject(t,this.projection,this.textureBuffer.frameBuffer),t.worldTransform=s},e.RenderTexture.prototype.renderCanvas=function(t,i,n){var o=t.children,r=t.worldTransform;t.worldTransform=e.RenderTexture.tempMatrix,i&&(t.worldTransform.tx=i.x,t.worldTransform.ty=i.y);for(var s=0,a=o.length;a>s;s++)o[s].updateTransform();n&&this.textureBuffer.clear();var h=this.textureBuffer.context;this.renderer.renderDisplayObject(t,h),h.setTransform(1,0,0,1,0,0),t.worldTransform=r},e.RenderTexture.tempMatrix=new e.Matrix,e.AssetLoader=function(t,i){e.EventTarget.call(this),this.assetURLs=t,this.crossorigin=i,this.loadersByType={jpg:e.ImageLoader,jpeg:e.ImageLoader,png:e.ImageLoader,gif:e.ImageLoader,json:e.JsonLoader,atlas:e.AtlasLoader,anim:e.SpineLoader,xml:e.BitmapFontLoader,fnt:e.BitmapFontLoader}},e.AssetLoader.prototype.constructor=e.AssetLoader,e.AssetLoader.prototype._getDataType=function(t){var e="data:",i=t.slice(0,e.length).toLowerCase();if(i===e){var n=t.slice(e.length),o=n.indexOf(",");if(-1===o)return null;var r=n.slice(0,o).split(";")[0];return r&&"text/plain"!==r.toLowerCase()?r.split("/").pop().toLowerCase():"txt"}return null},e.AssetLoader.prototype.load=function(){function t(t){e.onAssetLoaded(t.content)}var e=this;this.loadCount=this.assetURLs.length;for(var i=0;i<this.assetURLs.length;i++){var n=this.assetURLs[i],o=this._getDataType(n);o||(o=n.split("?").shift().split(".").pop().toLowerCase());var r=this.loadersByType[o];if(!r)throw new Error(o+" is an unsupported file type");var s=new r(n,this.crossorigin);s.addEventListener("loaded",t),s.load()}},e.AssetLoader.prototype.onAssetLoaded=function(t){this.loadCount--,this.dispatchEvent({type:"onProgress",content:this,loader:t}),this.onProgress&&this.onProgress(t),this.loadCount||(this.dispatchEvent({type:"onComplete",content:this}),this.onComplete&&this.onComplete())},e.JsonLoader=function(t,i){e.EventTarget.call(this),this.url=t,this.crossorigin=i,this.baseUrl=t.replace(/[^\/]*$/,""),this.loaded=!1},e.JsonLoader.prototype.constructor=e.JsonLoader,e.JsonLoader.prototype.load=function(){var t=this;window.XDomainRequest?(this.ajaxRequest=new window.XDomainRequest,this.ajaxRequest.timeout=3e3,this.ajaxRequest.onerror=function(){t.onError()},this.ajaxRequest.ontimeout=function(){t.onError()},this.ajaxRequest.onprogress=function(){}):this.ajaxRequest=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP"),this.ajaxRequest.onload=function(){t.onJSONLoaded()},this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.send()},e.JsonLoader.prototype.onJSONLoaded=function(){if(!this.ajaxRequest.responseText)return void this.onError();if(this.json=JSON.parse(this.ajaxRequest.responseText),this.json.frames){var t=this,i=this.baseUrl+this.json.meta.image,n=new e.ImageLoader(i,this.crossorigin),o=this.json.frames;this.texture=n.texture.baseTexture,n.addEventListener("loaded",function(){t.onLoaded()});for(var r in o){var a=o[r].frame;if(a&&(e.TextureCache[r]=new e.Texture(this.texture,{x:a.x,y:a.y,width:a.w,height:a.h}),o[r].trimmed)){var h=e.TextureCache[r],l=o[r].sourceSize,u=o[r].spriteSourceSize;h.trim=new e.Rectangle(u.x,u.y,l.w,l.h)}}n.load()}else if(this.json.bones){var c=new s.SkeletonJson,p=c.readSkeletonData(this.json);e.AnimCache[this.url]=p,this.onLoaded()}else this.onLoaded()},e.JsonLoader.prototype.onLoaded=function(){this.loaded=!0,this.dispatchEvent({type:"loaded",content:this})},e.JsonLoader.prototype.onError=function(){this.dispatchEvent({type:"error",content:this})},e.AtlasLoader=function(t,i){e.EventTarget.call(this),this.url=t,this.baseUrl=t.replace(/[^\/]*$/,""),this.crossorigin=i,this.loaded=!1},e.AtlasLoader.constructor=e.AtlasLoader,e.AtlasLoader.prototype.load=function(){this.ajaxRequest=new e.AjaxRequest,this.ajaxRequest.onreadystatechange=this.onAtlasLoaded.bind(this),this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/json"),this.ajaxRequest.send(null)},e.AtlasLoader.prototype.onAtlasLoaded=function(){if(4===this.ajaxRequest.readyState)if(200===this.ajaxRequest.status||-1===window.location.href.indexOf("http")){this.atlas={meta:{image:[]},frames:[]};var t=this.ajaxRequest.responseText.split(/\r?\n/),i=-3,n=0,o=null,r=!1,s=0,a=0,h=this.onLoaded.bind(this);for(s=0;s<t.length;s++)if(t[s]=t[s].replace(/^\s+|\s+$/g,""),""===t[s]&&(r=s+1),t[s].length>0){if(r===s)this.atlas.meta.image.push(t[s]),n=this.atlas.meta.image.length-1,this.atlas.frames.push({}),i=-3;else if(i>0)if(i%7===1)null!=o&&(this.atlas.frames[n][o.name]=o),o={name:t[s],frame:{}};else{var l=t[s].split(" ");if(i%7===3)o.frame.x=Number(l[1].replace(",","")),o.frame.y=Number(l[2]);else if(i%7===4)o.frame.w=Number(l[1].replace(",","")),o.frame.h=Number(l[2]);else if(i%7===5){var u={x:0,y:0,w:Number(l[1].replace(",","")),h:Number(l[2])};u.w>o.frame.w||u.h>o.frame.h?(o.trimmed=!0,o.realSize=u):o.trimmed=!1}}i++}if(null!=o&&(this.atlas.frames[n][o.name]=o),this.atlas.meta.image.length>0){for(this.images=[],a=0;a<this.atlas.meta.image.length;a++){var c=this.baseUrl+this.atlas.meta.image[a],p=this.atlas.frames[a];this.images.push(new e.ImageLoader(c,this.crossorigin));for(s in p){var d=p[s].frame;d&&(e.TextureCache[s]=new e.Texture(this.images[a].texture.baseTexture,{x:d.x,y:d.y,width:d.w,height:d.h}),p[s].trimmed&&(e.TextureCache[s].realSize=p[s].realSize,e.TextureCache[s].trim.x=0,e.TextureCache[s].trim.y=0))}}for(this.currentImageId=0,a=0;a<this.images.length;a++)this.images[a].addEventListener("loaded",h);this.images[this.currentImageId].load()}else this.onLoaded()}else this.onError()},e.AtlasLoader.prototype.onLoaded=function(){this.images.length-1>this.currentImageId?(this.currentImageId++,this.images[this.currentImageId].load()):(this.loaded=!0,this.dispatchEvent({type:"loaded",content:this}))},e.AtlasLoader.prototype.onError=function(){this.dispatchEvent({type:"error",content:this})},e.SpriteSheetLoader=function(t,i){e.EventTarget.call(this),this.url=t,this.crossorigin=i,this.baseUrl=t.replace(/[^\/]*$/,""),this.texture=null,this.frames={}},e.SpriteSheetLoader.prototype.constructor=e.SpriteSheetLoader,e.SpriteSheetLoader.prototype.load=function(){var t=this,i=new e.JsonLoader(this.url,this.crossorigin);i.addEventListener("loaded",function(e){t.json=e.content.json,t.onLoaded()}),i.load()},e.SpriteSheetLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})},e.ImageLoader=function(t,i){e.EventTarget.call(this),this.texture=e.Texture.fromImage(t,i),this.frames=[]},e.ImageLoader.prototype.constructor=e.ImageLoader,e.ImageLoader.prototype.load=function(){if(this.texture.baseTexture.hasLoaded)this.onLoaded();else{var t=this;this.texture.baseTexture.addEventListener("loaded",function(){t.onLoaded()})}},e.ImageLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})},e.ImageLoader.prototype.loadFramedSpriteSheet=function(t,i,n){this.frames=[];for(var o=Math.floor(this.texture.width/t),r=Math.floor(this.texture.height/i),s=0,a=0;r>a;a++)for(var h=0;o>h;h++,s++){var l=new e.Texture(this.texture,{x:h*t,y:a*i,width:t,height:i});this.frames.push(l),n&&(e.TextureCache[n+"-"+s]=l)}if(this.texture.baseTexture.hasLoaded)this.onLoaded();else{var u=this;this.texture.baseTexture.addEventListener("loaded",function(){u.onLoaded()})}},e.BitmapFontLoader=function(t,i){e.EventTarget.call(this),this.url=t,this.crossorigin=i,this.baseUrl=t.replace(/[^\/]*$/,""),this.texture=null},e.BitmapFontLoader.prototype.constructor=e.BitmapFontLoader,e.BitmapFontLoader.prototype.load=function(){this.ajaxRequest=new e.AjaxRequest;var t=this;this.ajaxRequest.onreadystatechange=function(){t.onXMLLoaded()},this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/xml"),this.ajaxRequest.send(null)},e.BitmapFontLoader.prototype.onXMLLoaded=function(){if(4===this.ajaxRequest.readyState&&(200===this.ajaxRequest.status||-1===window.location.protocol.indexOf("http"))){var t=this.ajaxRequest.responseXML;if(!t||/MSIE 9/i.test(navigator.userAgent)||navigator.isCocoonJS)if("function"==typeof window.DOMParser){var i=new DOMParser;t=i.parseFromString(this.ajaxRequest.responseText,"text/xml")}else{var n=document.createElement("div");n.innerHTML=this.ajaxRequest.responseText,t=n}var o=this.baseUrl+t.getElementsByTagName("page")[0].getAttribute("file"),r=new e.ImageLoader(o,this.crossorigin);this.texture=r.texture.baseTexture;var s={},a=t.getElementsByTagName("info")[0],h=t.getElementsByTagName("common")[0];s.font=a.getAttribute("face"),s.size=parseInt(a.getAttribute("size"),10),s.lineHeight=parseInt(h.getAttribute("lineHeight"),10),s.chars={};for(var l=t.getElementsByTagName("char"),u=0;u<l.length;u++){var c=parseInt(l[u].getAttribute("id"),10),p=new e.Rectangle(parseInt(l[u].getAttribute("x"),10),parseInt(l[u].getAttribute("y"),10),parseInt(l[u].getAttribute("width"),10),parseInt(l[u].getAttribute("height"),10));s.chars[c]={xOffset:parseInt(l[u].getAttribute("xoffset"),10),yOffset:parseInt(l[u].getAttribute("yoffset"),10),xAdvance:parseInt(l[u].getAttribute("xadvance"),10),kerning:{},texture:e.TextureCache[c]=new e.Texture(this.texture,p)}}var d=t.getElementsByTagName("kerning");for(u=0;u<d.length;u++){var f=parseInt(d[u].getAttribute("first"),10),g=parseInt(d[u].getAttribute("second"),10),m=parseInt(d[u].getAttribute("amount"),10);s.chars[g].kerning[f]=m}e.BitmapText.fonts[s.font]=s;var y=this;r.addEventListener("loaded",function(){y.onLoaded()}),r.load()}},e.BitmapFontLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})},e.SpineLoader=function(t,i){e.EventTarget.call(this),this.url=t,this.crossorigin=i,this.loaded=!1},e.SpineLoader.prototype.constructor=e.SpineLoader,e.SpineLoader.prototype.load=function(){var t=this,i=new e.JsonLoader(this.url,this.crossorigin);i.addEventListener("loaded",function(e){t.json=e.content.json,t.onLoaded()}),i.load()},e.SpineLoader.prototype.onLoaded=function(){this.loaded=!0,this.dispatchEvent({type:"loaded",content:this})},e.AbstractFilter=function(t,e){this.passes=[this],this.shaders=[],this.dirty=!0,this.padding=0,this.uniforms=e||{},this.fragmentSrc=t||[]},e.AlphaMaskFilter=function(t){e.AbstractFilter.call(this),this.passes=[this],t.baseTexture._powerOf2=!0,this.uniforms={mask:{type:"sampler2D",value:t},mapDimensions:{type:"2f",value:{x:1,y:5112}},dimensions:{type:"4fv",value:[0,0,0,0]}},t.baseTexture.hasLoaded?(this.uniforms.mask.value.x=t.width,this.uniforms.mask.value.y=t.height):(this.boundLoadedFunction=this.onTextureLoaded.bind(this),t.baseTexture.on("loaded",this.boundLoadedFunction)),this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D mask;","uniform sampler2D uSampler;","uniform vec2 offset;","uniform vec4 dimensions;","uniform vec2 mapDimensions;","void main(void) {","   vec2 mapCords = vTextureCoord.xy;","   mapCords += (dimensions.zw + offset)/ dimensions.xy ;","   mapCords.y *= -1.0;","   mapCords.y += 1.0;","   mapCords *= dimensions.xy / mapDimensions;","   vec4 original =  texture2D(uSampler, vTextureCoord);","   float maskAlpha =  texture2D(mask, mapCords).r;","   original *= maskAlpha;","   gl_FragColor =  original;","}"]},e.AlphaMaskFilter.prototype=Object.create(e.AbstractFilter.prototype),e.AlphaMaskFilter.prototype.constructor=e.AlphaMaskFilter,e.AlphaMaskFilter.prototype.onTextureLoaded=function(){this.uniforms.mapDimensions.value.x=this.uniforms.mask.value.width,this.uniforms.mapDimensions.value.y=this.uniforms.mask.value.height,this.uniforms.mask.value.baseTexture.off("loaded",this.boundLoadedFunction)},Object.defineProperty(e.AlphaMaskFilter.prototype,"map",{get:function(){return this.uniforms.mask.value},set:function(t){this.uniforms.mask.value=t}}),e.ColorMatrixFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={matrix:{type:"mat4",value:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float invert;","uniform mat4 matrix;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * matrix;","}"]},e.ColorMatrixFilter.prototype=Object.create(e.AbstractFilter.prototype),e.ColorMatrixFilter.prototype.constructor=e.ColorMatrixFilter,Object.defineProperty(e.ColorMatrixFilter.prototype,"matrix",{get:function(){return this.uniforms.matrix.value},set:function(t){this.uniforms.matrix.value=t}}),e.GrayFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={gray:{type:"1f",value:1}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","uniform float gray;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.2126*gl_FragColor.r + 0.7152*gl_FragColor.g + 0.0722*gl_FragColor.b), gray);","}"]},e.GrayFilter.prototype=Object.create(e.AbstractFilter.prototype),e.GrayFilter.prototype.constructor=e.GrayFilter,Object.defineProperty(e.GrayFilter.prototype,"gray",{get:function(){return this.uniforms.gray.value},set:function(t){this.uniforms.gray.value=t}}),e.DisplacementFilter=function(t){e.AbstractFilter.call(this),this.passes=[this],t.baseTexture._powerOf2=!0,this.uniforms={displacementMap:{type:"sampler2D",value:t},scale:{type:"2f",value:{x:30,y:30}},offset:{type:"2f",value:{x:0,y:0}},mapDimensions:{type:"2f",value:{x:1,y:5112}},dimensions:{type:"4fv",value:[0,0,0,0]}},t.baseTexture.hasLoaded?(this.uniforms.mapDimensions.value.x=t.width,this.uniforms.mapDimensions.value.y=t.height):(this.boundLoadedFunction=this.onTextureLoaded.bind(this),t.baseTexture.on("loaded",this.boundLoadedFunction)),this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D displacementMap;","uniform sampler2D uSampler;","uniform vec2 scale;","uniform vec2 offset;","uniform vec4 dimensions;","uniform vec2 mapDimensions;","void main(void) {","   vec2 mapCords = vTextureCoord.xy;","   mapCords += (dimensions.zw + offset)/ dimensions.xy ;","   mapCords.y *= -1.0;","   mapCords.y += 1.0;","   vec2 matSample = texture2D(displacementMap, mapCords).xy;","   matSample -= 0.5;","   matSample *= scale;","   matSample /= mapDimensions;","   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x + matSample.x, vTextureCoord.y + matSample.y));","   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb, 1.0);","   vec2 cord = vTextureCoord;","}"]},e.DisplacementFilter.prototype=Object.create(e.AbstractFilter.prototype),e.DisplacementFilter.prototype.constructor=e.DisplacementFilter,e.DisplacementFilter.prototype.onTextureLoaded=function(){this.uniforms.mapDimensions.value.x=this.uniforms.displacementMap.value.width,this.uniforms.mapDimensions.value.y=this.uniforms.displacementMap.value.height,this.uniforms.displacementMap.value.baseTexture.off("loaded",this.boundLoadedFunction)},Object.defineProperty(e.DisplacementFilter.prototype,"map",{get:function(){return this.uniforms.displacementMap.value},set:function(t){this.uniforms.displacementMap.value=t}}),Object.defineProperty(e.DisplacementFilter.prototype,"scale",{get:function(){return this.uniforms.scale.value},set:function(t){this.uniforms.scale.value=t}}),Object.defineProperty(e.DisplacementFilter.prototype,"offset",{get:function(){return this.uniforms.offset.value},set:function(t){this.uniforms.offset.value=t}}),e.PixelateFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={invert:{type:"1f",value:0},dimensions:{type:"4fv",value:new Float32Array([1e4,100,10,10])},pixelSize:{type:"2f",value:{x:10,y:10}}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec2 testDim;","uniform vec4 dimensions;","uniform vec2 pixelSize;","uniform sampler2D uSampler;","void main(void) {","   vec2 coord = vTextureCoord;","   vec2 size = dimensions.xy/pixelSize;","   vec2 color = floor( ( vTextureCoord * size ) ) / size + pixelSize/dimensions.xy * 0.5;","   gl_FragColor = texture2D(uSampler, color);","}"]},e.PixelateFilter.prototype=Object.create(e.AbstractFilter.prototype),e.PixelateFilter.prototype.constructor=e.PixelateFilter,Object.defineProperty(e.PixelateFilter.prototype,"size",{get:function(){return this.uniforms.pixelSize.value},set:function(t){this.dirty=!0,this.uniforms.pixelSize.value=t}}),e.BlurXFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={blur:{type:"1f",value:1/512}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","   vec4 sum = vec4(0.0);","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 4.0*blur, vTextureCoord.y)) * 0.05;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 3.0*blur, vTextureCoord.y)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 2.0*blur, vTextureCoord.y)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - blur, vTextureCoord.y)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * 0.16;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + blur, vTextureCoord.y)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 2.0*blur, vTextureCoord.y)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 3.0*blur, vTextureCoord.y)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 4.0*blur, vTextureCoord.y)) * 0.05;","   gl_FragColor = sum;","}"]},e.BlurXFilter.prototype=Object.create(e.AbstractFilter.prototype),e.BlurXFilter.prototype.constructor=e.BlurXFilter,Object.defineProperty(e.BlurXFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(t){this.dirty=!0,this.uniforms.blur.value=1/7e3*t}}),e.BlurYFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={blur:{type:"1f",value:1/512}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","   vec4 sum = vec4(0.0);","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 4.0*blur)) * 0.05;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 3.0*blur)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 2.0*blur)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - blur)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * 0.16;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + blur)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 2.0*blur)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 3.0*blur)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 4.0*blur)) * 0.05;","   gl_FragColor = sum;","}"]},e.BlurYFilter.prototype=Object.create(e.AbstractFilter.prototype),e.BlurYFilter.prototype.constructor=e.BlurYFilter,Object.defineProperty(e.BlurYFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(t){this.uniforms.blur.value=1/7e3*t}}),e.BlurFilter=function(){this.blurXFilter=new e.BlurXFilter,this.blurYFilter=new e.BlurYFilter,this.passes=[this.blurXFilter,this.blurYFilter]},Object.defineProperty(e.BlurFilter.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=this.blurYFilter.blur=t}}),Object.defineProperty(e.BlurFilter.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t}}),Object.defineProperty(e.BlurFilter.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(t){this.blurYFilter.blur=t}}),e.InvertFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={invert:{type:"1f",value:1}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float invert;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix( (vec3(1)-gl_FragColor.rgb) * gl_FragColor.a, gl_FragColor.rgb, 1.0 - invert);","}"]},e.InvertFilter.prototype=Object.create(e.AbstractFilter.prototype),e.InvertFilter.prototype.constructor=e.InvertFilter,Object.defineProperty(e.InvertFilter.prototype,"invert",{get:function(){return this.uniforms.invert.value},set:function(t){this.uniforms.invert.value=t}}),e.SepiaFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={sepia:{type:"1f",value:1}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float sepia;","uniform sampler2D uSampler;","const mat3 sepiaMatrix = mat3(0.3588, 0.7044, 0.1368, 0.2990, 0.5870, 0.1140, 0.2392, 0.4696, 0.0912);","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb * sepiaMatrix, sepia);","}"]},e.SepiaFilter.prototype=Object.create(e.AbstractFilter.prototype),e.SepiaFilter.prototype.constructor=e.SepiaFilter,Object.defineProperty(e.SepiaFilter.prototype,"sepia",{get:function(){return this.uniforms.sepia.value},set:function(t){this.uniforms.sepia.value=t}}),e.TwistFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={radius:{type:"1f",value:.5},angle:{type:"1f",value:5},offset:{type:"2f",value:{x:.5,y:.5}}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec4 dimensions;","uniform sampler2D uSampler;","uniform float radius;","uniform float angle;","uniform vec2 offset;","void main(void) {","   vec2 coord = vTextureCoord - offset;","   float distance = length(coord);","   if (distance < radius) {","       float ratio = (radius - distance) / radius;","       float angleMod = ratio * ratio * angle;","       float s = sin(angleMod);","       float c = cos(angleMod);","       coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);","   }","   gl_FragColor = texture2D(uSampler, coord+offset);","}"]},e.TwistFilter.prototype=Object.create(e.AbstractFilter.prototype),e.TwistFilter.prototype.constructor=e.TwistFilter,Object.defineProperty(e.TwistFilter.prototype,"offset",{get:function(){return this.uniforms.offset.value},set:function(t){this.dirty=!0,this.uniforms.offset.value=t}}),Object.defineProperty(e.TwistFilter.prototype,"radius",{get:function(){return this.uniforms.radius.value},set:function(t){this.dirty=!0,this.uniforms.radius.value=t}}),Object.defineProperty(e.TwistFilter.prototype,"angle",{get:function(){return this.uniforms.angle.value},set:function(t){this.dirty=!0,this.uniforms.angle.value=t}}),e.ColorStepFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={step:{type:"1f",value:5}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","uniform float step;","void main(void) {","   vec4 color = texture2D(uSampler, vTextureCoord);","   color = floor(color * step) / step;","   gl_FragColor = color;","}"]},e.ColorStepFilter.prototype=Object.create(e.AbstractFilter.prototype),e.ColorStepFilter.prototype.constructor=e.ColorStepFilter,Object.defineProperty(e.ColorStepFilter.prototype,"step",{get:function(){return this.uniforms.step.value},set:function(t){this.uniforms.step.value=t}}),e.DotScreenFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={scale:{type:"1f",value:1},angle:{type:"1f",value:5},dimensions:{type:"4fv",value:[0,0,0,0]}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec4 dimensions;","uniform sampler2D uSampler;","uniform float angle;","uniform float scale;","float pattern() {","   float s = sin(angle), c = cos(angle);","   vec2 tex = vTextureCoord * dimensions.xy;","   vec2 point = vec2(","       c * tex.x - s * tex.y,","       s * tex.x + c * tex.y","   ) * scale;","   return (sin(point.x) * sin(point.y)) * 4.0;","}","void main() {","   vec4 color = texture2D(uSampler, vTextureCoord);","   float average = (color.r + color.g + color.b) / 3.0;","   gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern()), color.a);","}"]},e.DotScreenFilter.prototype=Object.create(e.AbstractFilter.prototype),e.DotScreenFilter.prototype.constructor=e.DotScreenFilter,Object.defineProperty(e.DotScreenFilter.prototype,"scale",{get:function(){return this.uniforms.scale.value},set:function(t){this.dirty=!0,this.uniforms.scale.value=t}}),Object.defineProperty(e.DotScreenFilter.prototype,"angle",{get:function(){return this.uniforms.angle.value},set:function(t){this.dirty=!0,this.uniforms.angle.value=t}}),e.CrossHatchFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={blur:{type:"1f",value:1/512}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","    float lum = length(texture2D(uSampler, vTextureCoord.xy).rgb);","    gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);","    if (lum < 1.00) {","        if (mod(gl_FragCoord.x + gl_FragCoord.y, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.75) {","        if (mod(gl_FragCoord.x - gl_FragCoord.y, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.50) {","        if (mod(gl_FragCoord.x + gl_FragCoord.y - 5.0, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.3) {","        if (mod(gl_FragCoord.x - gl_FragCoord.y - 5.0, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","}"]
},e.CrossHatchFilter.prototype=Object.create(e.AbstractFilter.prototype),e.CrossHatchFilter.prototype.constructor=e.BlurYFilter,Object.defineProperty(e.CrossHatchFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(t){this.uniforms.blur.value=1/7e3*t}}),e.RGBSplitFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={red:{type:"2f",value:{x:20,y:20}},green:{type:"2f",value:{x:-20,y:20}},blue:{type:"2f",value:{x:20,y:-20}},dimensions:{type:"4fv",value:[0,0,0,0]}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec2 red;","uniform vec2 green;","uniform vec2 blue;","uniform vec4 dimensions;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor.r = texture2D(uSampler, vTextureCoord + red/dimensions.xy).r;","   gl_FragColor.g = texture2D(uSampler, vTextureCoord + green/dimensions.xy).g;","   gl_FragColor.b = texture2D(uSampler, vTextureCoord + blue/dimensions.xy).b;","   gl_FragColor.a = texture2D(uSampler, vTextureCoord).a;","}"]},e.RGBSplitFilter.prototype=Object.create(e.AbstractFilter.prototype),e.RGBSplitFilter.prototype.constructor=e.RGBSplitFilter,Object.defineProperty(e.RGBSplitFilter.prototype,"angle",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(t){this.uniforms.blur.value=1/7e3*t}}),"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=e),exports.PIXI=e):"undefined"!=typeof define&&define.amd?define("pixi",e):t.PIXI=e}.call(this),define("absolute/platform",["pixi","absolute/debug"],function(t,e){var i={artPathPrefix:"art",soundPathPrefix:"sound",maxWidth:window.innerWidth,maxHeight:window.innerHeight,devicePixelRatio:window.devicePixelRatio||1,documentRoot:null,getDocumentRoot:function(){if(null===this.documentRoot)if(this.isCordova()){var t=window.location.href.indexOf("/index.html");this.documentRoot=window.location.href.substring(0,t)+"/"}else this.documentRoot="";return this.documentRoot},getClickAction:function(){return this.supportsTouch()?"touchstart":"click"},isCrapAudio:function(){return navigator.userAgent.indexOf("Android")>=0?!0:navigator.userAgent.indexOf("Silk")>=0?!0:navigator.userAgent.match(/OS 5(_\d)+ like Mac OS X/i)?!0:navigator.userAgent.match(/OS 4(_\d)+ like Mac OS X/i)?!0:!1},_isiPhone:navigator.userAgent.match(/iPhone/i),_isiPod:navigator.userAgent.match(/iPod/i),_isiPad:navigator.userAgent.match(/iPad/i),_isAndroid:function(){return"android"===this.getMobileUserAgentData().os.toLowerCase()},_isChrome:function(){return navigator.userAgent.indexOf("Android")>=0&&navigator.userAgent.indexOf("CrMo")>=0},_isIE:function(){return navigator.userAgent.indexOf("Trident")>=0||navigator.userAgent.indexOf("MSIE")>=0},supportsWebGL:function(){return!this._isIE()},supportsTouch:function(){try{return"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch}catch(t){return!1}},isCordova:function(){return"undefined"!=typeof cordova},isPhone:function(){var t=navigator.userAgent,e=/iPhone|BlackBerry|IEMobile|Opera Mini/i,i=t.match(e);return"undefined"!=typeof i&&null!==i?i.length>0:!1},supportsLayeredDivs:function(){var t=this.getMobileUserAgentData();return!("Android"===t.os&&!/^[3-9](\.[0-9])*$/.test(t.osVersion))},supportsFixedPosition:function(){var t=this.getMobileUserAgentData();return"Android"===t.os&&/^[3-9](\.[0-9])*$/.test(t.osVersion)||"iPhone"===t.os&&/^[5-9]/.test(t.osVersion)||"iPhone"!==t.os&&"Android"!==t.os},supportsDeviceOrientation:function(){return"undefined"!=typeof window.DeviceOrientationEvent},getMobileUserAgentData:function(){for(var t=navigator.userAgent,e={os:"",osVersion:"",browser:"",browserVersion:""},i=[{os:"iPhone",osVersionRegex:/(?:iPhone OS )([0-9,_]*)(?: like)/,browser:"WebKit",browserVersionRegex:/(?:AppleWebKit\/)([0-9,.]*)/},{os:"Android",osVersionRegex:/(?:Android )([0-9,.]*)/,browser:"WebKit",browserVersionRegex:/(?:AppleWebKit\/)([0-9,.]*)/},{os:"Linux",osVersionRegex:/(?:Android )([0-9,.]*)/,browser:"Silk",browserVersionRegex:/(?:Silk\/)([0-9._-]+)/}],n=0,o=i.length;o>n;n++){var r=i[n];if(-1!==t.indexOf(r.os)){e.os=r.os,"undefined"!=typeof r.osVersionRegex&&(e.osVersion=t.match(r.osVersionRegex)||"0.0",e.osVersion=e.osVersion[1].replace("_",".")),-1!==t.indexOf(r.browser)&&(e.browser=r.browser,"undefined"!=typeof r.browserVersionRegex&&(e.browserVersion=t.match(r.browserVersionRegex)[1].replace("_",".")));break}}return e},_isOldAndroid:function(){var t=4,e=2,i=this.getMobileUserAgentData(),n=i.osVersion.split("."),o=0,r=0,s=!1;return("android"===i.os.toLowerCase()||"linux"===i.os.toLowerCase())&&n.length>1&&(o=n[0],r=n[1],(t>o||o==t&&e>=r)&&(s=!0)),s},getResStepsDown:function(i,n){var o=0;return t.canUseNewCanvasBlendModes()?n&&this.isPhone()?(e.log("Lowering resClass because this is a phone."),o++):n&&this._isiPad&&i>=3&&(e.log("Lowering resClass because this is an ipad that can't handle big textures."),o++):(e.log("Lowering resClass because this device does not support canvas blends."),o++),this._isOldAndroid()&&(e.log("Lowering resClass because this is an older android device."),o++),this._isOldAndroid()&&i>=3&&(e.log("Lowering resClass because this is an older android device and it is enormous."),o++),n&&0==o&&(o=1),o}};return i}),define("absolute/audiomanager",["absoluteaudio","absolute/debug","absolute/gameconfig","absolute/platform"],function(t,e,i,n){var o={lastPlayed:0,music:null,sounds:{},format:"mp3",sfxEnabled:!0,init:function(t){audioTest=new Audio;var i={m4a:!!(audioTest.canPlayType("audio/x-m4a;")||audioTest.canPlayType("audio/aac;")).replace(/^no$/,""),ogg:!!audioTest.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),mp3:!!audioTest.canPlayType("audio/mpeg;").replace(/^no$/,"")};i.m4a?this.format="m4a":i.ogg?this.format="ogg":i.mp3&&(this.format="mp3"),navigator.userAgent.match(/MSIE/i)&&(this.format="mp3"),e.log("Audio format "+this.format),t&&"function"==typeof t&&t()},setFormat:function(t){this.format=t},loadSounds:function(e,n,o){return e?(this.audioAssets=e,void(this.usingWebAudio()?this.loadClips(e,n,o):this.createSound({id:"as",url:"as/as",volume:100,onLoad:function(){for(var e=0,r=this.audioAssets.length;r>e;e+=1){var s=this.audioAssets[e],a=this.sounds.as;this.sounds[s.id]=t.context.createAudioSprite(a,s.start,s.end),n(e/r)}n(e/r),this.setSfxEnabled(i.getVal("sfxEnabled")),setTimeout(function(){o()},500)}.bind(this),buffer:!1,loop:!1,duration:0}))):void o()},loadClips:function(t,e,n){for(var o=this,r=t.length,s=0,a=function(){++s===r?(o.setSfxEnabled(i.getVal("sfxEnabled")),e(s/r),n()):e(s/r)},h=0;h<t.length;h+=1){var l=t[h];this.createSound({id:l.id,url:l.url,volume:l.volume,onLoad:a,buffer:!1,loop:l.loop,duration:l.end-l.start})}},createSound:function(e){var i,o;o=n.getDocumentRoot()+n.soundPathPrefix+"/"+this.format+"/"+e.url+"."+this.format,i=t.context.createAudioClip(o,e.onLoad,!1,e.duration),this.sounds[e.id]=i},playSound:function(t,e,i){this.sounds[t]&&this.sounds[t].play(i/1e3,this.isMusic(t),e)},loopSound:function(t,e,i){this.sounds[t]&&this.sounds[t].play(i/1e3,!0,e)},stopSound:function(t){this.sounds[t]&&(this.sounds[t].stopping=!0,this.sounds[t].stop())},pauseSound:function(t){this.sounds[t]&&this.sounds[t].pause()},muteSound:function(t){this.sounds[t]&&this.sounds[t].mute()},unmuteSound:function(t){this.sounds[t]&&this.sounds[t].unmute()},setSfxEnabled:function(t){this.sfxEnabled=t,i.setVal("sfxEnabled",t);var e;if(t)for(e in this.sounds)this.isMusic(e)||"as"===e||this.unmuteSound(e);else for(e in this.sounds)this.isMusic(e)||"as"===e||this.muteSound(e)},isSfxEnabled:function(){return this.sfxEnabled},muteAll:function(){for(s in this.sounds)this.muteSound(s)},unmuteAll:function(){for(s in this.sounds)this.unmuteSound(s)},usingWebAudio:function(){return t.context.usingWebAudio()||t.context.usingCordovaAudio()},isMusic:function(t){return-1!==t.indexOf("music")},sfxSupported:function(){return!0},musicSupported:function(){return!0},simulSoundSupport:function(){return t.context.usingWebAudio()||t.context.usingCordovaAudio()||!i.getVal("musicEnabled")},primeClips:function(){var t;for(t in this.sounds)this.sounds[t].prime()}};return o}),define("lodash/arrays/compact",[],function(){function t(t){for(var e=-1,i=t?t.length:0,n=[];++e<i;){var o=t[e];o&&n.push(o)}return n}return t}),define("lodash/internals/baseIndexOf",[],function(){function t(t,e,i){for(var n=(i||0)-1,o=t?t.length:0;++n<o;)if(t[n]===e)return n;return-1}return t}),define("lodash/internals/keyPrefix",[],function(){var t=+new Date+"";return t}),define("lodash/internals/cacheIndexOf",["./baseIndexOf","./keyPrefix"],function(t,e){function i(i,n){var o=typeof n;if(i=i.cache,"boolean"==o||null==n)return i[n]?0:-1;"number"!=o&&"string"!=o&&(o="object");var r="number"==o?n:e+n;return i=(i=i[o])&&i[r],"object"==o?i&&t(i,n)>-1?0:-1:i?0:-1}return i}),define("lodash/internals/cachePush",["./keyPrefix"],function(t){function e(e){var i=this.cache,n=typeof e;if("boolean"==n||null==e)i[e]=!0;else{"number"!=n&&"string"!=n&&(n="object");var o="number"==n?e:t+e,r=i[n]||(i[n]={});"object"==n?(r[o]||(r[o]=[])).push(e):r[o]=!0}}return e}),define("lodash/internals/objectPool",[],function(){var t=[];return t}),define("lodash/internals/getObject",["./objectPool"],function(t){function e(){return t.pop()||{array:null,cache:null,criteria:null,"false":!1,index:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,undefined:!1,value:null}}return e}),define("lodash/internals/maxPoolSize",[],function(){var t=40;return t}),define("lodash/internals/releaseObject",["./maxPoolSize","./objectPool"],function(t,e){function i(n){var o=n.cache;o&&i(o),n.array=n.cache=n.criteria=n.object=n.number=n.string=n.value=null,e.length<t&&e.push(n)}return i}),define("lodash/internals/createCache",["./cachePush","./getObject","./releaseObject"],function(t,e){function i(i){var n=-1,o=i.length,r=i[0],s=i[o/2|0],a=i[o-1];if(r&&"object"==typeof r&&s&&"object"==typeof s&&a&&"object"==typeof a)return!1;var h=e();h["false"]=h["null"]=h["true"]=h.undefined=!1;var l=e();for(l.array=i,l.cache=h,l.push=t;++n<o;)l.push(i[n]);return l}return i}),define("lodash/internals/largeArraySize",[],function(){var t=75;return t}),define("lodash/internals/baseDifference",["./baseIndexOf","./cacheIndexOf","./createCache","./largeArraySize","./releaseObject"],function(t,e,i,n,o){function r(r,s){var a=-1,h=t,l=r?r.length:0,u=l>=n,c=[];if(u){var p=i(s);p?(h=e,s=p):u=!1}for(;++a<l;){var d=r[a];h(s,d)<0&&c.push(d)}return u&&o(s),c}return r}),define("lodash/objects/isArguments",[],function(){function t(t){return t&&"object"==typeof t&&"number"==typeof t.length&&n.call(t)==e||!1}var e="[object Arguments]",i=Object.prototype,n=i.toString;return t}),define("lodash/internals/isNative",[],function(){function t(t){return"function"==typeof t&&n.test(t)}var e=Object.prototype,i=e.toString,n=RegExp("^"+String(i).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$");return t}),define("lodash/objects/isArray",["../internals/isNative"],function(t){var e="[object Array]",i=Object.prototype,n=i.toString,o=t(o=Array.isArray)&&o,r=o||function(t){return t&&"object"==typeof t&&"number"==typeof t.length&&n.call(t)==e||!1};return r}),define("lodash/internals/baseFlatten",["../objects/isArguments","../objects/isArray"],function(t,e){function i(n,o,r,s){for(var a=(s||0)-1,h=n?n.length:0,l=[];++a<h;){var u=n[a];if(u&&"object"==typeof u&&"number"==typeof u.length&&(e(u)||t(u))){o||(u=i(u,o,r));var c=-1,p=u.length,d=l.length;for(l.length+=p;++c<p;)l[d++]=u[c]}else r||l.push(u)}return l}return i}),define("lodash/arrays/difference",["../internals/baseDifference","../internals/baseFlatten"],function(t,e){function i(i){return t(i,e(arguments,!0,!0,1))}return i}),define("lodash/internals/objectTypes",[],function(){var t={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1};return t}),define("lodash/objects/isObject",["../internals/objectTypes"],function(t){function e(e){return!(!e||!t[typeof e])}return e}),define("lodash/utilities/noop",[],function(){function t(){}return t}),define("lodash/internals/baseCreate",["./isNative","../objects/isObject","../utilities/noop"],function(t,e){function i(t){return e(t)?n(t):{}}var n=t(n=Object.create)&&n;return n||(i=function(){function t(){}return function(i){if(e(i)){t.prototype=i;var n=new t;t.prototype=null}return n||window.Object()}}()),i}),define("lodash/internals/setBindData",["./isNative","../utilities/noop"],function(t,e){var i={configurable:!1,enumerable:!1,value:null,writable:!1},n=function(){try{var e={},i=t(i=Object.defineProperty)&&i,n=i(e,e,e)&&i}catch(o){}return n}(),o=n?function(t,e){i.value=e,n(t,"__bindData__",i)}:e;return o}),define("lodash/internals/slice",[],function(){function t(t,e,i){e||(e=0),"undefined"==typeof i&&(i=t?t.length:0);for(var n=-1,o=i-e||0,r=Array(0>o?0:o);++n<o;)r[n]=t[e+n];return r}return t}),define("lodash/internals/baseBind",["./baseCreate","../objects/isObject","./setBindData","./slice"],function(t,e,i,n){function o(o){function r(){if(h){var i=n(h);s.apply(i,arguments)}if(this instanceof r){var o=t(a.prototype),u=a.apply(o,i||arguments);return e(u)?u:o}return a.apply(l,i||arguments)}var a=o[0],h=o[2],l=o[4];return i(r,o),r}var r=[],s=r.push;return o}),define("lodash/internals/baseCreateWrapper",["./baseCreate","../objects/isObject","./setBindData","./slice"],function(t,e,i,n){function o(r){function a(){var i=f?p:this;if(u){var r=n(u);s.apply(r,arguments)}if((c||m)&&(r||(r=n(arguments)),c&&s.apply(r,c),m&&r.length<d))return l|=16,o([h,y?l:-4&l,r,null,p,d]);if(r||(r=arguments),g&&(h=i[v]),this instanceof a){i=t(h.prototype);var b=h.apply(i,r);return e(b)?b:i}return h.apply(i,r)}var h=r[0],l=r[1],u=r[2],c=r[3],p=r[4],d=r[5],f=1&l,g=2&l,m=4&l,y=8&l,v=h;return i(a,r),a}var r=[],s=r.push;return o}),define("lodash/objects/isFunction",[],function(){function t(t){return"function"==typeof t}return t}),define("lodash/internals/createWrapper",["./baseBind","./baseCreateWrapper","../objects/isFunction","./slice"],function(t,e,i,n){function o(r,h,l,u,c,p){var d=1&h,f=2&h,g=4&h,m=16&h,y=32&h;if(!f&&!i(r))throw new TypeError;m&&!l.length&&(h&=-17,m=l=!1),y&&!u.length&&(h&=-33,y=u=!1);var v=r&&r.__bindData__;if(v&&v!==!0)return v=n(v),v[2]&&(v[2]=n(v[2])),v[3]&&(v[3]=n(v[3])),!d||1&v[1]||(v[4]=c),!d&&1&v[1]&&(h|=8),!g||4&v[1]||(v[5]=p),m&&s.apply(v[2]||(v[2]=[]),l),y&&a.apply(v[3]||(v[3]=[]),u),v[1]|=h,o.apply(null,v);var b=1==h||17===h?t:e;return b([r,h,l,u,c,p])}var r=[],s=r.push,a=r.unshift;return o}),define("lodash/functions/bind",["../internals/createWrapper","../internals/slice"],function(t,e){function i(i,n){return arguments.length>2?t(i,17,e(arguments,2),null,n):t(i,1,null,null,n)}return i}),define("lodash/utilities/identity",[],function(){function t(t){return t}return t}),define("lodash/support",["./internals/isNative"],function(t){var e=/\bthis\b/,i={};return i.funcDecomp=!t(window.WinRTError)&&e.test(function(){return this}),i.funcNames="string"==typeof Function.name,i}),define("lodash/internals/baseCreateCallback",["../functions/bind","../utilities/identity","./setBindData","../support"],function(t,e,i,n){function o(o,h,l){if("function"!=typeof o)return e;if("undefined"==typeof h||!("prototype"in o))return o;var u=o.__bindData__;if("undefined"==typeof u&&(n.funcNames&&(u=!o.name),u=u||!n.funcDecomp,!u)){var c=a.call(o);n.funcNames||(u=!r.test(c)),u||(u=s.test(c),i(o,u))}if(u===!1||u!==!0&&1&u[1])return o;switch(l){case 1:return function(t){return o.call(h,t)};case 2:return function(t,e){return o.call(h,t,e)};case 3:return function(t,e,i){return o.call(h,t,e,i)};case 4:return function(t,e,i,n){return o.call(h,t,e,i,n)}}return t(o,h)}var r=/^\s*function[ \n\r\t]+\w/,s=/\bthis\b/,a=Function.prototype.toString;return o}),define("lodash/objects/forIn",["../internals/baseCreateCallback","../internals/objectTypes"],function(t,e){var i=function(i,n,o){var r,s=i,a=s;if(!s)return a;if(!e[typeof s])return a;n=n&&"undefined"==typeof o?n:t(n,o,3);for(r in s)if(n(s[r],r,i)===!1)return a;return a};return i}),define("lodash/internals/arrayPool",[],function(){var t=[];return t}),define("lodash/internals/getArray",["./arrayPool"],function(t){function e(){return t.pop()||[]}return e}),define("lodash/internals/releaseArray",["./arrayPool","./maxPoolSize"],function(t,e){function i(i){i.length=0,t.length<e&&t.push(i)}return i}),define("lodash/internals/baseIsEqual",["../objects/forIn","./getArray","../objects/isFunction","./objectTypes","./releaseArray"],function(t,e,i,n,o){function r(f,y,v,b,x,w){if(v){var S=v(f,y);if("undefined"!=typeof S)return!!S}if(f===y)return 0!==f||1/f==1/y;var C=typeof f,T=typeof y;if(!(f!==f||f&&n[C]||y&&n[T]))return!1;if(null==f||null==y)return f===y;var _=g.call(f),M=g.call(y);if(_==s&&(_=c),M==s&&(M=c),_!=M)return!1;switch(_){case h:case l:return+f==+y;case u:return f!=+f?y!=+y:0==f?1/f==1/y:f==+y;case p:case d:return f==String(y)}var E=_==a;if(!E){var A=m.call(f,"__wrapped__"),B=m.call(y,"__wrapped__");if(A||B)return r(A?f.__wrapped__:f,B?y.__wrapped__:y,v,b,x,w);if(_!=c)return!1;var k=f.constructor,O=y.constructor;if(k!=O&&!(i(k)&&k instanceof k&&i(O)&&O instanceof O)&&"constructor"in f&&"constructor"in y)return!1}var P=!x;x||(x=e()),w||(w=e());for(var R=x.length;R--;)if(x[R]==f)return w[R]==y;var L=0;if(S=!0,x.push(f),w.push(y),E){if(R=f.length,L=y.length,S=L==R,S||b)for(;L--;){var F=R,D=y[L];if(b)for(;F--&&!(S=r(f[F],D,v,b,x,w)););else if(!(S=r(f[L],D,v,b,x,w)))break}}else t(y,function(t,e,i){return m.call(i,e)?(L++,S=m.call(f,e)&&r(f[e],t,v,b,x,w)):void 0}),S&&!b&&t(f,function(t,e,i){return m.call(i,e)?S=--L>-1:void 0});return x.pop(),w.pop(),P&&(o(x),o(w)),S}var s="[object Arguments]",a="[object Array]",h="[object Boolean]",l="[object Date]",u="[object Number]",c="[object Object]",p="[object RegExp]",d="[object String]",f=Object.prototype,g=f.toString,m=f.hasOwnProperty;return r}),define("lodash/internals/shimKeys",["./objectTypes"],function(t){var e=Object.prototype,i=e.hasOwnProperty,n=function(e){var n,o=e,r=[];if(!o)return r;if(!t[typeof e])return r;for(n in o)i.call(o,n)&&r.push(n);return r};return n}),define("lodash/objects/keys",["../internals/isNative","./isObject","../internals/shimKeys"],function(t,e,i){var n=t(n=Object.keys)&&n,o=n?function(t){return e(t)?n(t):[]}:i;return o}),define("lodash/utilities/property",[],function(){function t(t){return function(e){return e[t]}}return t}),define("lodash/functions/createCallback",["../internals/baseCreateCallback","../internals/baseIsEqual","../objects/isObject","../objects/keys","../utilities/property"],function(t,e,i,n,o){function r(r,s,a){var h=typeof r;if(null==r||"function"==h)return t(r,s,a);if("object"!=h)return o(r);var l=n(r),u=l[0],c=r[u];return 1!=l.length||c!==c||i(c)?function(t){for(var i=l.length,n=!1;i--&&(n=e(t[l[i]],r[l[i]],null,!0)););return n}:function(t){var e=t[u];return c===e&&(0!==c||1/c==1/e)}}return r}),define("lodash/arrays/findIndex",["../functions/createCallback"],function(t){function e(e,i,n){var o=-1,r=e?e.length:0;for(i=t(i,n,3);++o<r;)if(i(e[o],o,e))return o;return-1}return e}),define("lodash/arrays/findLastIndex",["../functions/createCallback"],function(t){function e(e,i,n){var o=e?e.length:0;for(i=t(i,n,3);o--;)if(i(e[o],o,e))return o;return-1}return e}),define("lodash/arrays/first",["../functions/createCallback","../internals/slice"],function(t,e){function i(i,s,a){var h=0,l=i?i.length:0;if("number"!=typeof s&&null!=s){var u=-1;for(s=t(s,a,3);++u<l&&s(i[u],u,i);)h++}else if(h=s,null==h||a)return i?i[0]:n;return e(i,0,r(o(0,h),l))}var n,o=Math.max,r=Math.min;return i}),define("lodash/objects/forOwn",["../internals/baseCreateCallback","./keys","../internals/objectTypes"],function(t,e,i){var n=function(n,o,r){var s,a=n,h=a;if(!a)return h;if(!i[typeof a])return h;o=o&&"undefined"==typeof r?o:t(o,r,3);for(var l=-1,u=i[typeof a]&&e(a),c=u?u.length:0;++l<c;)if(s=u[l],o(a[s],s,n)===!1)return h;return h};return n}),define("lodash/collections/map",["../functions/createCallback","../objects/forOwn"],function(t,e){function i(i,n,o){var r=-1,s=i?i.length:0;if(n=t(n,o,3),"number"==typeof s)for(var a=Array(s);++r<s;)a[r]=n(i[r],r,i);else a=[],e(i,function(t,e,i){a[++r]=n(t,e,i)});return a}return i}),define("lodash/arrays/flatten",["../internals/baseFlatten","../collections/map"],function(t,e){function i(i,n,o,r){return"boolean"!=typeof n&&null!=n&&(r=o,o="function"!=typeof n&&r&&r[n]===i?null:n,n=!1),null!=o&&(i=e(i,o,r)),t(i,n)}return i}),define("lodash/arrays/sortedIndex",["../functions/createCallback","../utilities/identity"],function(t,e){function i(i,n,o,r){var s=0,a=i?i.length:s;for(o=o?t(o,r,1):e,n=o(n);a>s;){var h=s+a>>>1;o(i[h])<n?s=h+1:a=h}return s}return i}),define("lodash/arrays/indexOf",["../internals/baseIndexOf","./sortedIndex"],function(t,e){function i(i,o,r){if("number"==typeof r){var s=i?i.length:0;r=0>r?n(0,s+r):r||0}else if(r){var a=e(i,o);return i[a]===o?a:-1}return t(i,o,r)}var n=Math.max;return i}),define("lodash/arrays/initial",["../functions/createCallback","../internals/slice"],function(t,e){function i(i,r,s){var a=0,h=i?i.length:0;if("number"!=typeof r&&null!=r){var l=h;for(r=t(r,s,3);l--&&r(i[l],l,i);)a++}else a=null==r||s?1:r||a;return e(i,0,o(n(0,h-a),h))}var n=Math.max,o=Math.min;return i}),define("lodash/arrays/intersection",["../internals/baseIndexOf","../internals/cacheIndexOf","../internals/createCache","../internals/getArray","../objects/isArguments","../objects/isArray","../internals/largeArraySize","../internals/releaseArray","../internals/releaseObject"],function(t,e,i,n,o,r,s,a,h){function l(){for(var l=[],u=-1,c=arguments.length,p=n(),d=t,f=d===t,g=n();++u<c;){var m=arguments[u];(r(m)||o(m))&&(l.push(m),p.push(f&&m.length>=s&&i(u?l[u]:g)))}var y=l[0],v=-1,b=y?y.length:0,x=[];t:for(;++v<b;){var w=p[0];if(m=y[v],(w?e(w,m):d(g,m))<0){for(u=c,(w||g).push(m);--u;)if(w=p[u],(w?e(w,m):d(l[u],m))<0)continue t;x.push(m)}}for(;c--;)w=p[c],w&&h(w);return a(p),a(g),x}return l}),define("lodash/arrays/last",["../functions/createCallback","../internals/slice"],function(t,e){function i(i,r,s){var a=0,h=i?i.length:0;if("number"!=typeof r&&null!=r){var l=h;for(r=t(r,s,3);l--&&r(i[l],l,i);)a++}else if(a=r,null==a||s)return i?i[h-1]:n;return e(i,o(0,h-a))}var n,o=Math.max;return i}),define("lodash/arrays/lastIndexOf",[],function(){function t(t,n,o){var r=t?t.length:0;for("number"==typeof o&&(r=(0>o?e(0,r+o):i(o,r-1))+1);r--;)if(t[r]===n)return r;return-1}var e=Math.max,i=Math.min;return t}),define("lodash/arrays/pull",[],function(){function t(t){for(var e=arguments,n=0,o=e.length,r=t?t.length:0;++n<o;)for(var s=-1,a=e[n];++s<r;)t[s]===a&&(i.call(t,s--,1),r--);return t}var e=[],i=e.splice;return t}),define("lodash/arrays/range",[],function(){function t(t,n,o){t=+t||0,o="number"==typeof o?o:+o||1,null==n&&(n=t,t=0);for(var r=-1,s=i(0,e((n-t)/(o||1))),a=Array(s);++r<s;)a[r]=t,t+=o;return a}var e=Math.ceil,i=Math.max;return t}),define("lodash/arrays/remove",["../functions/createCallback"],function(t){function e(e,i,o){var r=-1,s=e?e.length:0,a=[];for(i=t(i,o,3);++r<s;){var h=e[r];i(h,r,e)&&(a.push(h),n.call(e,r--,1),s--)}return a}var i=[],n=i.splice;return e}),define("lodash/arrays/rest",["../functions/createCallback","../internals/slice"],function(t,e){function i(i,o,r){if("number"!=typeof o&&null!=o){var s=0,a=-1,h=i?i.length:0;for(o=t(o,r,3);++a<h&&o(i[a],a,i);)s++}else s=null==o||r?1:n(0,o);return e(i,s)}var n=Math.max;return i}),define("lodash/internals/baseUniq",["./baseIndexOf","./cacheIndexOf","./createCache","./getArray","./largeArraySize","./releaseArray","./releaseObject"],function(t,e,i,n,o,r,s){function a(a,h,l){var u=-1,c=t,p=a?a.length:0,d=[],f=!h&&p>=o,g=l||f?n():d;if(f){var m=i(g);c=e,g=m}for(;++u<p;){var y=a[u],v=l?l(y,u,a):y;(h?!u||g[g.length-1]!==v:c(g,v)<0)&&((l||f)&&g.push(v),d.push(y))}return f?(r(g.array),s(g)):l&&r(g),d}return a}),define("lodash/arrays/union",["../internals/baseFlatten","../internals/baseUniq"],function(t,e){function i(){return e(t(arguments,!0,!0))}return i}),define("lodash/arrays/uniq",["../internals/baseUniq","../functions/createCallback"],function(t,e){function i(i,n,o,r){return"boolean"!=typeof n&&null!=n&&(r=o,o="function"!=typeof n&&r&&r[n]===i?null:n,n=!1),null!=o&&(o=e(o,r,3)),t(i,n,o)}return i}),define("lodash/arrays/without",["../internals/baseDifference","../internals/slice"],function(t,e){function i(i){return t(i,e(arguments,1))}return i}),define("lodash/arrays/xor",["../internals/baseDifference","../internals/baseUniq","../objects/isArguments","../objects/isArray"],function(t,e,i,n){function o(){for(var o=-1,r=arguments.length;++o<r;){var s=arguments[o];if(n(s)||i(s))var a=a?e(t(a,s).concat(t(s,a))):s}return a||[]}return o}),define("lodash/internals/charAtCallback",[],function(){function t(t){return t.charCodeAt(0)}return t}),define("lodash/collections/forEach",["../internals/baseCreateCallback","../objects/forOwn"],function(t,e){function i(i,n,o){var r=-1,s=i?i.length:0;if(n=n&&"undefined"==typeof o?n:t(n,o,3),"number"==typeof s)for(;++r<s&&n(i[r],r,i)!==!1;);else e(i,n);return i}return i}),define("lodash/objects/isString",[],function(){function t(t){return"string"==typeof t||t&&"object"==typeof t&&n.call(t)==e||!1}var e="[object String]",i=Object.prototype,n=i.toString;return t}),define("lodash/collections/max",["../internals/charAtCallback","../functions/createCallback","./forEach","../objects/forOwn","../objects/isArray","../objects/isString"],function(t,e,i,n,o,r){function s(n,s,a){var h=-1/0,l=h;if("function"!=typeof s&&a&&a[s]===n&&(s=null),null==s&&o(n))for(var u=-1,c=n.length;++u<c;){var p=n[u];p>l&&(l=p)}else s=null==s&&r(n)?t:e(s,a,3),i(n,function(t,e,i){var n=s(t,e,i);n>h&&(h=n,l=t)});return l}return s}),define("lodash/collections/pluck",["./map"],function(t){var e=t;return e}),define("lodash/arrays/zip",["../collections/max","../collections/pluck"],function(t,e){function i(){for(var i=arguments.length>1?arguments:arguments[0],n=-1,o=i?t(e(i,"length")):0,r=Array(0>o?0:o);++n<o;)r[n]=e(i,n);return r}return i}),define("lodash/arrays/zipObject",["../objects/isArray"],function(t){function e(e,i){var n=-1,o=e?e.length:0,r={};for(i||!o||t(e[0])||(i=[]);++n<o;){var s=e[n];i?r[s]=i[n]:s&&(r[s[0]]=s[1])}return r}return e}),define("lodash/arrays",["./arrays/compact","./arrays/difference","./arrays/findIndex","./arrays/findLastIndex","./arrays/first","./arrays/flatten","./arrays/indexOf","./arrays/initial","./arrays/intersection","./arrays/last","./arrays/lastIndexOf","./arrays/pull","./arrays/range","./arrays/remove","./arrays/rest","./arrays/sortedIndex","./arrays/union","./arrays/uniq","./arrays/without","./arrays/xor","./arrays/zip","./arrays/zipObject"],function(t,e,i,n,o,r,s,a,h,l,u,c,p,d,f,g,m,y,v,b,x,w){return{compact:t,difference:e,drop:f,findIndex:i,findLastIndex:n,first:o,flatten:r,head:o,indexOf:s,initial:a,intersection:h,last:l,lastIndexOf:u,object:w,pull:c,range:p,remove:d,rest:f,sortedIndex:g,tail:f,take:o,union:m,uniq:y,unique:y,unzip:x,without:v,xor:b,zip:x,zipObject:w}}),define("lodash/internals/lodashWrapper",[],function(){function t(t,e){this.__chain__=!!e,this.__wrapped__=t}return t}),define("lodash/chaining/chain",["../internals/lodashWrapper"],function(t){function e(e){return e=new t(e),e.__chain__=!0,e}return e}),define("lodash/chaining/tap",[],function(){function t(t,e){return e(t),t}return t}),define("lodash/chaining/wrapperChain",[],function(){function t(){return this.__chain__=!0,this}return t}),define("lodash/chaining/wrapperToString",[],function(){function t(){return String(this.__wrapped__)}return t}),define("lodash/chaining/wrapperValueOf",["../collections/forEach","../support"],function(){function t(){return this.__wrapped__}return t}),define("lodash/chaining",["./chaining/chain","./chaining/tap","./chaining/wrapperChain","./chaining/wrapperToString","./chaining/wrapperValueOf"],function(t,e,i,n,o){return{chain:t,tap:e,value:o,wrapperChain:i,wrapperToString:n,wrapperValueOf:o}}),define("lodash/collections/at",["../internals/baseFlatten","../objects/isString"],function(t){function e(e){for(var i=arguments,n=-1,o=t(i,!0,!1,1),r=i[2]&&i[2][i[1]]===e?1:o.length,s=Array(r);++n<r;)s[n]=e[o[n]];return s}return e}),define("lodash/collections/contains",["../internals/baseIndexOf","../objects/forOwn","../objects/isArray","../objects/isString"],function(t,e,i,n){function o(o,s,a){var h=-1,l=t,u=o?o.length:0,c=!1;return a=(0>a?r(0,u+a):a)||0,i(o)?c=l(o,s,a)>-1:"number"==typeof u?c=(n(o)?o.indexOf(s,a):l(o,s,a))>-1:e(o,function(t){return++h>=a?!(c=t===s):void 0}),c}var r=Math.max;return o}),define("lodash/internals/createAggregator",["../functions/createCallback","../objects/forOwn","../objects/isArray"],function(t,e){function i(i){return function(n,o,r){var s={};o=t(o,r,3);var a=-1,h=n?n.length:0;if("number"==typeof h)for(;++a<h;){var l=n[a];i(s,l,o(l,a,n),n)}else e(n,function(t,e,n){i(s,t,o(t,e,n),n)});return s}}return i}),define("lodash/collections/countBy",["../internals/createAggregator"],function(t){var e=Object.prototype,i=e.hasOwnProperty,n=t(function(t,e,n){i.call(t,n)?t[n]++:t[n]=1});return n}),define("lodash/collections/every",["../functions/createCallback","../objects/forOwn"],function(t,e){function i(i,n,o){var r=!0;n=t(n,o,3);var s=-1,a=i?i.length:0;if("number"==typeof a)for(;++s<a&&(r=!!n(i[s],s,i)););else e(i,function(t,e,i){return r=!!n(t,e,i)});return r}return i}),define("lodash/collections/filter",["../functions/createCallback","../objects/forOwn"],function(t,e){function i(i,n,o){var r=[];n=t(n,o,3);var s=-1,a=i?i.length:0;if("number"==typeof a)for(;++s<a;){var h=i[s];n(h,s,i)&&r.push(h)}else e(i,function(t,e,i){n(t,e,i)&&r.push(t)});return r}return i}),define("lodash/collections/find",["../functions/createCallback","../objects/forOwn"],function(t,e){function i(i,n,o){n=t(n,o,3);var r=-1,s=i?i.length:0;if("number"!=typeof s){var a;return e(i,function(t,e,i){return n(t,e,i)?(a=t,!1):void 0}),a}for(;++r<s;){var h=i[r];if(n(h,r,i))return h}}return i}),define("lodash/collections/forEachRight",["../internals/baseCreateCallback","../objects/forOwn","../objects/isArray","../objects/isString","../objects/keys"],function(t,e,i,n,o){function r(i,n,r){var s=i?i.length:0;if(n=n&&"undefined"==typeof r?n:t(n,r,3),"number"==typeof s)for(;s--&&n(i[s],s,i)!==!1;);else{var a=o(i);s=a.length,e(i,function(t,e,i){return e=a?a[--s]:--s,n(i[e],e,i)})}return i}return r}),define("lodash/collections/findLast",["../functions/createCallback","./forEachRight"],function(t,e){function i(i,n,o){var r;return n=t(n,o,3),e(i,function(t,e,i){return n(t,e,i)?(r=t,!1):void 0}),r}return i}),define("lodash/collections/groupBy",["../internals/createAggregator"],function(t){var e=Object.prototype,i=e.hasOwnProperty,n=t(function(t,e,n){(i.call(t,n)?t[n]:t[n]=[]).push(e)});return n}),define("lodash/collections/indexBy",["../internals/createAggregator"],function(t){var e=t(function(t,e,i){t[i]=e});return e}),define("lodash/collections/invoke",["./forEach","../internals/slice"],function(t,e){function i(i,n){var o=e(arguments,2),r=-1,s="function"==typeof n,a=i?i.length:0,h=Array("number"==typeof a?a:0);return t(i,function(t){h[++r]=(s?n:t[n]).apply(t,o)}),h}return i}),define("lodash/collections/min",["../internals/charAtCallback","../functions/createCallback","./forEach","../objects/forOwn","../objects/isArray","../objects/isString"],function(t,e,i,n,o,r){function s(n,s,a){var h=1/0,l=h;if("function"!=typeof s&&a&&a[s]===n&&(s=null),null==s&&o(n))for(var u=-1,c=n.length;++u<c;){var p=n[u];l>p&&(l=p)}else s=null==s&&r(n)?t:e(s,a,3),i(n,function(t,e,i){var n=s(t,e,i);h>n&&(h=n,l=t)});return l}return s}),define("lodash/collections/reduce",["../functions/createCallback","../objects/forOwn"],function(t,e){function i(i,n,o,r){if(!i)return o;var s=arguments.length<3;n=t(n,r,4);var a=-1,h=i.length;if("number"==typeof h)for(s&&(o=i[++a]);++a<h;)o=n(o,i[a],a,i);else e(i,function(t,e,i){o=s?(s=!1,t):n(o,t,e,i)});return o}return i}),define("lodash/collections/reduceRight",["../functions/createCallback","./forEachRight"],function(t,e){function i(i,n,o,r){var s=arguments.length<3;
return n=t(n,r,4),e(i,function(t,e,i){o=s?(s=!1,t):n(o,t,e,i)}),o}return i}),define("lodash/collections/reject",["../functions/createCallback","./filter"],function(t,e){function i(i,n,o){return n=t(n,o,3),e(i,function(t,e,i){return!n(t,e,i)})}return i}),define("lodash/internals/baseRandom",[],function(){function t(t,n){return t+e(i()*(n-t+1))}var e=Math.floor,i=Math.random;return t}),define("lodash/collections/shuffle",["../internals/baseRandom","./forEach"],function(t,e){function i(i){var n=-1,o=i?i.length:0,r=Array("number"==typeof o?o:0);return e(i,function(e){var i=t(0,++n);r[n]=r[i],r[i]=e}),r}return i}),define("lodash/objects/values",["./keys"],function(t){function e(e){for(var i=-1,n=t(e),o=n.length,r=Array(o);++i<o;)r[i]=e[n[i]];return r}return e}),define("lodash/collections/sample",["../internals/baseRandom","../objects/isString","./shuffle","../objects/values"],function(t,e,i,n){function o(e,o,h){if(e&&"number"!=typeof e.length&&(e=n(e)),null==o||h)return e?e[t(0,e.length-1)]:r;var l=i(e);return l.length=a(s(0,o),l.length),l}var r,s=Math.max,a=Math.min;return o}),define("lodash/collections/size",["../objects/keys"],function(t){function e(e){var i=e?e.length:0;return"number"==typeof i?i:t(e).length}return e}),define("lodash/collections/some",["../functions/createCallback","../objects/forOwn","../objects/isArray"],function(t,e){function i(i,n,o){var r;n=t(n,o,3);var s=-1,a=i?i.length:0;if("number"==typeof a)for(;++s<a&&!(r=n(i[s],s,i)););else e(i,function(t,e,i){return!(r=n(t,e,i))});return!!r}return i}),define("lodash/internals/compareAscending",[],function(){function t(t,e){for(var i=t.criteria,n=e.criteria,o=-1,r=i.length;++o<r;){var s=i[o],a=n[o];if(s!==a){if(s>a||"undefined"==typeof s)return 1;if(a>s||"undefined"==typeof a)return-1}}return t.index-e.index}return t}),define("lodash/collections/sortBy",["../internals/compareAscending","../functions/createCallback","./forEach","../internals/getArray","../internals/getObject","../objects/isArray","./map","../internals/releaseArray","../internals/releaseObject"],function(t,e,i,n,o,r,s,a,h){function l(l,u,c){var p=-1,d=r(u),f=l?l.length:0,g=Array("number"==typeof f?f:0);for(d||(u=e(u,c,3)),i(l,function(t,e,i){var r=g[++p]=o();d?r.criteria=s(u,function(e){return t[e]}):(r.criteria=n())[0]=u(t,e,i),r.index=p,r.value=t}),f=g.length,g.sort(t);f--;){var m=g[f];g[f]=m.value,d||a(m.criteria),h(m)}return g}return l}),define("lodash/collections/toArray",["../objects/isString","../internals/slice","../objects/values"],function(t,e,i){function n(t){return t&&"number"==typeof t.length?e(t):i(t)}return n}),define("lodash/collections/where",["./filter"],function(t){var e=t;return e}),define("lodash/collections",["./collections/at","./collections/contains","./collections/countBy","./collections/every","./collections/filter","./collections/find","./collections/findLast","./collections/forEach","./collections/forEachRight","./collections/groupBy","./collections/indexBy","./collections/invoke","./collections/map","./collections/max","./collections/min","./collections/pluck","./collections/reduce","./collections/reduceRight","./collections/reject","./collections/sample","./collections/shuffle","./collections/size","./collections/some","./collections/sortBy","./collections/toArray","./collections/where"],function(t,e,i,n,o,r,s,a,h,l,u,c,p,d,f,g,m,y,v,b,x,w,S,C,T,_){return{all:n,any:S,at:t,collect:p,contains:e,countBy:i,detect:r,each:a,eachRight:h,every:n,filter:o,find:r,findLast:s,findWhere:r,foldl:m,foldr:y,forEach:a,forEachRight:h,groupBy:l,include:e,indexBy:u,inject:m,invoke:c,map:p,max:d,min:f,pluck:g,reduce:m,reduceRight:y,reject:v,sample:b,select:o,shuffle:x,size:w,some:S,sortBy:C,toArray:T,where:_}}),define("lodash/functions/after",["../objects/isFunction"],function(t){function e(e,i){if(!t(i))throw new TypeError;return function(){return--e<1?i.apply(this,arguments):void 0}}return e}),define("lodash/objects/functions",["./forIn","./isFunction"],function(t,e){function i(i){var n=[];return t(i,function(t,i){e(t)&&n.push(i)}),n.sort()}return i}),define("lodash/functions/bindAll",["../internals/baseFlatten","../internals/createWrapper","../objects/functions"],function(t,e,i){function n(n){for(var o=arguments.length>1?t(arguments,!0,!1,1):i(n),r=-1,s=o.length;++r<s;){var a=o[r];n[a]=e(n[a],1,null,null,n)}return n}return n}),define("lodash/functions/bindKey",["../internals/createWrapper","../internals/slice"],function(t,e){function i(i,n){return arguments.length>2?t(n,19,e(arguments,2),null,i):t(n,3,null,null,i)}return i}),define("lodash/functions/compose",["../objects/isFunction"],function(t){function e(){for(var e=arguments,i=e.length;i--;)if(!t(e[i]))throw new TypeError;return function(){for(var t=arguments,i=e.length;i--;)t=[e[i].apply(this,t)];return t[0]}}return e}),define("lodash/functions/curry",["../internals/createWrapper"],function(t){function e(e,i){return i="number"==typeof i?i:+i||e.length,t(e,4,null,null,null,i)}return e}),define("lodash/utilities/now",["../internals/isNative"],function(t){var e=t(e=Date.now)&&e||function(){return(new Date).getTime()};return e}),define("lodash/functions/debounce",["../objects/isFunction","../objects/isObject","../utilities/now"],function(t,e,i){function n(n,s,a){var h,l,u,c,p,d,f,g=0,m=!1,y=!0;if(!t(n))throw new TypeError;if(s=r(0,s)||0,a===!0){var v=!0;y=!1}else e(a)&&(v=a.leading,m="maxWait"in a&&(r(s,a.maxWait)||0),y="trailing"in a?a.trailing:y);var b=function(){var t=s-(i()-c);if(0>=t){l&&clearTimeout(l);var e=f;l=d=f=o,e&&(g=i(),u=n.apply(p,h),d||l||(h=p=null))}else d=setTimeout(b,t)},x=function(){d&&clearTimeout(d),l=d=f=o,(y||m!==s)&&(g=i(),u=n.apply(p,h),d||l||(h=p=null))};return function(){if(h=arguments,c=i(),p=this,f=y&&(d||!v),m===!1)var t=v&&!d;else{l||v||(g=c);var e=m-(c-g),o=0>=e;o?(l&&(l=clearTimeout(l)),g=c,u=n.apply(p,h)):l||(l=setTimeout(x,e))}return o&&d?d=clearTimeout(d):d||s===m||(d=setTimeout(b,s)),t&&(o=!0,u=n.apply(p,h)),!o||d||l||(h=p=null),u}}var o,r=Math.max;return n}),define("lodash/functions/defer",["../objects/isFunction","../internals/slice"],function(t,e){function i(i){if(!t(i))throw new TypeError;var o=e(arguments,1);return setTimeout(function(){i.apply(n,o)},1)}var n;return i}),define("lodash/functions/delay",["../objects/isFunction","../internals/slice"],function(t,e){function i(i,o){if(!t(i))throw new TypeError;var r=e(arguments,2);return setTimeout(function(){i.apply(n,r)},o)}var n;return i}),define("lodash/functions/memoize",["../objects/isFunction","../internals/keyPrefix"],function(t,e){function i(i,n){if(!t(i))throw new TypeError;var r=function(){var t=r.cache,s=n?n.apply(this,arguments):e+arguments[0];return o.call(t,s)?t[s]:t[s]=i.apply(this,arguments)};return r.cache={},r}var n=Object.prototype,o=n.hasOwnProperty;return i}),define("lodash/functions/once",["../objects/isFunction"],function(t){function e(e){var i,n;if(!t(e))throw new TypeError;return function(){return i?n:(i=!0,n=e.apply(this,arguments),e=null,n)}}return e}),define("lodash/functions/partial",["../internals/createWrapper","../internals/slice"],function(t,e){function i(i){return t(i,16,e(arguments,1))}return i}),define("lodash/functions/partialRight",["../internals/createWrapper","../internals/slice"],function(t,e){function i(i){return t(i,32,null,e(arguments,1))}return i}),define("lodash/functions/throttle",["./debounce","../objects/isFunction","../objects/isObject"],function(t,e,i){function n(n,r,s){var a=!0,h=!0;if(!e(n))throw new TypeError;return s===!1?a=!1:i(s)&&(a="leading"in s?s.leading:a,h="trailing"in s?s.trailing:h),o.leading=a,o.maxWait=r,o.trailing=h,t(n,r,o)}var o={leading:!1,maxWait:0,trailing:!1};return n}),define("lodash/functions/wrap",["../internals/createWrapper"],function(t){function e(e,i){return t(i,16,[e])}return e}),define("lodash/functions",["./functions/after","./functions/bind","./functions/bindAll","./functions/bindKey","./functions/compose","./functions/createCallback","./functions/curry","./functions/debounce","./functions/defer","./functions/delay","./functions/memoize","./functions/once","./functions/partial","./functions/partialRight","./functions/throttle","./functions/wrap"],function(t,e,i,n,o,r,s,a,h,l,u,c,p,d,f,g){return{after:t,bind:e,bindAll:i,bindKey:n,compose:o,createCallback:r,curry:s,debounce:a,defer:h,delay:l,memoize:u,once:c,partial:p,partialRight:d,throttle:f,wrap:g}}),define("lodash/objects/assign",["../internals/baseCreateCallback","./keys","../internals/objectTypes"],function(t,e,i){var n=function(n,o,r){var s,a=n,h=a;if(!a)return h;var l=arguments,u=0,c="number"==typeof r?2:l.length;if(c>3&&"function"==typeof l[c-2])var p=t(l[--c-1],l[c--],2);else c>2&&"function"==typeof l[c-1]&&(p=l[--c]);for(;++u<c;)if(a=l[u],a&&i[typeof a])for(var d=-1,f=i[typeof a]&&e(a),g=f?f.length:0;++d<g;)s=f[d],h[s]=p?p(h[s],a[s]):a[s];return h};return n}),define("lodash/internals/baseClone",["../objects/assign","../collections/forEach","../objects/forOwn","./getArray","../objects/isArray","../objects/isObject","./releaseArray","./slice"],function(t,e,i,n,o,r,s,a){function h(u,c,f,m,x){if(f){var T=f(u);if("undefined"!=typeof T)return T}var _=r(u);if(!_)return u;var M=w.call(u);if(!b[M])return u;var E=C[M];switch(M){case p:case d:return new E(+u);case g:case v:return new E(u);case y:return T=E(u.source,l.exec(u)),T.lastIndex=u.lastIndex,T}var A=o(u);if(c){var B=!m;m||(m=n()),x||(x=n());for(var k=m.length;k--;)if(m[k]==u)return x[k];T=A?E(u.length):{}}else T=A?a(u):t({},u);return A&&(S.call(u,"index")&&(T.index=u.index),S.call(u,"input")&&(T.input=u.input)),c?(m.push(u),x.push(T),(A?e:i)(u,function(t,e){T[e]=h(t,c,f,m,x)}),B&&(s(m),s(x)),T):T}var l=/\w*$/,u="[object Arguments]",c="[object Array]",p="[object Boolean]",d="[object Date]",f="[object Function]",g="[object Number]",m="[object Object]",y="[object RegExp]",v="[object String]",b={};b[f]=!1,b[u]=b[c]=b[p]=b[d]=b[g]=b[m]=b[y]=b[v]=!0;var x=Object.prototype,w=x.toString,S=x.hasOwnProperty,C={};return C[c]=Array,C[p]=Boolean,C[d]=Date,C[f]=Function,C[m]=Object,C[g]=Number,C[y]=RegExp,C[v]=String,h}),define("lodash/objects/clone",["../internals/baseClone","../internals/baseCreateCallback"],function(t,e){function i(i,n,o,r){return"boolean"!=typeof n&&null!=n&&(r=o,o=n,n=!1),t(i,n,"function"==typeof o&&e(o,r,1))}return i}),define("lodash/objects/cloneDeep",["../internals/baseClone","../internals/baseCreateCallback"],function(t,e){function i(i,n,o){return t(i,!0,"function"==typeof n&&e(n,o,1))}return i}),define("lodash/objects/create",["./assign","../internals/baseCreate"],function(t,e){function i(i,n){var o=e(i);return n?t(o,n):o}return i}),define("lodash/objects/defaults",["./keys","../internals/objectTypes"],function(t,e){var i=function(i,n,o){var r,s=i,a=s;if(!s)return a;for(var h=arguments,l=0,u="number"==typeof o?2:h.length;++l<u;)if(s=h[l],s&&e[typeof s])for(var c=-1,p=e[typeof s]&&t(s),d=p?p.length:0;++c<d;)r=p[c],"undefined"==typeof a[r]&&(a[r]=s[r]);return a};return i}),define("lodash/objects/findKey",["../functions/createCallback","./forOwn"],function(t,e){function i(i,n,o){var r;return n=t(n,o,3),e(i,function(t,e,i){return n(t,e,i)?(r=e,!1):void 0}),r}return i}),define("lodash/objects/forOwnRight",["../internals/baseCreateCallback","./keys"],function(t,e){function i(i,n,o){var r=e(i),s=r.length;for(n=t(n,o,3);s--;){var a=r[s];if(n(i[a],a,i)===!1)break}return i}return i}),define("lodash/objects/findLastKey",["../functions/createCallback","./forOwnRight"],function(t,e){function i(i,n,o){var r;return n=t(n,o,3),e(i,function(t,e,i){return n(t,e,i)?(r=e,!1):void 0}),r}return i}),define("lodash/objects/forInRight",["../internals/baseCreateCallback","./forIn"],function(t,e){function i(i,n,o){var r=[];e(i,function(t,e){r.push(e,t)});var s=r.length;for(n=t(n,o,3);s--&&n(r[s--],r[s],i)!==!1;);return i}return i}),define("lodash/objects/has",[],function(){function t(t,e){return t?i.call(t,e):!1}var e=Object.prototype,i=e.hasOwnProperty;return t}),define("lodash/objects/invert",["./keys"],function(t){function e(e){for(var i=-1,n=t(e),o=n.length,r={};++i<o;){var s=n[i];r[e[s]]=s}return r}return e}),define("lodash/objects/isBoolean",[],function(){function t(t){return t===!0||t===!1||t&&"object"==typeof t&&n.call(t)==e||!1}var e="[object Boolean]",i=Object.prototype,n=i.toString;return t}),define("lodash/objects/isDate",[],function(){function t(t){return t&&"object"==typeof t&&n.call(t)==e||!1}var e="[object Date]",i=Object.prototype,n=i.toString;return t}),define("lodash/objects/isElement",[],function(){function t(t){return t&&1===t.nodeType||!1}return t}),define("lodash/objects/isEmpty",["./forOwn","./isFunction"],function(t,e){function i(i){var a=!0;if(!i)return a;var l=h.call(i),u=i.length;return l==o||l==s||l==n||l==r&&"number"==typeof u&&e(i.splice)?!u:(t(i,function(){return a=!1}),a)}var n="[object Arguments]",o="[object Array]",r="[object Object]",s="[object String]",a=Object.prototype,h=a.toString;return i}),define("lodash/objects/isEqual",["../internals/baseCreateCallback","../internals/baseIsEqual"],function(t,e){function i(i,n,o,r){return e(i,n,"function"==typeof o&&t(o,r,2))}return i}),define("lodash/objects/isFinite",[],function(){function t(t){return e(t)&&!i(parseFloat(t))}var e=window.isFinite,i=window.isNaN;return t}),define("lodash/objects/isNumber",[],function(){function t(t){return"number"==typeof t||t&&"object"==typeof t&&n.call(t)==e||!1}var e="[object Number]",i=Object.prototype,n=i.toString;return t}),define("lodash/objects/isNaN",["./isNumber"],function(t){function e(e){return t(e)&&e!=+e}return e}),define("lodash/objects/isNull",[],function(){function t(t){return null===t}return t}),define("lodash/internals/shimIsPlainObject",["../objects/forIn","../objects/isFunction"],function(t,e){function i(i){var o,a;return i&&r.call(i)==n&&(o=i.constructor,!e(o)||o instanceof o)?(t(i,function(t,e){a=e}),"undefined"==typeof a||s.call(i,a)):!1}var n="[object Object]",o=Object.prototype,r=o.toString,s=o.hasOwnProperty;return i}),define("lodash/objects/isPlainObject",["../internals/isNative","../internals/shimIsPlainObject"],function(t,e){var i="[object Object]",n=Object.prototype,o=n.toString,r=t(r=Object.getPrototypeOf)&&r,s=r?function(n){if(!n||o.call(n)!=i)return!1;var s=n.valueOf,a=t(s)&&(a=r(s))&&r(a);return a?n==a||r(n)==a:e(n)}:e;return s}),define("lodash/objects/isRegExp",[],function(){function t(t){return t&&"object"==typeof t&&n.call(t)==e||!1}var e="[object RegExp]",i=Object.prototype,n=i.toString;return t}),define("lodash/objects/isUndefined",[],function(){function t(t){return"undefined"==typeof t}return t}),define("lodash/objects/mapValues",["../functions/createCallback","./forOwn"],function(t,e){function i(i,n,o){var r={};return n=t(n,o,3),e(i,function(t,e,i){r[e]=n(t,e,i)}),r}return i}),define("lodash/internals/baseMerge",["../collections/forEach","../objects/forOwn","../objects/isArray","../objects/isPlainObject"],function(t,e,i,n){function o(r,s,a,h,l){(i(s)?t:e)(s,function(t,e){var s,u,c=t,p=r[e];if(t&&((u=i(t))||n(t))){for(var d=h.length;d--;)if(s=h[d]==t){p=l[d];break}if(!s){var f;a&&(c=a(p,t),(f="undefined"!=typeof c)&&(p=c)),f||(p=u?i(p)?p:[]:n(p)?p:{}),h.push(t),l.push(p),f||o(p,t,a,h,l)}}else a&&(c=a(p,t),"undefined"==typeof c&&(c=t)),"undefined"!=typeof c&&(p=c);r[e]=p})}return o}),define("lodash/objects/merge",["../internals/baseCreateCallback","../internals/baseMerge","../internals/getArray","./isObject","../internals/releaseArray","../internals/slice"],function(t,e,i,n,o,r){function s(s){var a=arguments,h=2;if(!n(s))return s;if("number"!=typeof a[2]&&(h=a.length),h>3&&"function"==typeof a[h-2])var l=t(a[--h-1],a[h--],2);else h>2&&"function"==typeof a[h-1]&&(l=a[--h]);for(var u=r(arguments,1,h),c=-1,p=i(),d=i();++c<h;)e(s,u[c],l,p,d);return o(p),o(d),s}return s}),define("lodash/objects/omit",["../internals/baseDifference","../internals/baseFlatten","../functions/createCallback","./forIn"],function(t,e,i,n){function o(o,r,s){var a={};if("function"!=typeof r){var h=[];n(o,function(t,e){h.push(e)}),h=t(h,e(arguments,!0,!1,1));for(var l=-1,u=h.length;++l<u;){var c=h[l];a[c]=o[c]}}else r=i(r,s,3),n(o,function(t,e,i){r(t,e,i)||(a[e]=t)});return a}return o}),define("lodash/objects/pairs",["./keys"],function(t){function e(e){for(var i=-1,n=t(e),o=n.length,r=Array(o);++i<o;){var s=n[i];r[i]=[s,e[s]]}return r}return e}),define("lodash/objects/pick",["../internals/baseFlatten","../functions/createCallback","./forIn","./isObject"],function(t,e,i,n){function o(o,r,s){var a={};if("function"!=typeof r)for(var h=-1,l=t(arguments,!0,!1,1),u=n(o)?l.length:0;++h<u;){var c=l[h];c in o&&(a[c]=o[c])}else r=e(r,s,3),i(o,function(t,e,i){r(t,e,i)&&(a[e]=t)});return a}return o}),define("lodash/objects/transform",["../internals/baseCreate","../functions/createCallback","../collections/forEach","./forOwn","./isArray"],function(t,e,i,n,o){function r(r,s,a,h){var l=o(r);if(null==a)if(l)a=[];else{var u=r&&r.constructor,c=u&&u.prototype;a=t(c)}return s&&(s=e(s,h,4),(l?i:n)(r,function(t,e,i){return s(a,t,e,i)})),a}return r}),define("lodash/objects",["./objects/assign","./objects/clone","./objects/cloneDeep","./objects/create","./objects/defaults","./objects/findKey","./objects/findLastKey","./objects/forIn","./objects/forInRight","./objects/forOwn","./objects/forOwnRight","./objects/functions","./objects/has","./objects/invert","./objects/isArguments","./objects/isArray","./objects/isBoolean","./objects/isDate","./objects/isElement","./objects/isEmpty","./objects/isEqual","./objects/isFinite","./objects/isFunction","./objects/isNaN","./objects/isNull","./objects/isNumber","./objects/isObject","./objects/isPlainObject","./objects/isRegExp","./objects/isString","./objects/isUndefined","./objects/keys","./objects/mapValues","./objects/merge","./objects/omit","./objects/pairs","./objects/pick","./objects/transform","./objects/values"],function(t,e,i,n,o,r,s,a,h,l,u,c,p,d,f,g,m,y,v,b,x,w,S,C,T,_,M,E,A,B,k,O,P,R,L,F,D,I,j){return{assign:t,clone:e,cloneDeep:i,create:n,defaults:o,extend:t,findKey:r,findLastKey:s,forIn:a,forInRight:h,forOwn:l,forOwnRight:u,functions:c,has:p,invert:d,isArguments:f,isArray:g,isBoolean:m,isDate:y,isElement:v,isEmpty:b,isEqual:x,isFinite:w,isFunction:S,isNaN:C,isNull:T,isNumber:_,isObject:M,isPlainObject:E,isRegExp:A,isString:B,isUndefined:k,keys:O,mapValues:P,merge:R,methods:c,omit:L,pairs:F,pick:D,transform:I,values:j}}),define("lodash/utilities/constant",[],function(){function t(t){return function(){return t}}return t}),define("lodash/internals/htmlEscapes",[],function(){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return t}),define("lodash/internals/escapeHtmlChar",["./htmlEscapes"],function(t){function e(e){return t[e]}return e}),define("lodash/internals/reUnescapedHtml",["./htmlEscapes","../objects/keys"],function(t,e){var i=RegExp("["+e(t).join("")+"]","g");return i}),define("lodash/utilities/escape",["../internals/escapeHtmlChar","../objects/keys","../internals/reUnescapedHtml"],function(t,e,i){function n(e){return null==e?"":String(e).replace(i,t)}return n}),define("lodash/utilities/mixin",["../collections/forEach","../objects/functions","../objects/isFunction","../objects/isObject"],function(t,e,i,n){function o(o,r,a){var h=!0,l=r&&e(r);a===!1?h=!1:n(a)&&"chain"in a&&(h=a.chain);var u=o,c=i(u);t(l,function(t){var e=o[t]=r[t];c&&(u.prototype[t]=function(){var t=this.__chain__,i=this.__wrapped__,r=[i];s.apply(r,arguments);var a=e.apply(o,r);if(h||t){if(i===a&&n(a))return this;a=new u(a),a.__chain__=t}return a})})}var r=[],s=r.push;return o}),define("lodash/utilities/noConflict",[],function(){function t(){return window._=e,this}var e=window._;return t}),define("lodash/utilities/parseInt",["../objects/isString"],function(t){var e=" 	\f ﻿\n\r\u2028\u2029 ᠎             　",i=RegExp("^["+e+"]*0+(?=.$)"),n=window.parseInt,o=8==n(e+"08")?n:function(e,o){return n(t(e)?e.replace(i,""):e,o||0)};return o}),define("lodash/utilities/random",["../internals/baseRandom"],function(t){function e(e,o,r){var s=null==e,a=null==o;if(null==r&&("boolean"==typeof e&&a?(r=e,e=1):a||"boolean"!=typeof o||(r=o,a=!0)),s&&a&&(o=1),e=+e||0,a?(o=e,e=0):o=+o||0,r||e%1||o%1){var h=n();return i(e+h*(o-e+parseFloat("1e-"+((h+"").length-1))),o)}return t(e,o)}var i=Math.min,n=Math.random;return e}),define("lodash/utilities/result",["../objects/isFunction"],function(t){function e(e,i){if(e){var n=e[i];return t(n)?e[i]():n}}return e}),define("lodash/internals/escapeStringChar",[],function(){function t(t){return"\\"+e[t]}var e={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"};return t}),define("lodash/internals/reInterpolate",[],function(){var t=/<%=([\s\S]+?)%>/g;return t}),define("lodash/utilities/templateSettings",["./escape","../internals/reInterpolate"],function(t,e){var i={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:e,variable:"",imports:{_:{escape:t}}};return i}),define("lodash/utilities/template",["../objects/defaults","./escape","../internals/escapeStringChar","../objects/keys","../internals/reInterpolate","./templateSettings","../objects/values"],function(t,e,i,n,o,r,s){function a(e,a,g){var m=r.imports._.templateSettings||r;e=String(e||""),g=t({},g,m);var y,v=t({},g.imports,m.imports),b=n(v),x=s(v),w=0,S=g.interpolate||d,C="__p += '",T=RegExp((g.escape||d).source+"|"+S.source+"|"+(S===o?p:d).source+"|"+(g.evaluate||d).source+"|$","g");e.replace(T,function(t,n,o,r,s,a){return o||(o=r),C+=e.slice(w,a).replace(f,i),n&&(C+="' +\n__e("+n+") +\n'"),s&&(y=!0,C+="';\n"+s+";\n__p += '"),o&&(C+="' +\n((__t = ("+o+")) == null ? '' : __t) +\n'"),w=a+t.length,t}),C+="';\n";var _=g.variable,M=_;M||(_="obj",C="with ("+_+") {\n"+C+"\n}\n"),C=(y?C.replace(l,""):C).replace(u,"$1").replace(c,"$1;"),C="function("+_+") {\n"+(M?"":_+" || ("+_+" = {});\n")+"var __t, __p = '', __e = _.escape"+(y?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+C+"return __p\n}";try{var E=Function(b,"return "+C).apply(h,x)}catch(A){throw A.source=C,A}return a?E(a):(E.source=C,E)}var h,l=/\b__p \+= '';/g,u=/\b(__p \+=) '' \+/g,c=/(__e\(.*?\)|\b__t\)) \+\n'';/g,p=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,d=/($^)/,f=/['\n\r\t\u2028\u2029\\]/g;return a}),define("lodash/utilities/times",["../internals/baseCreateCallback"],function(t){function e(e,i,n){e=(e=+e)>-1?e:0;var o=-1,r=Array(e);for(i=t(i,n,1);++o<e;)r[o]=i(o);return r}return e}),define("lodash/internals/htmlUnescapes",["./htmlEscapes","../objects/invert"],function(t,e){var i=e(t);return i}),define("lodash/internals/reEscapedHtml",["./htmlUnescapes","../objects/keys"],function(t,e){var i=RegExp("("+e(t).join("|")+")","g");return i}),define("lodash/internals/unescapeHtmlChar",["./htmlUnescapes"],function(t){function e(e){return t[e]}return e}),define("lodash/utilities/unescape",["../objects/keys","../internals/reEscapedHtml","../internals/unescapeHtmlChar"],function(t,e,i){function n(t){return null==t?"":String(t).replace(e,i)}return n}),define("lodash/utilities/uniqueId",[],function(){function t(t){var i=++e;return String(null==t?"":t)+i}var e=0;return t}),define("lodash/utilities",["./utilities/constant","./functions/createCallback","./utilities/escape","./utilities/identity","./utilities/mixin","./utilities/noConflict","./utilities/noop","./utilities/now","./utilities/parseInt","./utilities/property","./utilities/random","./utilities/result","./utilities/template","./utilities/templateSettings","./utilities/times","./utilities/unescape","./utilities/uniqueId"],function(t,e,i,n,o,r,s,a,h,l,u,c,p,d,f,g,m){return{constant:t,createCallback:e,escape:i,identity:n,mixin:o,noConflict:r,noop:s,now:a,parseInt:h,property:l,random:u,result:c,template:p,templateSettings:d,times:f,unescape:g,uniqueId:m}}),define("lodash/main",["./arrays","./chaining","./collections","./functions","./objects","./utilities","./collections/forEach","./objects/forOwn","./objects/isArray","./internals/lodashWrapper","./utilities/mixin","./support","./utilities/templateSettings"],function(t,e,i,n,o,r,s,a,h,l,u,c){function p(t){return t&&"object"==typeof t&&!h(t)&&g.call(t,"__wrapped__")?t:new l(t)}var d=[],f=Object.prototype,g=f.hasOwnProperty;return l.prototype=p.prototype,u=function(t){var e=o.functions;return function(i,n,o){return n&&(o||e(n).length)||(null==o&&(o=n),n=i,i=p),t(i,n,o)}}(u),p.after=n.after,p.assign=o.assign,p.at=i.at,p.bind=n.bind,p.bindAll=n.bindAll,p.bindKey=n.bindKey,p.chain=e.chain,p.compact=t.compact,p.compose=n.compose,p.constant=r.constant,p.countBy=i.countBy,p.create=o.create,p.createCallback=n.createCallback,p.curry=n.curry,p.debounce=n.debounce,p.defaults=o.defaults,p.defer=n.defer,p.delay=n.delay,p.difference=t.difference,p.filter=i.filter,p.flatten=t.flatten,p.forEach=s,p.forEachRight=i.forEachRight,p.forIn=o.forIn,p.forInRight=o.forInRight,p.forOwn=a,p.forOwnRight=o.forOwnRight,p.functions=o.functions,p.groupBy=i.groupBy,p.indexBy=i.indexBy,p.initial=t.initial,p.intersection=t.intersection,p.invert=o.invert,p.invoke=i.invoke,p.keys=o.keys,p.map=i.map,p.mapValues=o.mapValues,p.max=i.max,p.memoize=n.memoize,p.merge=o.merge,p.min=i.min,p.omit=o.omit,p.once=n.once,p.pairs=o.pairs,p.partial=n.partial,p.partialRight=n.partialRight,p.pick=o.pick,p.pluck=i.pluck,p.property=r.property,p.pull=t.pull,p.range=t.range,p.reject=i.reject,p.remove=t.remove,p.rest=t.rest,p.shuffle=i.shuffle,p.sortBy=i.sortBy,p.tap=e.tap,p.throttle=n.throttle,p.times=r.times,p.toArray=i.toArray,p.transform=o.transform,p.union=t.union,p.uniq=t.uniq,p.values=o.values,p.where=i.where,p.without=t.without,p.wrap=n.wrap,p.xor=t.xor,p.zip=t.zip,p.zipObject=t.zipObject,p.collect=i.map,p.drop=t.rest,p.each=s,p.eachRight=i.forEachRight,p.extend=o.assign,p.methods=o.functions,p.object=t.zipObject,p.select=i.filter,p.tail=t.rest,p.unique=t.uniq,p.unzip=t.zip,u(p),p.clone=o.clone,p.cloneDeep=o.cloneDeep,p.contains=i.contains,p.escape=r.escape,p.every=i.every,p.find=i.find,p.findIndex=t.findIndex,p.findKey=o.findKey,p.findLast=i.findLast,p.findLastIndex=t.findLastIndex,p.findLastKey=o.findLastKey,p.has=o.has,p.identity=r.identity,p.indexOf=t.indexOf,p.isArguments=o.isArguments,p.isArray=h,p.isBoolean=o.isBoolean,p.isDate=o.isDate,p.isElement=o.isElement,p.isEmpty=o.isEmpty,p.isEqual=o.isEqual,p.isFinite=o.isFinite,p.isFunction=o.isFunction,p.isNaN=o.isNaN,p.isNull=o.isNull,p.isNumber=o.isNumber,p.isObject=o.isObject,p.isPlainObject=o.isPlainObject,p.isRegExp=o.isRegExp,p.isString=o.isString,p.isUndefined=o.isUndefined,p.lastIndexOf=t.lastIndexOf,p.mixin=u,p.noConflict=r.noConflict,p.noop=r.noop,p.now=r.now,p.parseInt=r.parseInt,p.random=r.random,p.reduce=i.reduce,p.reduceRight=i.reduceRight,p.result=r.result,p.size=i.size,p.some=i.some,p.sortedIndex=t.sortedIndex,p.template=r.template,p.unescape=r.unescape,p.uniqueId=r.uniqueId,p.all=i.every,p.any=i.some,p.detect=i.find,p.findWhere=i.find,p.foldl=i.reduce,p.foldr=i.reduceRight,p.include=i.contains,p.inject=i.reduce,u(function(){var t={};return a(p,function(e,i){p.prototype[i]||(t[i]=e)}),t}(),!1),p.first=t.first,p.last=t.last,p.sample=i.sample,p.take=t.first,p.head=t.first,a(p,function(t,e){var i="sample"!==e;p.prototype[e]||(p.prototype[e]=function(e,n){var o=this.__chain__,r=t(this.__wrapped__,e,n);return o||null!=e&&(!n||i&&"function"==typeof e)?new l(r,o):r})}),p.VERSION="2.4.1",p.prototype.chain=e.wrapperChain,p.prototype.toString=e.wrapperToString,p.prototype.value=e.wrapperValueOf,p.prototype.valueOf=e.wrapperValueOf,s(["join","pop","shift"],function(t){var e=d[t];p.prototype[t]=function(){var t=this.__chain__,i=e.apply(this.__wrapped__,arguments);return t?new l(i,t):i}}),s(["push","reverse","sort","unshift"],function(t){var e=d[t];p.prototype[t]=function(){return e.apply(this.__wrapped__,arguments),this}}),s(["concat","slice","splice"],function(t){var e=d[t];p.prototype[t]=function(){return new l(e.apply(this.__wrapped__,arguments),this.__chain__)}}),p.support=c,(p.templateSettings=r.templateSettings).imports._=p,p}),define("lodash",["lodash/main"],function(t){return t}),define("absolute/screenmetrics",["absolute/debug","absolute/platform","lodash"],function(t,e,i){var n={kDefaultWidth:1536,kDefaultHeight:2008,resClass:"",stepDownResClass:!1,stepDownResClassAggressively:!0,realWindow:function(){var t,e;try{e=window.self!==window.top,t=e&&parent.window.devicePixelRatio&&"undefined"!=typeof parent.window.devicePixelRatio?parent.window:window}catch(i){t=window}return t}(),realScreen:function(){var t;try{t=parent!==window&&parent.screen?parent.screen:screen}catch(e){t=screen}return t}(),refresh:function(){this.devicePixelRatio=this.realWindow.devicePixelRatio||1,this.screenWidth=this.realScreen.width,this.screenHeight=this.realScreen.height,this.innerWidth=this.realWindow.innerWidth,this.innerHeight=this.realWindow.innerHeight,this.outerWidth=this.realWindow.outerWidth,this.outerHeight=this.realWindow.outerHeight,this.clientWidth=document.documentElement.clientWidth,this.clientHeight=document.documentElement.clientHeight},getMinNonZero:function(t){return Math.min.apply(null,i.filter(t,function(t){return t>0}))},isPortrait:function(){this.refresh();var t=this.getMinNonZero([this.innerWidth,this.screenWidth,this.clientWidth]),i=this.getMinNonZero([this.innerHeight,this.screenHeight,this.clientHeight]);return e._isAndroid()&&(t=this.getMinNonZero([this.innerWidth,this.clientWidth]),i=this.getMinNonZero([this.innerHeight,this.clientHeight])),i>t},getWidth:function(t){t="undefined"!=typeof t?t:!1;var i=this.clientWidth,n=this.clientHeight;if(t&&(i*=this.devicePixelRatio,n*=this.devicePixelRatio),this.isPortrait()&&i>0)return i;if(n>i)return i;if(1280===i)return 800;if(e._isAndroid())return Math.max(this.realScreen.height,n);var o=this.realScreen.width;return t&&(o*=this.devicePixelRatio),Math.max(o,n)},getHeight:function(t){t="undefined"!=typeof t?t:!1;var e;return e=this.isPortrait()&&this.clientHeight>0?this.clientHeight:this.screenWidth<this.screenHeight?this.screenHeight-(this.screenWidth-(this.innerHeight||0)):this.screenWidth-(this.screenHeight-(this.innerHeight||0)),t&&(e*=this.devicePixelRatio),navigator.userAgent.match(/iPhone/i)&&(e-=16),e},getScaledViewportWidth:function(){return this.getWidth()/this.getViewportScale()},getScaledViewportHeight:function(){return this.getHeight()/this.getViewportScale()},getScaledContentWidth:function(){return this.getContentWidth()*this.getViewportScale()},getScaledContentHeight:function(){return this.getContentHeight()*this.getViewportScale()},getContentWidth:function(){return this.kDefaultWidth*this.getResScale()/this.devicePixelRatio},getContentHeight:function(){return this.kDefaultHeight*this.getResScale()/this.devicePixelRatio},getViewportScale:function(){var t=this.getWidth()/this.getContentWidth(),e=this.getHeight()/this.getContentHeight();return Math.min(t,e)},resClasses:[{id:"r320",resfloor:0},{id:"r640",resfloor:320},{id:"r768",resfloor:640},{id:"r1280",resfloor:768}],getResClass:function(){if(""!==this.resClass)return this.resClass;for(var t=Math.min(this.getHeight(!0),this.getWidth(!0)),i=0,n=this.resClasses.length-1;n>0;n--)if(t>this.resClasses[n].resfloor){i=n;break}return this.stepDownResClass&&(i-=e.getResStepsDown(i,this.stepDownResClassAggressively),0>i&&(i=0)),this.resClass=this.resClasses[i].id,this.resClass},getResScale:function(){switch(this.getResClass()){case"r320":return.21;case"r640":return.42;case"r768":return.5;case"r1280":return.83;case"r1536":return 1;default:return 1}},getScaleX:function(){return this.getWidth()*this.devicePixelRatio/(this.kDefaultWidth*this.getResScale())},getScaleY:function(){return this.getHeight()*this.devicePixelRatio/(this.kDefaultHeight*this.getResScale())},log:function(){t.log("devicePixelRatio "+this.devicePixelRatio),t.log("screenWidth "+this.screenWidth),t.log("screenHeight "+this.screenHeight),t.log("innerWidth "+this.innerWidth),t.log("innerHeight "+this.innerHeight),t.log("outerWidth "+this.outerWidth),t.log("outerHeight "+this.outerHeight),t.log("isPortrait() "+this.isPortrait()),t.log("getWidth() "+this.getWidth()),t.log("getHeight() "+this.getHeight()),t.log("getResClass() "+this.getResClass()),t.log("getResScale() "+this.getResScale()),t.log("getContentWidth() "+this.getContentWidth()),t.log("getContentHeight() "+this.getContentHeight()),t.log("getViewportScale() "+this.getViewportScale()),t.log("getScaledContentWidth "+this.getScaledContentWidth()),t.log("getScaledContentHeight "+this.getScaledContentHeight()),t.log("getScaledViewportWidth "+this.getScaledViewportWidth()),t.log("getScaledViewportHeight "+this.getScaledViewportHeight())
},getScreenParams:function(){return"devicePixelRatio="+this.devicePixelRatio+"&screen.width="+this.realScreen.width+"&screen.height="+this.realScreen.height+"&window.innerWidth="+this.realWindow.innerWidth+"&window.innerHeight="+this.realWindow.innerHeight+"&window.outerWidth="+this.realWindow.outerWidth+"&window.outerHeight="+this.realWindow.outerHeight+"&document.documentElement.clientWidth="+document.documentElement.clientWidth+"&document.documentElement.clientHeight="+document.documentElement.clientHeight+"&resClass="+this.getResClass()+"&resScale="+this.getResScale()},detectOrientationChange:function(t){function i(){var e=this.getOrientation();this.lastOrienation!==e&&(t(e),this.lastOrienation=e)}this.lastOrienation=this.getOrientation(),e.supportsDeviceOrientation?this.realWindow.addEventListener("deviceorientation",i.bind(this)):this.realWindow.addEventListener("resize",i.bind(this))},getOrientation:function(){return this.refresh(),this.isPortrait()?"portrait":"landscape"}};return n}),define("absolute/coords",["absolute/screenmetrics"],function(t){var e={x:function(e){return Math.round(e*t.getResScale())},y:function(e){return Math.round(e*t.getResScale())},worldX:function(e){return Math.round(e/t.getResScale())},worldY:function(e){return Math.round(e/t.getResScale())},offsetX:function(t,e){return e.position.x+t},offsetY:function(t,e){return e.position.y+t},centerX:function(t,e){return(e.width-t.width)/2},centerY:function(t,e){return(e.height-t.height)/2}};return e}),define("absolute/snapshot",["pixi"],function(t){var e=function(t){this.initSnapshot(t)};return e.constructor=e,e.prototype.initSnapshot=function(e){var i=new t.Stage;this.renderer=new t.CanvasRenderer(e.width,e.height,null,!0),i.addChild(e),this.renderer.render(i)},e.prototype.getSnapshot=function(){return t.Texture.fromCanvas(this.renderer.view)},e}),define("absolute/spriteutils",["absolute/snapshot","pixi"],function(t,e){var i={offScreenRenderer:new e.CanvasRenderer(512,512,null,!0),brightness:function(t,e){var i,n=t.generateTexture(this.offScreenRenderer),o=null;if(n.textureBuffer.context){o=n.textureBuffer.context.getImageData(n.frame.x,n.frame.y,n.frame.width,n.frame.height);var r=255*e||255,s=o.data;for(i=0;i<s.length;i+=4)s[i]+=r,s[i+1]+=r,s[i+2]+=r;n.textureBuffer.context.putImageData(o,0,0)}return n},greyscale:function(t,e){var i,n=t.generateTexture(this.offScreenRenderer),o=null;if(n.textureBuffer.context){o=n.textureBuffer.context.getImageData(n.frame.x,n.frame.y,n.frame.width,n.frame.height);var r=e||1,s=-128*r+128,a=o.data;for(i=0;i<a.length;i+=4){var h=a[i],l=a[i+1],u=a[i+2],c=.2126*h+.7152*l+.0722*u;c=c*r+s,a[i]=a[i+1]=a[i+2]=c}n.textureBuffer.context.putImageData(o,0,0)}return n},blur:function(t){var e=t.generateTexture(),i=e.textureBuffer.context.getImageData(e.frame.x,e.frame.y,e.frame.width,e.frame.height);return e.textureBuffer.context.putImageData(this.convolute(i,e.textureBuffer.context,[1/16,1/16,1/16,1/16,1/16,1/16,1/16,1/16,1/16,1/16,1/16,1/16,1/16,1/16,1/16,1/16]),0,0),e},convolute:function(t,e,i,n){for(var o=Math.round(Math.sqrt(i.length)),r=Math.floor(o/2),s=t.data,a=t.width,h=t.height,l=a,u=h,c=e.createImageData(l,u),p=c.data,d=n?1:0,f=0;u>f;f++)for(var g=0;l>g;g++){for(var m=f,y=g,v=4*(f*l+g),b=0,x=0,w=0,S=0,C=0;o>C;C++)for(var T=0;o>T;T++){var _=m+C-r,M=y+T-r;if(_>=0&&h>_&&M>=0&&a>M){var E=4*(_*a+M),A=i[C*o+T];b+=s[E]*A,x+=s[E+1]*A,w+=s[E+2]*A,S+=s[E+3]*A}}p[v]=b,p[v+1]=x,p[v+2]=w,p[v+3]=S+d*(255-S)}return c}};return i}),define("absolute/button",["pixi","absolute/coords","absolute/audiomanager","absolute/platform","absolute/spriteutils"],function(t,e,i,n,o){var r=function(t,e,i,n,o){this._initButton(t,e,i,n,o)};return r.constructor=r,r.prototype=Object.create(t.Sprite.prototype),r.prototype._initButton=function(e,i,r,s,a){this.replaceOnHover=!!s,a="undefined"!=typeof a?a:!1,this.replaceOnHover||(this.replaceOnHover=!0),t.Sprite.call(this,e),this.active=!0,this.action=r,this.images={},this.defaultImage=e,this.hoverImage=o.brightness(this,.2);var h=new t.DisplayObjectContainer,l=new t.Sprite(o.greyscale(this,.5)),u=new t.Sprite(this.defaultImage);l.alpha=.8,h.addChild(u),h.addChild(l),this.disabledTexture=h.generateTexture(),this.buttonMode=!0,this.setInteractive(!0);var c=this;n.supportsTouch()||(this.mouseover=function(){c.setTexture(c.hoverImage)},this.mouseout=function(){c.setTexture(c.defaultImage)});var p=function(){c.setTexture(c.defaultImage),c.doAction()};n.supportsTouch()?a?(this.touchstart=function(){this.clickCanceled=!1}.bind(this),this.touchmove=function(){this.clickCanceled=!0}.bind(this),this.touchend=function(){this.clickCanceled||p(),this.clickCancelled=!1}.bind(this)):this.touchstart=function(){p()}:(this.mousedown=function(){this.clickCanceled=!1}.bind(this),this.mousemove=function(){}.bind(this),this.mouseup=function(){this.clickCanceled||p(),this.clickCancelled=!1}.bind(this))},r.prototype.doAction=function(){i.simulSoundSupport()&&i.playSound("button_click"),this.action&&this.action()},r.prototype.isActive=function(){return this.active},r.prototype.disable=function(t){t?this.setActive(!1):(this.active=!1,this.interactive=!1)},r.prototype.enable=function(){this.setActive(!0)},r.prototype.setActive=function(t){this.active!==t&&(this.active=t,this.setTexture(t?this.defaultImage:this.disabledTexture),this.interactive=t)},r.prototype.getWidth=function(){return this.defaultImage.width},r.prototype.getHeight=function(){return this.defaultImage.height},r}),define("absolute/digitsprite",["pixi"],function(t){"use strict";var e=function(t){this.initDigitSprite(t)};return e.constructor=e,e.prototype=Object.create(t.Sprite.prototype),e.prototype.initDigitSprite=function(e){var i;for(this.textures=[],i=0;10>i;i+=1)this.textures.push(t.Texture.fromFrame(e+"_0"+i+".png"));this.textures.push(t.Texture.fromFrame(e+"_colon.png")),this.textures.push(t.Texture.fromFrame(e+"_comma.png")),this.index=0,t.Sprite.call(this,this.textures[0])},e.prototype.setDigit=function(t){var e=parseInt(t);this.index=e>=0&&10>e?e:":"===t?10:","===t?11:0,this.setTexture(this.textures[this.index])},e.prototype.getDigitWidth=function(){return this.width},e}),define("absolute/digitlabel",["pixi","absolute/digitsprite"],function(t,e){var i=function(t,e,i){this.initDigitLabel(t,e,i)};return i.constructor=i,i.prototype=Object.create(t.DisplayObjectContainer.prototype),i.prototype.initDigitLabel=function(i,n,o){t.DisplayObjectContainer.call(this),o=o||"number_large",n=n||1,this.text="",this.numDigits=i||8,this.numCommas=Math.ceil(this.numDigits/3-1),this.numSprites=this.numDigits+this.numCommas,this.sprites=[];for(var r=0;r<this.numSprites;++r){var s=new e(o);s.scale.x=s.scale.y=n,this.sprites.push(s),this.addChild(s)}this.layout()},i.prototype.getText=function(){return this.text},i.prototype.setText=function(t){this.text=t,this.layout()},i.prototype.layout=function(){for(var t=0,e=0;e<this.sprites.length;e++)this.sprites[e].visible=!1;if(this.text.length>0)for(var i=0,n=this.text.length;n>i;++i)this.sprites[i].visible=!0,this.sprites[i].setDigit(this.text[i]),this.sprites[i].position.x=t,t+=this.sprites[i].getDigitWidth();this.width=t,this.height=this.sprites[0].height},i}),define("absolute/eventbus",[],function(){var t={events:{},addEventListener:function(t,e){void 0===this.events[t]&&(this.events[t]=[]),this.events[t].push(e)},removeEventListener:function(t,e){var i=this.events[t];if(i)for(var n=0,o=i.length;o>n;++n)if(e===i[n])return void i.splice(n,1)},dispatchEvent:function(t){var e=this.events[t];if(e)for(var i in e){var n=e[i];"function"==typeof n&&n(t)}}};return t}),define("absolute/analytics",[],function(){var t={init:function(t){this.useFlurry=!1,"undefined"!=typeof FlurryAgent&&(FlurryAgent.startSession(t.flurry.apiKey),this.useFlurry=!0)},setGameVersion:function(t){this.useFlurry&&FlurryAgent.setAppVersion(t)},logEvent:function(t,e,i){e=e||{},i=!!i,this.useFlurry&&FlurryAgent.logEvent(t,e,i)},endTimedEvent:function(t){this.useFlurry&&FlurryAgent.endTimedEvent(t)}};return t}),define("absolute/game",["absolute/storagemanager","absolute/gameconfig","absolute/analytics","absolute/debug"],function(t,e,i,n){var o=function(t,e){this._initGame(t,e)};return o.prototype._initGame=function(n,o){t.prefix=n+"_",e.load(o),i.init(o.config.analytics),i.setGameVersion(o.versionString),this.ui=null,this.config=o.config,this.initVisibilityChangeHandlers()},o.prototype.start=function(){},o.prototype.initVisibilityChangeHandlers=function(){"hidden"in document?document.addEventListener("visibilitychange",function(){n.log("visibilitychange"),this.handleVisibilityChange(document.hidden)}.bind(this),!1):"mozHidden"in document?document.addEventListener("mozvisibilitychange",function(){n.log("mozvisibilitychange"),this.handleVisibilityChange(document.mozHidden)}.bind(this),!1):"webkitHidden"in document?document.addEventListener("webkitvisibilitychange",function(){n.log("webkitvisibilitychange"),this.handleVisibilityChange(document.webkitHidden)}.bind(this),!1):"msHidden"in document?document.addEventListener("msvisibilitychange",function(){n.log("msvisibilitychange"),this.handleVisibilityChange(document.msHidden)}.bind(this),!1):"onpagehide"in window&&(window.addEventListener("pagehide",function(){n.log("pagehide"),this.handleVisibilityChange(!0)}.bind(this),!1),window.addEventListener("pageshow",function(){n.log("pageshow"),this.handleVisibilityChange(!1)}.bind(this),!1)),"onblur"in document&&(window.addEventListener("blur",function(){n.log("blur"),this.handleVisibilityChange(!0)}.bind(this),!1),window.addEventListener("focus",function(){n.log("focus"),this.handleVisibilityChange(!1)}.bind(this),!1),visHandled=!0),"onfocusout"in document&&(window.addEventListener("focusout",function(){n.log("onfocusout"),this.handleVisibilityChange(!0)}.bind(this),!1),window.addEventListener("focusin",function(){n.log("onfocusin"),this.handleVisibilityChange(!1)}.bind(this),!1))},o.prototype.handleVisibilityChange=function(){},o.prototype.load=function(t,e,i){this.ui.load(t,e,i)},o}),void 0===Date.now&&(Date.now=function(){return(new Date).valueOf()});var TWEEN=TWEEN||function(){var t=[];return{REVISION:"12",getAll:function(){return t},removeAll:function(){t=[]},add:function(e){t.push(e)},remove:function(e){var i=t.indexOf(e);-1!==i&&t.splice(i,1)},update:function(e){if(0===t.length)return!1;var i=0;for(e=void 0!==e?e:"undefined"!=typeof window&&void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now();i<t.length;)t[i].update(e)?i++:t.splice(i,1);return!0}}}();TWEEN.Tween=function(t){var e=t,i={},n={},o={},r=1e3,s=0,a=!1,h=!1,l=!1,u=0,c=null,p=TWEEN.Easing.Linear.None,d=TWEEN.Interpolation.Linear,f=[],g=null,m=!1,y=null,v=null;for(var b in t)i[b]=parseFloat(t[b],10);this.to=function(t,e){return void 0!==e&&(r=e),n=t,this},this.start=function(t){TWEEN.add(this),h=!0,m=!1,c=void 0!==t?t:"undefined"!=typeof window&&void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now(),c+=u;for(var r in n){if(n[r]instanceof Array){if(0===n[r].length)continue;n[r]=[e[r]].concat(n[r])}i[r]=e[r],i[r]instanceof Array==!1&&(i[r]*=1),o[r]=i[r]||0}return this},this.stop=function(){return h?(TWEEN.remove(this),h=!1,this.stopChainedTweens(),this):this},this.stopChainedTweens=function(){for(var t=0,e=f.length;e>t;t++)f[t].stop()},this.delay=function(t){return u=t,this},this.repeat=function(t){return s=t,this},this.yoyo=function(t){return a=t,this},this.easing=function(t){return p=t,this},this.interpolation=function(t){return d=t,this},this.chain=function(){return f=arguments,this},this.onStart=function(t){return g=t,this},this.onUpdate=function(t){return y=t,this},this.onComplete=function(t){return v=t,this},this.update=function(t){var h;if(c>t)return!0;m===!1&&(null!==g&&g.call(e),m=!0);var b=(t-c)/r;b=b>1?1:b;var x=p(b);for(h in n){var w=i[h]||0,S=n[h];S instanceof Array?e[h]=d(S,x):("string"==typeof S&&(S=w+parseFloat(S,10)),"number"==typeof S&&(e[h]=w+(S-w)*x))}if(null!==y&&y.call(e,x),1==b){if(s>0){isFinite(s)&&s--;for(h in o){if("string"==typeof n[h]&&(o[h]=o[h]+parseFloat(n[h],10)),a){var C=o[h];o[h]=n[h],n[h]=C,l=!l}i[h]=o[h]}return c=t+u,!0}null!==v&&v.call(e);for(var T=0,_=f.length;_>T;T++)f[T].start(t);return!1}return!0}},TWEEN.Easing={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(-Math.pow(2,-10*(t-1))+2)}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){var e,i=.1,n=.4;return 0===t?0:1===t?1:(!i||1>i?(i=1,e=n/4):e=n*Math.asin(1/i)/(2*Math.PI),-(i*Math.pow(2,10*(t-=1))*Math.sin(2*(t-e)*Math.PI/n)))},Out:function(t){var e,i=.1,n=.4;return 0===t?0:1===t?1:(!i||1>i?(i=1,e=n/4):e=n*Math.asin(1/i)/(2*Math.PI),i*Math.pow(2,-10*t)*Math.sin(2*(t-e)*Math.PI/n)+1)},InOut:function(t){var e,i=.1,n=.4;return 0===t?0:1===t?1:(!i||1>i?(i=1,e=n/4):e=n*Math.asin(1/i)/(2*Math.PI),(t*=2)<1?-.5*i*Math.pow(2,10*(t-=1))*Math.sin(2*(t-e)*Math.PI/n):i*Math.pow(2,-10*(t-=1))*Math.sin(2*(t-e)*Math.PI/n)*.5+1)}},Back:{In:function(t){var e=1.70158;return t*t*((e+1)*t-e)},Out:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?.5*t*t*((e+1)*t-e):.5*((t-=2)*t*((e+1)*t+e)+2)}},Bounce:{In:function(t){return 1-TWEEN.Easing.Bounce.Out(1-t)},Out:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return.5>t?.5*TWEEN.Easing.Bounce.In(2*t):.5*TWEEN.Easing.Bounce.Out(2*t-1)+.5}}},TWEEN.Interpolation={Linear:function(t,e){var i=t.length-1,n=i*e,o=Math.floor(n),r=TWEEN.Interpolation.Utils.Linear;return 0>e?r(t[0],t[1],n):e>1?r(t[i],t[i-1],i-n):r(t[o],t[o+1>i?i:o+1],n-o)},Bezier:function(t,e){var i,n=0,o=t.length-1,r=Math.pow,s=TWEEN.Interpolation.Utils.Bernstein;for(i=0;o>=i;i++)n+=r(1-e,o-i)*r(e,i)*t[i]*s(o,i);return n},CatmullRom:function(t,e){var i=t.length-1,n=i*e,o=Math.floor(n),r=TWEEN.Interpolation.Utils.CatmullRom;return t[0]===t[i]?(0>e&&(o=Math.floor(n=i*(1+e))),r(t[(o-1+i)%i],t[o],t[(o+1)%i],t[(o+2)%i],n-o)):0>e?t[0]-(r(t[0],t[0],t[1],t[1],-n)-t[0]):e>1?t[i]-(r(t[i],t[i],t[i-1],t[i-1],n-i)-t[i]):r(t[o?o-1:0],t[o],t[o+1>i?i:o+1],t[o+2>i?i:o+2],n-o)},Utils:{Linear:function(t,e,i){return(e-t)*i+t},Bernstein:function(t,e){var i=TWEEN.Interpolation.Utils.Factorial;return i(t)/i(e)/i(t-e)},Factorial:function(){var t=[1];return function(e){var i,n=1;if(t[e])return t[e];for(i=e;i>1;i--)n*=i;return t[e]=n}}(),CatmullRom:function(t,e,i,n,o){var r=.5*(i-t),s=.5*(n-e),a=o*o,h=o*a;return(2*e-2*i+r+s)*h+(-3*e+3*i-2*r-s)*a+r*o+e}}},define("tween",function(t){return function(){var e;return e||t.TWEEN}}(this)),function(t,e){"use strict";function i(t){return document.createElement(t)}function n(t,e){for(var i in e)try{t.style[i]=e[i]}catch(n){}return t}function o(t){return null==t?String(t):"object"==typeof t||"function"==typeof t?Object.prototype.toString.call(t).match(/\s([a-z]+)/i)[1].toLowerCase()||"object":typeof t}function r(t,e){if("array"!==o(e))return-1;if(e.indexOf)return e.indexOf(t);for(var i=0,n=e.length;n>i;i++)if(e[i]===t)return i;return-1}function s(){var t=arguments;for(var e in t[1])if(t[1].hasOwnProperty(e))switch(o(t[1][e])){case"object":t[0][e]=s({},t[0][e],t[1][e]);break;case"array":t[0][e]=t[1][e].slice(0);break;default:t[0][e]=t[1][e]}return t.length>2?s.apply(null,[t[0]].concat(Array.prototype.slice.call(t,2))):t[0]}function a(t,e,i){var n,o,r,s,a,l,u,c,p;return s=.5>=i?i*(1+e):i+e-i*e,0===s?"#000":(a=2*i-s,l=(s-a)/s,t=6*t,u=Math.floor(t),c=t-u,p=s*l*c,0===u||6===u?(n=s,o=a+p,r=a):1===u?(n=s-p,o=s,r=a):2===u?(n=a,o=s,r=a+p):3===u?(n=a,o=s-p,r=s):4===u?(n=a+p,o=a,r=s):(n=s,o=a,r=s-p),"#"+h(n)+h(o)+h(r))}function h(t){return t=Math.round(255*t).toString(16),1===t.length?"0"+t:t}function l(t,e,i,n){t.addEventListener?t[n?"removeEventListener":"addEventListener"](e,i,!1):t.attachEvent&&t[n?"detachEvent":"attachEvent"]("on"+e,i)}function u(t,h){function y(){for(L=I.history;L--;)X[L]=0===L?D.fps:X[L-1],q[L]=0===L?D.duration:q[L-1]}function v(t,e,i,n){return A[0|t][Math.round(Math.min((e-i)/(n-i)*N,N))]}function b(){j.legend.fps!==z&&(j.legend.fps=z,j.legend[f]=z?"FPS":"ms"),R=z?D.fps:D.duration,j.count[f]=R>999?"999+":R.toFixed(R>99?0:I.decimals)}function x(){if(B=c(),V<B-I.threshold&&(D.fps-=D.fps/Math.max(1,60*I.smoothing/I.interval),D.duration=1e3/D.fps),y(),b(),I.heat){if(W.length)for(L=W.length;L--;)W[L].el.style[E[W[L].name].heatOn]=z?v(E[W[L].name].heatmap,D.fps,0,I.maxFps):v(E[W[L].name].heatmap,D.duration,I.threshold,0);if(j.graph&&E.column.heatOn)for(L=G.length;L--;)G[L].style[E.column.heatOn]=z?v(E.column.heatmap,X[L],0,I.maxFps):v(E.column.heatmap,q[L],I.threshold,0)}if(j.graph)for(F=0;F<I.history;F++)G[F].style.height=(z?X[F]?Math.round(P/I.maxFps*Math.min(X[F],I.maxFps)):0:q[F]?Math.round(P/I.threshold*Math.min(q[F],I.threshold)):0)+"px"}function w(){I.interval<20?(k=d(w),x()):(k=setTimeout(w,I.interval),O=d(x))}function S(t){t=t||window.event,t.preventDefault?(t.preventDefault(),t.stopPropagation()):(t.returnValue=!1,t.cancelBubble=!0),D.toggle()}function C(){I.toggleOn&&l(j.container,I.toggleOn,S,1),t.removeChild(j.container)}function T(){if(E=u.theme[I.theme],A=E.compiledHeatmaps||[],!A.length&&E.heatmaps.length){for(F=0;F<E.heatmaps.length;F++)for(A[F]=[],L=0;N>=L;L++)A[F][L]=a(.33/N*L,E.heatmaps[F].saturation,E.heatmaps[F].lightness);E.compiledHeatmaps=A}}function _(){j.container&&C(),T(),j.container=n(i("div"),E.container),j.count=j.container.appendChild(n(i("div"),E.count)),j.legend=j.container.appendChild(n(i("div"),E.legend)),j.graph=I.graph?j.container.appendChild(n(i("div"),E.graph)):0,W.length=0;for(var e in j)j[e]&&E[e].heatOn&&W.push({name:e,el:j[e]});if(G.length=0,j.graph)for(j.graph.style.width=I.history*E.column.width+(I.history-1)*E.column.spacing+"px",L=0;L<I.history;L++)G[L]=j.graph.appendChild(n(i("div"),E.column)),G[L].style.position="absolute",G[L].style.bottom=0,G[L].style.right=L*E.column.width+L*E.column.spacing+"px",G[L].style.width=E.column.width+"px",G[L].style.height="0px";M(),b(),t.appendChild(j.container),j.graph&&(P=j.graph.clientHeight),I.toggleOn&&("click"===I.toggleOn&&(j.container.style.cursor="pointer"),l(j.container,I.toggleOn,S))}function M(){n(j.container,I)}"object"===o(t)&&t.nodeType===e&&(h=t,t=document.body),t||(t=document.body);var E,A,B,k,O,P,R,L,F,D=this,I=s({},u.defaults,h||{}),j={},G=[],N=100,W=[],H=0,U=I.threshold,Y=0,V=c()-U,X=[],q=[],z="fps"===I.show;D.options=I,D.fps=0,D.duration=0,D.isPaused=0,D.tickStart=function(){Y=c()},D.tick=function(){B=c(),H=B-V,U+=(H-U)/I.smoothing,D.fps=1e3/U,D.duration=V>Y?U:B-Y,V=B},D.pause=function(){return k&&(D.isPaused=1,clearTimeout(k),p(k),p(O),k=O=0),D},D.resume=function(){return k||(D.isPaused=0,w()),D},D.set=function(t,e){return I[t]=e,z="fps"===I.show,-1!==r(t,g)&&_(),-1!==r(t,m)&&M(),D},D.showDuration=function(){return D.set("show","ms"),D},D.showFps=function(){return D.set("show","fps"),D},D.toggle=function(){return D.set("show",z?"ms":"fps"),D},D.hide=function(){return D.pause(),j.container.style.display="none",D},D.show=function(){return D.resume(),j.container.style.display="block",D},D.destroy=function(){D.pause(),C(),D.tick=D.tickStart=function(){}},function(){_(),w()}()}var c;!function(){var e=t.performance;if(e&&(e.now||e.webkitNow)){var i=e.now?"now":"webkitNow";c=e[i].bind(e)}else c=function(){return+new Date}}();var p=t.cancelAnimationFrame||t.cancelRequestAnimationFrame,d=t.requestAnimationFrame;!function(){for(var e=["moz","webkit","o"],i=0,n=0,o=e.length;o>n&&!p;++n)p=t[e[n]+"CancelAnimationFrame"]||t[e[n]+"CancelRequestAnimationFrame"],d=p&&t[e[n]+"RequestAnimationFrame"];p||(d=function(e){var n=c(),o=Math.max(0,16-(n-i));return i=n+o,t.setTimeout(function(){e(n+o)},o)},p=function(t){clearTimeout(t)})}();var f="string"===o(document.createElement("div").textContent)?"textContent":"innerText";u.extend=s,window.FPSMeter=u,u.defaults={interval:100,smoothing:10,show:"fps",toggleOn:"click",decimals:1,maxFps:60,threshold:100,position:"absolute",zIndex:10,left:"5px",top:"5px",right:"auto",bottom:"auto",margin:"0 0 0 0",theme:"dark",heat:0,graph:0,history:20};var g=["toggleOn","theme","heat","graph","history"],m=["position","zIndex","left","top","right","bottom","margin"]}(window),function(t,e){"use strict";e.theme={};var i=e.theme.base={heatmaps:[],container:{heatOn:null,heatmap:null,padding:"5px",minWidth:"95px",height:"30px",lineHeight:"30px",textAlign:"right",textShadow:"none"},count:{heatOn:null,heatmap:null,position:"absolute",top:0,right:0,padding:"5px 10px",height:"30px",fontSize:"24px",fontFamily:"Consolas, Andale Mono, monospace",zIndex:2},legend:{heatOn:null,heatmap:null,position:"absolute",top:0,left:0,padding:"5px 10px",height:"30px",fontSize:"12px",lineHeight:"32px",fontFamily:"sans-serif",textAlign:"left",zIndex:2},graph:{heatOn:null,heatmap:null,position:"relative",boxSizing:"padding-box",MozBoxSizing:"padding-box",height:"100%",zIndex:1},column:{width:4,spacing:1,heatOn:null,heatmap:null}};e.theme.dark=e.extend({},i,{heatmaps:[{saturation:.8,lightness:.8}],container:{background:"#222",color:"#fff",border:"1px solid #1a1a1a",textShadow:"1px 1px 0 #222"},count:{heatOn:"color"},column:{background:"#3f3f3f"}}),e.theme.light=e.extend({},i,{heatmaps:[{saturation:.5,lightness:.5}],container:{color:"#666",background:"#fff",textShadow:"1px 1px 0 rgba(255,255,255,.5), -1px -1px 0 rgba(255,255,255,.5)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},count:{heatOn:"color"},column:{background:"#eaeaea"}}),e.theme.colorful=e.extend({},i,{heatmaps:[{saturation:.5,lightness:.6}],container:{heatOn:"backgroundColor",background:"#888",color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.2)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},column:{background:"#777",backgroundColor:"rgba(0,0,0,.2)"}}),e.theme.transparent=e.extend({},i,{heatmaps:[{saturation:.8,lightness:.5}],container:{padding:0,color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.5)"},count:{padding:"0 5px",height:"40px",lineHeight:"40px"},legend:{padding:"0 5px",height:"40px",lineHeight:"42px"},graph:{height:"40px"},column:{width:5,background:"#999",heatOn:"backgroundColor",opacity:.5}})}(window,FPSMeter),define("fpsmeter",function(t){return function(){var e;return e||t.FPSMeter}}(this)),define("absolute/gameui",["pixi","tween","absolute/debug","absolute/screenmetrics","absolute/platform","absolute/coords","fpsmeter"],function(t,e,i,n,o,r,s){var a=function(t,e,i,n,o,r,s){n=n||16777215,this._initGameUI(t,e,i,n,o,r,s)};return a.prototype._initGameUI=function(e,n,r,a,h,l,u){this.currentScreen=null,this.modal=null,this.lastRender=0,this.frameRequest=0,this.width=Math.round(n),this.height=Math.round(r),this.baseWidth=n,this.baseHeight=r,this.origWidth=this.width,this.origHeight=this.height,this.origBaseWidth=this.baseWidth,this.origBaseHeight=this.baseHeight,this.container=document.getElementById(e),this.stage=[],this.refreshBackground=!1,this.backGroundColor=a,this.supportsOrientationChange=!!h,this.supportsLiquidLayout=!!l,this.supportsWebGL=!!u&&o.supportsWebGL(),this.usingWebGL=!1,this.DIALOG_LAYER=0,this.modalStack=[],this.modalBgStack=[],this.stage.push(new t.Stage(0,!0)),this.stage.push(new t.Stage(0,!0)),this.stage.push(new t.Stage(0,!0)),i.enabled&&(this.meter=new s),"undefined"!=typeof kik&&document.getElementsByTagName("body")[0].appendChild(document.createElement("div")),this.container.onmousedown=this.container.ontouchstart=function(t){t.preventDefault()},this.renderer=[],window.addEventListener("resize",this.resize.bind(this)),this.resize()},a.prototype.buildRenderers=function(e,i){if(o._isOldAndroid()&&(e=this.baseWidth,i=this.baseHeight),0===this.renderer.length)this.supportsWebGL?(this.renderer.push(t.autoDetectRenderer(e,i,null,!0)),this.renderer.push(t.autoDetectRenderer(e,i,null,!0)),this.renderer[1]instanceof t.WebGLRenderer&&(this.renderer.push(t.autoDetectRenderer(e,i,null,!0)),this.usingWebGL=!0,this.DIALOG_LAYER=2)):(this.renderer.push(new t.CanvasRenderer(e,i,null,!0)),this.renderer.push(new t.CanvasRenderer(e,i,null,!0))),this.offScreenRenderer=new t.CanvasRenderer(e,i,null,!0),this.container.appendChild(this.renderer[1].view),this.container.appendChild(this.renderer[0].view),this.usingWebGL&&(this.renderer[2].view.style.display="none",this.container.appendChild(this.renderer[2].view));else{for(var n=0;n<this.renderer.size;n+=1)this.usingWebGL?this.renderer[n].resize(e,i):(this.renderer[n].width=this.renderer[n].view.width=e,this.renderer[n].height=this.renderer[n].view.height=i);this.refreshBackground=!0}},a.prototype.resize=function(){var t,e=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement;if(""===this.container.style.width||""===this.container.style.height||e){n.refresh();var i=n.clientWidth>0?n.clientWidth:n.screenWidth,s=n.clientWidth>0?n.clientHeight:n.screenHeight,a=i,h=s;this.portrait=this.supportsOrientationChange?h>a:this.width<this.height;var l=i/s;for(this.supportsLiquidLayout?this.supportsLiquidLayout&&(this.portrait?(this.width=Math.floor(1536*n.getResScale()),this.height=Math.floor(this.width*(s/i))):(o._isiPad&&(s-=r.y(18),h-=r.y(18)),this.height=Math.floor(1536*n.getResScale()),this.width=Math.floor(Math.floor(this.height*(i/s))))):(this.portrait?(this.supportsOrientationChange&&this.width>this.height&&(this.baseWidth=this.origBaseHeight,this.baseHeight=this.origBaseWidth,this.width=this.origHeight,this.height=this.origWidth),l>.85?a=.85*s:.56>l&&(h=i/.56)):(o._isiPad&&(h-=r.y(18)),this.supportsOrientationChange&&this.height>this.width&&(this.baseWidth=this.origBaseWidth,this.baseHeight=this.origBaseHeight,this.width=this.origWidth,this.height=this.origHeight),l=1/l,l>.8?h=.8*i:.56>l&&(a=s/.56)),a=Math.floor(a),h=Math.floor(h)),this.buildRenderers(this.width,this.height),this.clientWidth=a,t=0;t<this.renderer.length;t+=1)this.renderer[t].view.style.width=a+"px",this.renderer[t].view.style.height=h+"px",this.renderer[t].view.style.position="absolute",this.renderer[t].view.style.left=i>a?Math.round((i-a)/2)+"px":"0",this.renderer[t].view.style.top=s>h?Math.round((s-h)/2)+"px":"0";this.resetStage(),this.supportsOrientationChange&&this.currentScreen&&this.currentScreen.handleOrientationChange(this.portrait),this.refreshModal()}else for(this.buildRenderers(this.width,this.height),t=0;t<this.renderer.length;t+=1)this.renderer[t].view.style.width=this.container.style.width,this.renderer[t].view.style.height=this.container.style.height,this.renderer[t].view.style.position="absolute",this.renderer[t].view.style.left="",this.renderer[t].view.style.top=""},a.prototype.refreshModal=function(){if(this.supportsOrientationChange&&this.modalStack.length>0){var t=this.modalStack[this.modalStack.length-1];this.stage[this.DIALOG_LAYER].removeChild(t),"undefined"!=typeof t.handleOrientationChange&&t.handleOrientationChange(this.portrait),this.stage[this.DIALOG_LAYER].addChild(t),t.onShow()}},a.prototype.render=function(){this.renderer[0].render(this.stage[0])},a.prototype.renderOffScreen=function(){this.offScreenRenderer.render(this.stage[0])},a.prototype.animate=function(){var t=function(){Date.now()-this.lastRender>200&&(cancelAnimationFrame(this.frameRequest),this.frameRequest=requestAnimFrame(this._animate.bind(this))),setTimeout(t,100)}.bind(this);this.frameRequest&&cancelAnimationFrame(this.frameRequest),this.frameRequest=requestAnimFrame(this._animate.bind(this)),setTimeout(t,100)},a.prototype._animate=function(){i.enabled&&this.meter.tick(),this.beforeRender(),e.update(),this.renderer[0].render(this.stage[0]),this.refreshBackground&&(this.refreshBackground=!1,this.renderer[1].render(this.stage[1])),this.hasModal()&&this.renderer.length>2&&this.renderer[2].render(this.stage[2]),this.afterRender(),this.lastRender=Date.now(),this.frameRequest=requestAnimFrame(this._animate.bind(this))},a.prototype.beforeRender=function(){},a.prototype.afterRender=function(){},a.prototype.showScreen=function(t){this.currentScreen&&this.currentScreen.onHide(),this.currentScreen=t,this.hideCurrent(),this.showCurrent(),this.currentScreen.onShow(this.portrait),this.showActiveAtlases()},a.prototype.showModal=function(t,e){e=e||.5,0===this.modalStack.length?this.usingWebGL?(this.modalOverlay=this.buildModalOverlay(e),this.stage[0].addChildAt(this.modalOverlay,this.stage[0].children.indexOf(this.currentScreen)+1),this.renderer[2].view.style.display="block"):(this.modalBG=this.buildModalBackground(e),this.stage[0].removeChild(this.currentScreen),this.stage[0].addChildAt(this.modalBG,0)):this.stage[this.DIALOG_LAYER].removeChild(this.modalStack[this.modalStack.length-1]),this.modalStack.push(t),this.stage[this.DIALOG_LAYER].addChild(t),t.onShow(),this.showActiveAtlases()},a.prototype.hasModal=function(){return this.modalStack.length>0},a.prototype.hideModal=function(){if(this.modalStack.length>0){var t=this.modalStack.pop();t.onHide(),this.stage[this.DIALOG_LAYER].removeChild(t);var e=this.modalStack.length;0===e?this.usingWebGL?(this.stage[0].removeChild(this.modalOverlay),this.renderer[2].view.style.display="none"):(this.stage[0].removeChild(this.modalBG),this.stage[0].addChildAt(this.currentScreen,0)):(this.stage[this.DIALOG_LAYER].addChild(this.modalStack[e-1]),this.refreshModal())}},a.prototype.hideCurrent=function(){if(this.stage[0].children.length>0){var t=this.stage[0].getChildAt(0);this.stage[0].removeChild(t)}if(this.stage[1].children.length>0){var e=this.stage[1].getChildAt(0);this.stage[1].removeChild(e)}},a.prototype.buildModalOverlay=function(e){var i=new t.DisplayObjectContainer,n=new t.Graphics;return n.beginFill(65793,e),n.drawRect(0,0,this.width,this.height),n.endFill(),i.addChild(n),i},a.prototype.buildModalBackground=function(e){var i,n=.5,o=Math.ceil(this.width*n),r=Math.ceil(this.height*n),s=new t.CanvasRenderer(o,r,null,!0),a=new t.Graphics;return s.clearBeforeRender=!1,s.roundPixels=!0,a.beginFill(0,e),a.drawRect(0,0,o,r),a.endFill(),this.stage[0].addChild(a),this.currentScreen.scale.x=this.currentScreen.scale.y=n,s.render(this.stage[0]),this.currentScreen.scale.x=this.currentScreen.scale.y=1,this.stage[0].removeChild(a),i=new t.Sprite(t.Texture.fromCanvas(s.view)),i.scale.x=i.scale.y=1/n,i},a.prototype.showCurrent=function(){if(this.currentScreen)try{this.stage[0].addChildAt(this.currentScreen,0),this.stage[1].addChildAt(this.currentScreen.background,0),this.renderer[1].render(this.stage[1]),this.refreshBackground=!0}catch(t){}},a.prototype.resetStage=function(){if(0==this.stage[1].children.length)return!1;for(var e=0;e<this.stage[1].children.length;e++)this.stage[1].removeChildAt(e);if(this.stage[0].children.length>0){var i=this.stage[0].getChildAt(0);i.visible=!1}this.modal&&(this.modal.visible=!1);var n=new t.Graphics;n.beginFill(this.backGroundColor,1),n.drawRect(0,0,this.width,this.height),n.endFill(),this.stage[1].addChildAt(n,0),this.renderer[1].render(this.stage[1]),window.setTimeout(function(){if(this.stage[1].removeChildAt(0),this.stage[0].children.length>0){var t=this.stage[0].getChildAt(0);
t.visible=!0}this.modal&&(this.modal.visible=!0),this.currentScreen&&this.currentScreen.background&&(this.stage[1].addChild(this.currentScreen.background),this.renderer[1].render(this.stage[1]))}.bind(this),500)},a.prototype.showActiveAtlases=function(){var e={};if(this.walkSprites(this.stage[0],function(i){if(i instanceof t.Sprite&&i.texture&&i.texture.baseTexture){var n=i.texture.baseTexture.source.src||"/offscreen";e[n]=(e[n]||0)+1}}),i.enabled){i.log("Active Atlases");for(var n in e)if(e.hasOwnProperty(n)){var o=n.substr(n.lastIndexOf("/")+1);i.log(o+" has "+e[n]+" sprites active")}}},a.prototype.walkSprites=function(t,e){e(t);for(var i=0;i<t.children.length;i+=1)this.walkSprites(t.children[i],e)},a}),define("absolute/textutils",[],function(){var t={_thousandsSep:",",formatInt:function(t){return t>999?this.formatInt(Math.floor(t/1e3))+this._thousandsSep+this.zeroPad(t%1e3):t+""},zeroPad:function(t){var e="";return 100>t&&(e+="0"),10>t&&(e+="0"),e+=t}};return t}),define("absolute/togglebutton",["pixi","absolute/button"],function(t,e){var i=function(t,e,i,n){this.initToggleButton(t,e,i,n)};return i.constructor=i,i.prototype=Object.create(t.DisplayObjectContainer.prototype),i.prototype.initToggleButton=function(i,n,o,r){this.enabled=!!o,this.action=n,r="undefined"!=typeof r?r:!0;var s=r?"button_overlay.png":i+"_1.png",a=r?"button_overlay.png":i+"OFF_1.png";t.DisplayObjectContainer.call(this),this.enabledButton=new e(t.Texture.fromFrame(i+"_1.png"),t.Texture.fromFrame(s),this.onAction.bind(this)),this.disabledButton=new e(t.Texture.fromFrame(i+"OFF_1.png"),t.Texture.fromFrame(a),this.onAction.bind(this)),this.addChild(this.enabled?this.enabledButton:this.disabledButton),this.width=t.Texture.fromFrame(i+"_1.png").width,this.height=t.Texture.fromFrame(i+"_1.png").height},i.prototype.onAction=function(){this.setEnabled(!this.enabled),this.action&&this.action()},i.prototype.setEnabled=function(t){t!==this.enabled&&(this.enabled=t,this.enabled?(this.removeChild(this.disabledButton),this.addChild(this.enabledButton)):(this.removeChild(this.enabledButton),this.addChild(this.disabledButton)))},i}),define("absolute/musicmanager",["absolute/gameconfig","absolute/audiomanager"],function(t,e){var i={currentTrack:null,isMuted:function(){return!t.getVal("musicEnabled")},playMusic:function(t){t!==this.currentTrack&&(this.currentTrack&&e.stopSound(this.currentTrack),this.currentTrack=t,this.isMuted()?e.muteSound(this.currentTrack):e.unmuteSound(this.currentTrack),(e.simulSoundSupport()||!e.isSfxEnabled())&&e.playSound(this.currentTrack))},stopMusic:function(){e.stopSound(this.currentTrack),this.currentTrack=null},setMuted:function(i,n){var o=!!n;if(!o){if(i===this.isMuted())return;t.setVal("musicEnabled",!i)}this.currentTrack&&(i?e.muteSound(this.currentTrack):e.unmuteSound(this.currentTrack))}};return i}),define("absolute/tweenutils",["tween"],function(t){var e={fadeIn:function(t,i,n){this._doTween(t,i,n,e._fadeIn)},_fadeIn:function(e,i,n){"undefined"==typeof i.delay&&(i.delay=0),new t.Tween({alpha:e.alpha}).delay(i.delay).to({alpha:1},i.duration).easing(t.Easing.Cubic.In).onUpdate(function(){e.alpha=this.alpha}).onComplete(function(){n()}).start()},fadeOut:function(t,i,n){this._doTween(t,i,n,e._fadeOut)},_fadeOut:function(e,i,n){"undefined"==typeof i.delay&&(i.delay=0),new t.Tween({alpha:e.alpha}).delay(i.delay).to({alpha:0},i.duration).easing(t.Easing.Cubic.In).onUpdate(function(){e.alpha=this.alpha}).onComplete(function(){n()}).start()},bounceIn:function(t,i,n){this._doTween(t,i,n,e._bounceIn)},_bounceIn:function(e,i,n){void 0===i.endScale&&(i.endScale=1),new t.Tween({scale:e.scale.x}).to({scale:i.endScale},i.duration).easing(t.Easing.Elastic.Out).onUpdate(function(){e.scale.x=e.scale.y=this.scale}).onComplete(function(){n()}).start()},_doTween:function(t,e,i,n){var o,r,s=0,a=function(){s+=1,s===r&&i&&"function"==typeof i&&i()};if(t instanceof Array)for(r=t.length,o=0;r>o;o+=1)n(t[o],e,a);else n(t,e,function(){i&&"function"==typeof i&&i()})}};return e}),define("absolute/progressbar",["pixi","absolute/coords","absolute/tweenutils"],function(t,e){var i=function(t,e,i,n,o){this._initProgressBar(t,e,i,n,o)};return i.constructor=i,i.prototype=Object.create(t.Sprite.prototype),i.prototype._initProgressBar=function(e,i,n,o){t.Sprite.call(this,e),this.fillSprite=new t.Sprite(i),this.previousWidth=0,this.start=n?n:0,this.end=o?o:this.fillSprite.texture.frame.width,this.fillMask=new t.Graphics,this.fillMask.beginFill(0,0),this.fillMask.drawRect(this.start,0,0,this.height),this.fillMask.endFill(),this.addChild(this.fillMask),this.fillSprite.mask=this.fillMask,this.addChild(this.fillSprite)},i.prototype.setProgress=function(t,e,i,n){0>t?t=0:t>1&&(t=1),n=n||500;var o=(this.end-this.start)*t;if(e){var r=this;new TWEEN.Tween({width:this.previousWidth}).to({width:o},n).easing(TWEEN.Easing.Quadratic.Out).onUpdate(function(){r.fillMask.clear(),r.fillMask.beginFill(0,0),r.fillMask.drawRect(r.start,0,this.width,r.height),r.fillMask.endFill(),r.previousWidth=this.width}).onComplete(function(){"function"==typeof i&&i()}).start()}else this.fillMask.clear(),this.fillMask.beginFill(0,0),this.fillMask.drawRect(this.start,0,o,this.height),this.fillMask.endFill();this.waitContainer&&(this.waitContainer.mask=null,this.removeChild(this.waitContainer),this.waitContainer=null)},i.prototype.showWaiting=function(i){if(this.waitImage=i,this.waitImage){this.setProgress(100),this.waitContainer=new t.DisplayObjectContainer,this.waitSprites=[];for(var n=0;11>n;n+=1)this.waitSprites.push(new t.Sprite(this.waitImage)),this.waitSprites[n].position.x=n*this.waitSprites[n].width,this.waitContainer.addChild(this.waitSprites[n]);this.addChild(this.waitContainer);var o=new t.Graphics;o.beginFill(),o.drawRect(e.x(50),0,this.width-e.x(100),this.height),o.endFill(),this.waitContainer.addChild(o),this.waitContainer.mask=o}},i.prototype.updateWaiting=function(){for(var t=0;11>t;t+=1)this.waitSprites[t].position.x+=e.x(4);this.waitSprites[10].position.x>this.width&&(this.waitSprites[10].position.x=this.waitSprites[0].position.x-this.waitSprites[10].width,this.waitSprites.unshift(this.waitSprites.pop()))},i}),define("absolute/progressdial",["pixi"],function(t){var e=function(t,e){this._initProgressDial(t,e)};return e.constructor=e,e.prototype=Object.create(t.Sprite.prototype),e.prototype._initProgressDial=function(e,i){t.Sprite.call(this,e),this.fillSprite=new t.Sprite(i),this.previousRotation=-180*Math.PI/180,this.fillMask=new t.Graphics,this.fillMask.beginFill(0,0),this.fillMask.drawRect(1.1*-this.fillSprite.width/2,1.1*-this.fillSprite.height,1.1*this.fillSprite.width,1.1*this.fillSprite.height),this.fillMask.position.x=this.fillSprite.width/2,this.fillMask.position.y=this.fillSprite.height,this.fillMask.endFill(),this.addChild(this.fillMask),this.fillSprite.mask=this.fillMask,this.addChild(this.fillSprite)},e.prototype.setProgress=function(t,e,i){0>t?t=0:t>1&&(t=1);var n=(-180+180*t)*Math.PI/180;if(e){var o=this;new TWEEN.Tween({rotation:this.previousRotation}).to({rotation:n},500).easing(TWEEN.Easing.Quadratic.Out).onUpdate(function(){o.fillMask.rotation=this.rotation,o.previousRotation=this.rotation}).onComplete(function(){"function"==typeof i&&i()}).start()}else this.fillMask.rotation=n},e}),define("absolute/screen",["pixi","absolute/button","absolute/togglebutton","absolute/debug"],function(t,e,i,n){var o=function(){this._initScreen()};return o.constructor=o,o.prototype=Object.create(t.DisplayObjectContainer.prototype),o.prototype._initScreen=function(){t.DisplayObjectContainer.call(this),this.background=new t.DisplayObjectContainer},o.prototype.addButton=function(i,o,r,s,a){var h,l=!!a,u=t.Texture.fromFrame(i+"_1.png");h=t.Texture.fromFrame(l?"button_small_overlay.png":"button_overlay.png");var c=new e(u,h,function(){n.log(i+" pressed!"),s()});return c.position.x=o,c.position.y=r,this.addChild(c),c},o.prototype.addToggleButton=function(t,e,o,r,s){var a=new i(t,function(){n.log(t+" pressed!"),r()},s);return a.position.x=e,a.position.y=o,this.addChild(a),a},o.prototype.onShow=function(){},o.prototype.onHide=function(){},o.prototype.beforeRender=function(){},o.prototype.afterRender=function(){},o.prototype.handleVisibilityChange=function(){},o.prototype.handleOrientationChange=function(){},o}),define("absolute/simplemessagebox",["pixi","absolute/button","absolute/coords"],function(t,e,i){var n=function(t,e,i){this._initSimpleMessageBox(t,e,i)};return n.constructor=n,n.prototype=Object.create(t.DisplayObjectContainer.prototype),n.prototype._initSimpleMessageBox=function(e,i,n){t.DisplayObjectContainer.call(this),this.width=e,this.height=i,this.textStyle=n,this.textStyle.wordWrapWidth=e-60,this.textStyle.wordWrap=!0;var o=new t.Graphics;o.lineStyle(8,0,1),o.beginFill(16777215,1),o.drawRect(0,0,e,i),o.endFill(),this.addChild(o),this.text=null},n.prototype.setText=function(e){this.text&&this.removeChild(this.text),this.text=new t.Text(e,this.textStyle),this.text.position.x=(this.width-this.text.width)/2,this.text.position.y=i.y(30),this.addChild(this.text)},n}),define("absolute/spritemessagebox",["pixi","absolute/button","absolute/coords"],function(t,e,i){var n=function(t,e,i){this._initSpriteMessageBox(t,e,i)};return n.constructor=n,n.prototype=Object.create(t.Sprite.prototype),n.prototype._initSpriteMessageBox=function(i,n,o){t.Sprite.call(this,t.Texture.fromFrame(i)),this.action=null,this.buttonText=null,this.button=new e(t.Texture.fromFrame(n),t.Texture.fromFrame(n),function(){this.action&&"function"==typeof this.action&&this.action()}.bind(this)),this.button.position.x=(this.width-this.button.width)/2,this.button.position.y=this.height-this.button.height/2,this.addChild(this.button),this.textStyle=o,this.textStyle.wordWrapWidth=this.width-40,this.text=null},n.prototype.setText=function(e){this.text&&this.removeChild(this.text),this.text=new t.Text(e,this.textStyle),this.text.position.x=(this.width-this.text.width)/2,this.text.position.y=i.y(30),this.addChild(this.text)},n.prototype.setButtonTextAndAction=function(e,i){this.button&&(this.buttonText&&this.button.removeChild(this.buttonText),this.buttonText=new t.Text(e,this.textStyle),this.buttonText.position.x=(this.button.width-this.buttonText.width)/2,this.buttonText.position.y=this.button.height/4,this.button.addChild(this.buttonText),this.action=i)},n}),define("absolute/loader",["pixi","absolute/platform","absolute/audiomanager","absolute/asyncqueue","absolute/screenmetrics"],function(t,e,i,n,o){"use strict";var r=function(){this._initLoader()};return r.prototype._initLoader=function(){},r.prototype.loadSound=function(t,e,n){i.init(function(){i.loadSounds(t,e,n)})},r.prototype.loadArt=function(i,n,r){for(var s=i.length,a=[],h=0;s>h;++h){var l=i[h],u="image",c="undefined"!=typeof l.lazyload?l.lazyload:!1;c||("string"!=typeof l&&(l.type&&(u=l.type),l=l.name),"image"===u?-1===l.indexOf(".json")&&(l+=".json"):"font"===u&&-1===l.indexOf(".fnt")&&(l+=".fnt"),a.push(e.artPathPrefix+"/"+o.getResClass()+"/"+l))}this.assetLoader=new t.AssetLoader(a),this.assetLoader.addEventListener("onComplete",function(){r()}),this.assetLoader.addEventListener("onProgress",function(t){n(1-t.content.loadCount/s)}),this.assetLoader.load()},r.prototype.loadAssets=function(t,e,i){var o=new n;o.pushTasks([function(e,i){this.loadArt(t.artAssets,e,i)}.bind(this),function(e,i){this.loadSound(t.audioAssets,e,i)}.bind(this)]),o.run(e,i)},r}),define("absolute/layouthelper",["absolute/coords"],function(t){var e=null;return{setLayoutMap:function(t){e=t},layout:function(i,n,o){if("undefined"!=typeof e[n]&&"undefined"!=typeof e[n][o]){var r=e[n][o].x||0,s=e[n][o].y||0;i.position.x=t.x(r),i.position.y=t.y(s)}}}}),define("absolute/draggable",["pixi","absolute/platform"],function(t,e){var i=function(t,e,i,n,o,r){this._initDraggable(t,e,i,n,o,r)};return i.constructor=i,i.prototype=Object.create(t.DisplayObjectContainer.prototype),i.prototype._initDraggable=function(i,n,o,r,s,a){t.DisplayObjectContainer.call(this),this.addChild(i),this.child=i,this.positionChild="undefined"!=typeof a?a:!1,this.limit=n||new t.Rectangle(0,0,0,0),this.onGrab=o,this.onMove=r,this.onDrop=s,this.interactive=!0,this.data=null,this.dragging=!1,e.supportsTouch()?(this.touchstart=this._onGrab,this.touchend=this.touchendoutside=this._onDrop,this.touchmove=this._onMove):(this.mousedown=this._onGrab,this.mouseup=this.mouseupoutside=this._onDrop,this.mousemove=this._onMove)},i.prototype._onGrab=function(t){t.originalEvent.preventDefault(),this.data=t,this.alpha=.8,this.dragging=!0,"function"==typeof this.onGrab&&this.onGrab(this)},i.prototype._onDrop=function(t){t.originalEvent.preventDefault(),this.alpha=1,this.dragging=!1,this.data=null,"function"==typeof this.onDrop&&this.onDrop(this)},i.prototype._onMove=function(t){if(t.originalEvent.preventDefault(),this.dragging){var e=this.data.getLocalPosition(this.parent);if(this.limit&&e.x>this.limit.x&&e.x<this.limit.x+this.limit.width&&e.y>this.limit.y&&e.y<this.limit.y+this.limit.height){var i=this.positionChild?this.child:this;i.position.x=Math.round(e.x),i.position.y=Math.round(e.y)}"function"==typeof this.onMove&&this.onMove(this)}},i}),define("text!absolute/ui/assetmap.json",[],function(){return'{\n    "loading_bar_frame": "loading_bar_frame.png",\n    "loading_bar_marker": "loading_bar_marker.png",\n    \n    "dialogNineSlice": {\n        "topLeft":"MDS_9slice_modal_01.png",\n        "topCenter":"MDS_9slice_modal_02.png",\n        "topRight":"MDS_9slice_modal_03.png",\n        "topRight_closeBackground":"MDS_9slice_modal_03.png",\n        "middleLeft":"MDS_9slice_modal_04.png",\n        "middleCenter":"MDS_9slice_modal_05.png",\n        "middleRight":"MDS_9slice_modal_06.png",\n        "bottomLeft":"MDS_9slice_modal_07.png",\n        "bottomCenter":"MDS_9slice_modal_08.png",\n        "bottomRight":"MDS_9slice_modal_09.png",\n        "close": "btn_level_exit.png"\n    }\n}'}),define("absolute/assetmap",["lodash","text!absolute/ui/assetmap.json"],function(t,e){function i(t){for(var e=0,i=t.split("."),o=n;o&&"object"==typeof o;)o=o[i[e++]];return o}var n=JSON.parse(e),o=function(t){return i(t)||t};return o.load=function(e){var i=JSON.parse(e);t.merge(n,i)},o}),define("text!absolute/ui/strings.json",[],function(){return"{\n\n}"}),define("absolute/stringmanager",["lodash","text!absolute/ui/strings.json"],function(t,e){function i(t,e){for(var i=0,o=t.split("."),r=n[e];r&&"object"==typeof r;)r=r[o[i++]];return r}var n=JSON.parse(e),o="en",r=function(t,e){var n=i(t,o)||i(t,"en");if(n&&"string"==typeof n&&""!==n&&e&&e.length>0)for(var r=0;r<e.length;r+=1)n=n.replace("%"+r,String(e[r]));return n||t};return r.setLocale=function(t){o=t},r.load=function(e){var i=JSON.parse(e);t.merge(n,i)},r}),define("absolute/nineslice",["pixi","absolute/screen","absolute/debug","lodash"],function(t,e,i,n){var o=function(t){var e={width:"100",height:"100",images:{topLeft:"MDS_9slice_modal_01.png",topCenter:"MDS_9slice_modal_02.png",topRight:"MDS_9slice_modal_03.png",middleLeft:"MDS_9slice_modal_04.png",middleCenter:"MDS_9slice_modal_05.png",middleRight:"MDS_9slice_modal_06.png",bottomLeft:"MDS_9slice_modal_07.png",bottomCenter:"MDS_9slice_modal_08.png",bottomRight:"MDS_9slice_modal_09.png"}};this._initNineSlice(n.extend(e,t))};return o.prototype=Object.create(t.DisplayObjectContainer.prototype),o.prototype._initNineSlice=function(e){t.DisplayObjectContainer.call(this),this.options=e,this.cachedContent=this.options.content,this._setSize(),this._createBackground()},o.prototype._setSize=function(){this.width=this.options.width,this.height=this.options.height},o.prototype._createBackground=function(){this.container=new t.DisplayObjectContainer;var e=t.Sprite.fromFrame(this.options.images.topLeft);e.position.x=0,e.position.y=0;var i=t.Sprite.fromFrame(this.options.images.topRight);i.position.x=this.width-i.width,i.position.y=0;var n=t.Sprite.fromFrame(this.options.images.bottomLeft);n.position.x=0,n.position.y=this.height-n.height;var o=t.Sprite.fromFrame(this.options.images.bottomRight);o.position.x=this.width-o.width,o.position.y=this.height-o.height;var r=t.Texture.fromFrame(this.options.images.middleLeft),s=new t.TilingSprite(r,r.width,this.height-e.height-n.height);s.position.x=0,s.position.y=e.height;var a=t.Texture.fromFrame(this.options.images.middleRight),h=new t.TilingSprite(a,a.width,this.height-e.height-n.height);h.position.x=this.width-i.width,h.position.y=i.height;var l=t.Texture.fromFrame(this.options.images.topCenter),u=new t.TilingSprite(l,this.width-e.width-i.width,l.height);u.position.x=e.width,u.position.y=0;var c=t.Texture.fromFrame(this.options.images.bottomCenter),p=new t.TilingSprite(c,this.width-n.width-o.width,c.height);p.position.x=n.width,p.position.y=this.height-n.height;var d=t.Texture.fromFrame(this.options.images.middleCenter),f=new t.TilingSprite(d,this.width-e.width-i.width,Math.ceil(this.height-o.height-i.height));f.position.x=e.width,f.position.y=e.height,this.container.addChild(e),this.container.addChild(u),this.container.addChild(i),this.container.addChild(s),this.container.addChild(f),this.container.addChild(h),this.container.addChild(n),this.container.addChild(p),this.container.addChild(o),this.addChild(this.container),this.container.cacheAsBitmap=!0},o}),define("absolute/animatedbutton",["pixi","absolute/button","lodash","absolute/screenmetrics","absolute/platform"],function(t,e,i,n,o){var r=function(t,e,i,n,o){this._initAnimatedButton(t,e,i,n,o)};return r.constructor=r,r.prototype=Object.create(e.prototype),r.prototype._initAnimatedButton=function(t,i,n,r,s){e.call(this,t,i,n,r,s),o.supportsTouch()||(this.mouseover=function(){this.setTexture(this.hoverImage),this.defaultY=this.position.y,this.position.y=this.defaultY+2},this.mouseout=function(){this.setTexture(this.defaultImage),this.position.y=this.defaultY})},r}),define("absolute/threeslice",["pixi","lodash"],function(t,e){var i=function(t){var i={width:"470",height:"126",images:{left:"LW_3slice_btn_01.png",center:"LW_3slice_btn_02.png",right:"LW_3slice_btn_03.png"}};this._initThreeSlice(e.extend(i,t))};return i.prototype=Object.create(t.DisplayObjectContainer.prototype),i.prototype._initThreeSlice=function(e){t.DisplayObjectContainer.call(this),this.options=e,this.cachedContent=this.options.content,this._setSize(),this._createBackground()},i.prototype._setSize=function(){this.width=this.options.width,this.height=this.options.height},i.prototype._createBackground=function(){var e=t.Sprite.fromFrame(this.options.images.left);e.position.x=0,e.position.y=0;var i=t.Sprite.fromFrame(this.options.images.right);i.position.x=this.width-i.width,i.position.y=0;var n=t.Texture.fromFrame(this.options.images.center),o=new t.Sprite(n);o.width=this.width-e.width-i.width,o.position.x=e.width,o.position.y=0,this.addChild(o),this.addChild(e),this.addChild(i)},i}),define("absolute/textbutton",["pixi","absolute/button","absolute/threeslice","lodash","absolute/screenmetrics"],function(t,e,i,n,o){var r=function(e,i,r,s,a,h,l){var u={text:"",textStyle:{font:Math.floor(90*o.getResScale())+"px Ganache",align:"center"}},c=h||u;l&&"object"==typeof l&&(this.container=new t.DisplayObjectContainer,this.texture=this._createThreeSliceImage(l),e=this.texture,i=this.texture),this._initTextButton(e,i,r,s,a,n.extend(u,c))};return r.constructor=r,r.prototype=Object.create(e.prototype),r.prototype._initTextButton=function(i,n,o,r,s,a){e.call(this,i,n,o,r,s);var h=new t.BitmapText(a.text,a),l=new t.Sprite(h.generateTexture()),u=new t.DisplayObjectContainer;u.width=l.width,u.height=l.height,u.pivot.x=u.width/2,u.pivot.y=u.height/2,u.x=this.width/2,u.y=this.height/2,u.addChild(l),this.addChild(u)},r.prototype._createThreeSliceImage=function(t){var e=new i(t);return e.generateTexture()},r}),define("absolute/animatedtextbutton",["pixi","absolute/textbutton","lodash","absolute/platform"],function(t,e,i,n){var o=function(t,e,i,n,o,r,s){this._initAnimatedTextButton(t,e,i,n,o,r,s)};return o.constructor=o,o.prototype=Object.create(e.prototype),o.prototype._initAnimatedTextButton=function(t,i,o,r,s,a,h){e.call(this,t,i,o,r,s,a,h),n.supportsTouch()||(this.mouseover=function(){this.setTexture(this.hoverImage),this.defaultY=this.position.y,this.position.y=this.defaultY+2},this.mouseout=function(){this.setTexture(this.defaultImage),this.position.y=this.defaultY})},o}),define("text!absolute/ui/layout.json",[],function(){return"{\n\n}"}),define("absolute/uibuilder",["pixi","lodash","absolute/assetmap","absolute/stringmanager","absolute/coords","absolute/screenmetrics","absolute/progressbar","absolute/nineslice","absolute/animatedbutton","absolute/animatedtextbutton","absolute/togglebutton","text!absolute/ui/layout.json"],function(t,e,i,n,o,r,s,a,h,l,u,c){var p=JSON.parse(c);return{load:function(t){try{var i=JSON.parse(t);e.merge(p,i)}catch(n){throw alert("UIBuilder: error in layout.json"),n}},findWidget:function(t,e){var i=null;for(var n in e.widgets)if(e.widgets.hasOwnProperty(n)&&(i=n==t?e.widgets[n]:this.findWidget(t,e.widgets[n])),i)return i;return null},getConfigData:function(t){return p[t]},buildLayout:function(e,c,d){var f=null,g=this;switch("string"==typeof e&&(e=p[e]),e.type){case"ProgressBar":this.checkParams({frame:"string",fill:"string"},e.params),f=new s(t.Texture.fromFrame(i(e.params.frame)),t.Texture.fromFrame(i(e.params.fill)));break;case"Text":this.checkParams({text:"string",fontSize:"number",fontFamily:"string",fill:"string",align:"string"},e.params),f=new t.Text(n(e.params.text),{font:Math.floor(e.params.fontSize*r.getResScale())+"px "+e.params.fontFamily,fill:e.params.fill,align:e.params.align}),f._setText=f.setText,f.setText=function(t){this._setText(t),this.updateText(),g.positionWidget(this,e,this.parent)};break;case"BitmapText":this.checkParams({text:"string",fontSize:"number",fontFamily:"string"},e.params),f=new t.BitmapText(n(e.params.text),{font:Math.floor(e.params.fontSize*r.getResScale())+"px "+e.params.fontFamily}),f.width=f.textWidth,f.height=f.textHeight,f._setText=f.setText,f.setText=function(t){this._setText(t),this.updateText(),f.width=f.textWidth,f.height=f.textHeight,g.positionWidget(this,e,this.parent)};break;case"Sprite":this.checkParams({texture:"string"},e.params);try{f=t.Sprite.fromFrame(i(e.params.texture))}catch(m){alert(m)}break;case"Container":f=new t.DisplayObjectContainer,e.params?(f.width=o.x(e.params.width)||c.width,f.height=o.y(e.params.height)||c.height):(f.width=c.width,f.height=c.height);break;case"NineSlice":this.checkParams({width:"number",height:"number",imageBase:"string"},e.params);var y={width:o.x(e.params.width),height:o.y(e.params.height),images:{topLeft:i(e.params.imageBase+".topLeft"),topCenter:i(e.params.imageBase+".topCenter"),topRight:i(e.params.imageBase+".topRight"),middleLeft:i(e.params.imageBase+".middleLeft"),middleCenter:i(e.params.imageBase+".middleCenter"),middleRight:i(e.params.imageBase+".middleRight"),bottomLeft:i(e.params.imageBase+".bottomLeft"),bottomCenter:i(e.params.imageBase+".bottomCenter"),bottomRight:i(e.params.imageBase+".bottomRight")}};f=new a(y);break;case"AnimatedButton":this.checkParams({action:"string"},e.params),this.checkParams({defaultTexture:"string",hoverTexture:"string"},e.params);var v=d&&d[e.params.action]&&d[e.params.action].bind(d)||null,b=e.params.replaceOnHover||null,x=e.params.replaceOnHover||null;f=new h(t.Texture.fromFrame(i(e.params.defaultTexture)),t.Texture.fromFrame(i(e.params.hoverTexture)),v,b,x);break;case"AnimatedTextButton":this.checkParams({action:"string"},e.params),this.checkParams({text:"string",fontSize:"number",fontFamily:"string"},e.params.textStyle);var w=e.params.threeSlice||null;w&&this.checkParams({width:"number",height:"number",imageBase:"string"},e.params.threeSlice);var S=e.params.defaultTexture&&"string"==typeof e.params.defaultTexture?e.params.defaultTexture:null,C=e.params.hoverTexture&&"string"==typeof e.params.hoverTexture?e.params.hoverTexture:null,T=null!==S?t.Texture.fromFrame(i(S)):null,_=null!==C?t.Texture.fromFrame(i(C)):null,b=e.params.replaceOnHover||null,x=e.params.replaceOnHover||null,v=d&&d[e.params.action]&&d[e.params.action].bind(d)||null,M={text:n(e.params.textStyle.text),font:Math.floor(e.params.textStyle.fontSize*r.getResScale())+"px "+e.params.textStyle.fontFamily,align:e.params.textStyle.align,fontSize:e.params.textStyle.fontSize},E=null;w&&(E={width:o.x(e.params.threeSlice.width),height:o.y(e.params.threeSlice.height),images:{left:i(e.params.threeSlice.imageBase+".left"),center:i(e.params.threeSlice.imageBase+".center"),right:i(e.params.threeSlice.imageBase+".right")}}),f=new l(T,_,v,b,x,M,E);break;case"ToggleButton":this.checkParams({baseName:"string",action:"string",enabled:"boolean"},e.params);var v=d&&d[e.params.action]&&d[e.params.action].bind(d)||null,A=e.params.useOverlay||!1;f=new u(e.params.baseName,v,e.params.enabled,A)}if(f){if(f instanceof t.DisplayObjectContainer&&e.children){f.widgets=[];for(var B in e.children)e.children.hasOwnProperty(B)&&(f.widgets[B]=this.buildLayout(e.children[B],f,d),f.addChild(f.widgets[B]))}this.anchorWidget(f,e),this.scaleWidget(f,e,c),this.positionWidget(f,e,c)}return f},checkParams:function(t,e){for(var i in t)if(t.hasOwnProperty(i)){if(!e||!e[i]&&""!==e[i])throw"Error: missing required parameter: "+i;if(typeof e[i]!==t[i])throw"Error: parameter '"+i+"' must be of type "+t[i]}},anchorWidget:function(t,e){e.anchor&&(e.anchor.x&&(t.anchor.x=e.anchor.x),e.anchor.y&&(t.anchor.y=e.anchor.y))},scaleWidget:function(t,e,i){if(e.scale){if(e.scale.x)if("string"==typeof e.scale.x){if("height"===e.scale.x){if(!i||!i.height)throw"Error: relative scale used but parent height not set!";t.scale.x=i.height/t.height}if("width"===e.scale.x){if(!i||!i.width)throw"Error: relative scale used but parent width not set!";t.scale.x=i.width/t.width}}else t.scale.x=e.scale.x;if(e.scale.y)if("string"==typeof e.scale.y){if("height"===e.scale.y){if(!i||!i.height)throw"Error: relative scale used but parent height not set!";t.scale.y=i.height/t.height}if("width"===e.scale.y){if(!i||!i.width)throw"Error: relative scale used but parent width not set!";t.scale.y=i.width/t.width}}else t.scale.y=e.scale.y}},positionWidget:function(t,e,i){var n,r;if(e.position){if("string"==typeof e.position.x){if(!i||!i.width)throw"Error: relative position used but parent width not set!";if(-1!==e.position.x.indexOf("%"))n=e.position.x.split("%"),r=parseInt(n[0])/100,t.position.x=i.width*r;else switch(e.position.x){case"left":t.position.x=0;break;case"right":t.position.x=i.width-t.width;break;case"center":t.position.x=(i.width-t.width)/2}}else"number"==typeof e.position.x&&(t.position.x=o.x(e.position.x));if("string"==typeof e.position.y){if(!i||!i.height)throw"Error: relative position used but parent height not set!";if(-1!==e.position.y.indexOf("%"))n=e.position.y.split("%"),r=parseInt(n[0])/100,t.position.y=i.height*r;else switch(e.position.y){case"top":t.position.y=0;break;case"bottom":t.position.y=i.height-t.height;break;case"middle":t.position.y=(i.height-t.height)/2}}else"number"==typeof e.position.y&&(t.position.y=o.y(e.position.y))}}}}),define("absolute/dialog",["pixi","absolute/uibuilder","absolute/assetmap","absolute/coords","absolute/screen","absolute/debug","lodash","absolute/button","absolute/audiomanager","absolute/nineslice"],function(t,e,i,n,o,r,s,a,h,l){var u=function(t,e){var o={width:"80%",height:"70%",x:null,y:null,landscapeX:null,landscapeY:null,portraitX:null,portraitY:null,name:"default",images:{topLeft:i("dialogNineSlice.topLeft"),topCenter:i("dialogNineSlice.topCenter"),topRight:i("dialogNineSlice.topRight"),topRight_closeBackground:i("dialogNineSlice.topRight_closeBackground"),middleLeft:i("dialogNineSlice.middleLeft"),middleCenter:i("dialogNineSlice.middleCenter"),middleRight:i("dialogNineSlice.middleRight"),bottomLeft:i("dialogNineSlice.bottomLeft"),bottomCenter:i("dialogNineSlice.bottomCenter"),bottomRight:i("dialogNineSlice.bottomRight"),close:i("dialogNineSlice.close")},fillOpacity:.95,content:"",displayCloseButton:!0,callbacks:{onClose:null},audio:{close:"",open:"show_details_window"},tween:{type:"none"},buttons:[],buttonSpacing:n.x(20),layout:""};this._initDialog(t,s.extend(o,e))};return u.prototype=Object.create(o.prototype),u.prototype._initDialog=function(e,i){o.call(this),this.ui=e,this.options=i,this.cachedContent=this.options.content,this.isOpen=!1,this.container=new t.DisplayObjectContainer,this._setSize(),this._setPosition(),this._createBackground(),this.options.displayCloseButton&&this._createCloseButton(),this.options.buttons.length>0&&this.addButtons(this.options.buttons,this.options.buttonSpacing),this._setContent(this.options.content),this.addChild(this.container)},u.prototype.open=function(t){if("function"==typeof t&&(this.options.callbacks.onClose=t),this.options.audio.open&&""!==this.options.audio.open&&h.playSound(this.options.audio.open),"none"!==this.options.tween.type){var e=this,i=this.position.x;this.position.x=this.ui.width,new TWEEN.Tween({x:this.position.x}).to({x:i},500).easing(TWEEN.Easing.Cubic.InOut).onUpdate(function(){e.position.x=this.x}).onComplete(function(){e.onOpenComplete()}).start()}else this.onOpenComplete();this.ui.showModal(this),this.isOpen=!0},u.prototype.onOpenComplete=function(){},u.prototype.close=function(){this.options.audio.close&&""!==this.options.audio.close&&h.playSound(this.options.audio.close),this.ui.hideModal(this),this.isOpen=!1},u.prototype._setSize=function(){function t(t,e){var i=parseInt(e.slice(0,e.length-1))/100;return Math.round(t*i)}if(this.options.layout){var i=e.getConfigData(this.options.layout);i&&(i.width&&(this.options.width=i.width),i.height&&(this.options.height=i.height))}"string"==typeof this.options.width&&this.options.width.indexOf("%")>-1?(this.width=t(this.ui.width,this.options.width),this.options.width=this.width):this.width=this.options.width,"string"==typeof this.options.height&&this.options.height.indexOf("%")>-1?(this.height=t(this.ui.height,this.options.height),this.options.height=this.height):this.height=this.options.height},u.prototype.setLandscapePositions=function(t){"number"==typeof t.x&&(this.options.landscapeX=Math.round(t.x)),"number"==typeof t.y&&(this.options.landscapeY=Math.round(t.y))},u.prototype.setPortraitPositions=function(t){"number"==typeof t.x&&(this.options.portraitX=Math.round(t.x)),"number"==typeof t.y&&(this.options.portraitY=Math.round(t.y))},u.prototype._setPosition=function(t){"undefined"!=typeof t?t?(null===this.options.portraitX?this._setStandardX():this.position.x=Math.round(this.options.portraitX),null===this.options.portraitY?this._setStandardY():this.position.y=Math.round(this.options.portraitY)):(null===this.options.landscapeX?this._setStandardX():this.position.x=Math.round(this.options.landscapeX),null===this.options.landscapeY?this._setStandardY():this.position.y=Math.round(this.options.landscapeY)):(this._setStandardX(),this._setStandardY())},u.prototype._setStandardX=function(){this.position.x=Math.round(null===this.options.x?(this.ui.width-this.width)/2:this.options.x)},u.prototype._setStandardY=function(){this.position.y=Math.round(null===this.options.y?(this.ui.height-this.height)/2:this.options.y)},u.prototype._onClose=function(){"function"==typeof this.options.callbacks.onClose&&this.options.callbacks.onClose(this),this.close()},u.prototype._createCloseButton=function(){this.closeButton=new a(t.Texture.fromFrame(this.options.images.close),t.Texture.fromFrame(this.options.images.close),s.bind(this._onClose,this),!0),this.closeButton.hitArea=new t.Rectangle(-this.closeButton.width/3,-this.closeButton.height/3,1.6*this.closeButton.width,1.6*this.closeButton.height),this.options.images.topRight_closeBackground?(this.closeButton.position.x=this.width-this.closeButton.width,this.closeButton.position.y=0):(this.closeButton.position.x=this.width-this.closeButton.width/1.5,this.closeButton.position.y=-(this.closeButton.height/3)),this.container.addChild(this.closeButton)},u.prototype.addButtons=function(e,i){var n=0,o=0;
if(i=i||0,e.length>0){this.buttonContainer&&this.removeChild(this.buttonContainer),this.buttonContainer=new t.DisplayObjectContainer;for(var r=0;r<e.length;r+=1){var s=e[r];s.x=n,this.buttonContainer.addChild(s),n+=s.width+i,s.height>o&&(o=s.height)}this.buttonContainer.position.x=(this.width-(n-i))/2,this.buttonContainer.position.y=this.height-o,this.container.addChild(this.buttonContainer)}},u.prototype._createBackground=function(){var t=this.options.images;this.options.displayCloseButton&&t.topRight_closeBackground&&(t.topRight=t.topRight_closeBackground,this.options.images=t);var e=new l(this.options);this.container.addChildAt(e,0)},u.prototype._setContent=function(t){if("undefined"!=typeof t){try{this.removeChild(this.cachedContent)}catch(e){}this.cachedContent=t}"undefined"==typeof this.cachedContent||s.isEmpty(this.cachedContent)||(this.container.addChild(this.cachedContent),this.container.getChildAt(0).cacheAsBitmap=!0)},u.prototype.resize=function(t,e){this.updateDialog(t,e)},u.prototype.updateDialog=function(e,i){s.extend(this.options,e);try{this.removeChild(this.container)}catch(n){}this.container=new t.DisplayObjectContainer,this._setSize(),this._setPosition(i),this._createBackground(),this.options.displayCloseButton&&this._createCloseButton(),this._setContent(this.options.content),this.addChild(this.container)},u.prototype.handleOrientationChange=function(t){this.updateDialog(this.options,t)},Object.defineProperty(u.prototype,"isOpen",{get:function(){return this.openState},set:function(t){this.openState=t}}),u}),define("absolute/shims",["pixi"],function(t){if(window.navigator.userAgent.indexOf("Linux; U; Android 4")>=0){var e=Math.sin,i=Math.cos;Math.sin=function(t){return 0==t?0:e(t)},Math.cos=function(t){return 0==t?1:i(t)}}Date.now||(Date.now=function(){return+new Date}),t.JsonLoader.prototype.load=function(){this.ajaxRequest=new window.XMLHttpRequest;var t=this;this.ajaxRequest.onload=function(){t.onJSONLoaded()},this.ajaxRequest.open("GET",this.url,!1),this.ajaxRequest.send()},(t.VERSION="v1.5.3")&&(t.InteractionManager.prototype.onTouchMove=function(t){var e,i=this.interactionDOMElement.getBoundingClientRect(),n=t.changedTouches,o=0;for(o=0;o<n.length;o++){var r=n[o];e=this.touchs[r.identifier],e.originalEvent=t||window.event,e.global.x=(r.clientX-i.left)*(this.target.width/i.width),e.global.y=(r.clientY-i.top)*(this.target.height/i.height),navigator.isCocoonJS&&(e.global.x=r.clientX,e.global.y=r.clientY);for(var s=0;s<this.interactiveItems.length;s++){var a=this.interactiveItems[s];a.touchmove&&a.__touchData&&a.__touchData[r.identifier]&&a.touchmove(e)}}})}),define("absolute/sprite",["pixi","absolute/screenmetrics","absolute/debug"],function(t,e,i){return{fromFrame:function(n){var o;try{if(o=t.Sprite.fromFrame(n),i.enabled){var r=o.texture.baseTexture.imageUrl.substr(o.texture.baseTexture.imageUrl.lastIndexOf("/")+1),s=new t.Text(r,{font:Math.floor(30*e.getResScale())+"px Arial, Helvetica, sans-serif",fill:"white",align:"center"});s.position.y=0,s.position.x=0,o.addChild(s)}}catch(a){if(!i.enabled)throw a;o=t.Sprite.fromFrame("missing.png");var h=new t.Text(n,{font:Math.floor(40*e.getResScale())+"px Arial, Helvetica, sans-serif",fill:"black",align:"center"});h.position.y=o.height,h.position.x=(o.width-h.width)/2,o.addChild(h)}return o}}}),define("absolute/texture",["pixi","absolute/platform","absolute/debug"],function(t,e,i){return{fromFrame:function(e){var n;try{n=t.Texture.fromFrame(e)}catch(o){if(!i.enabled)throw o;n=t.Texture.fromFrame("missing.png")}return n}}}),define("absolute/mathutils",[],function(){return MathUtils={distance:function(t,e,i,n){return Math.sqrt(Math.pow(t-i,2)+Math.pow(e-n,2))}}}),define("absolute/randomutils",["absolute/mathutils","absolute/coords","pixi","lodash","absolute/spriteutils"],function(t,e,i,n,o){var r={getRandomIntFromRange:function(t,e){return Math.floor(Math.random()*(e-t+1))+t},distributeItems:function(e,r,s,a,h){function l(e,n){for(var r=f.getRandomIntFromRange(0,s.width),u=f.getRandomIntFromRange(s.y,s.y+s.height),p=0;p<a.children.length;p++){var d=t.distance(r,u,a.children[p].position.x,a.children[p].position.y);if(e>=n)return!1;if(d<h.minSpacing)return e++,l(e,n),!1}if(c.sprite=new i.Sprite.fromFrame(c.url),h.shade>0){var g=new i.Sprite(o.greyscale(i.Sprite.fromFrame(c.url),.5));g.alpha=h.shade,c.sprite.addChild(g)}if(c.sprite.position.x=null!==h.lockX?0:r,c.sprite.position.y=null!==h.lockY?0:u,h.scaleWithY){var m=(u-s.y)/s.height;m+=h.minScale,m>1&&(m=1),c.sprite.scale.x=c.sprite.scale.y=m,c.sprite.alpha=Math.max(c.sprite.scale.y,h.minAlpha)}else{var y=f.getRandomIntFromRange(100*h.minScale,100*h.maxScale)/100;c.sprite.scale.x=c.sprite.scale.y=y,Math.random()>.5&&(c.sprite.scale.x=-c.sprite.scale.x),y>1&&(c.sprite.y=c.sprite.texture.height-c.sprite.texture.height*y)}a.addChild(c.sprite)}h=n.extend({minSpacing:100,scaleWithY:!0,minScale:.3,maxScale:1,minAlpha:.2,lockY:null,lockX:null,shade:0},h),this.ui=e,s.area=s.width*s.height;for(var u=0;u<r.length;u++){var c=r[u],p=new i.Texture.fromFrame(c.url);c.area=p.width*p.height,c.count=Math.round(c.fillDensity*s.area/c.area);for(var d=0;d<c.count;d++){var f=this;l(0,1e3)}}return a}};return r}),define("absolute/pageindicator",["absolute/coords","pixi","lodash"],function(t,e,i){var n=function(e,n,o){n="undefined"!=typeof n?n:0;var r={pageIndicators:{empty:"btn_main_pagepip_empty.png",full:"btn_main_pagepip_full.png"},pipPadding:t.x(10),clickCallback:function(){}};this.initPageIndicator(e,n,i.extend(r,o))};return n.prototype=Object.create(e.DisplayObjectContainer.prototype),n.prototype.initPageIndicator=function(t,i,n){e.DisplayObjectContainer.call(this),this.pageCount=t,this.currentPage=i,this.options=n,this.pips=[],this.makePips()},n.prototype.setPageIndex=function(t){this.currentPage=t,this._update()},n.prototype.makePips=function(){for(var t=0;t<this.pageCount;t++){var i=new e.DisplayObjectContainer;i.on=new e.Sprite.fromFrame(this.options.pageIndicators.full),i.off=new e.Sprite.fromFrame(this.options.pageIndicators.empty),i.position.x=(i.on.width+this.options.pipPadding)*t,t!==this.currentPage?(i.on.visible=!1,i.off.visible=!0):(i.on.visible=!0,i.off.visible=!1),i.addChild(i.on),i.addChild(i.off),i.off.interactive=!0,i.off.pageIndex=t,i.off.click=function(t){this.options.clickCallback(t.target.pageIndex)}.bind(this),this.addChild(i),this.pips.push(i)}this.height=i.on.height,this.width=(i.on.width+this.options.pipPadding)*this.pageCount},n.prototype._update=function(){for(var t=0;t<this.pips.length;t++){var e=this.pips[t];this.currentPage==t?(e.on.visible=!0,e.off.visible=!1):(e.on.visible=!1,e.off.visible=!0)}},n.prototype.nextPage=function(){this.currentPage++,this.currentPage>=this.pageCount&&0==this.currentPage,this._update()},n.prototype.previousPage=function(){this.currentPage--,this.currentPage<0&&0==this.currentPage,this._update()},n}),function(t,e){"use strict";function i(){n.READY||(v.determineEventTypes(),f.each(n.gestures,function(t){x.register(t)}),v.onTouch(n.DOCUMENT,p,x.detect),v.onTouch(n.DOCUMENT,d,x.detect),n.READY=!0)}var n=function(t,e){return new n.Instance(t,e||{})};n.defaults={stop_browser_behavior:{userSelect:"none",touchAction:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},n.HAS_POINTEREVENTS=t.navigator.pointerEnabled||t.navigator.msPointerEnabled,n.HAS_TOUCHEVENTS="ontouchstart"in t,n.MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android|silk/i,n.NO_MOUSEEVENTS=n.HAS_TOUCHEVENTS&&t.navigator.userAgent.match(n.MOBILE_REGEX),n.EVENT_TYPES={},n.UPDATE_VELOCITY_INTERVAL=16,n.DOCUMENT=t.document;var o=n.DIRECTION_DOWN="down",r=n.DIRECTION_LEFT="left",s=n.DIRECTION_UP="up",a=n.DIRECTION_RIGHT="right",h=n.POINTER_MOUSE="mouse",l=n.POINTER_TOUCH="touch",u=n.POINTER_PEN="pen",c=n.EVENT_START="start",p=n.EVENT_MOVE="move",d=n.EVENT_END="end";n.plugins=n.plugins||{},n.gestures=n.gestures||{},n.READY=!1;var f=n.utils={extend:function(t,i,n){for(var o in i)t[o]!==e&&n||(t[o]=i[o]);return t},each:function(t,i,n){var o,r;if("forEach"in t)t.forEach(i,n);else if(t.length!==e){for(o=-1;r=t[++o];)if(i.call(n,r,o,t)===!1)return}else for(o in t)if(t.hasOwnProperty(o)&&i.call(n,t[o],o,t)===!1)return},hasParent:function(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1},getCenter:function(t){var e=[],i=[];return f.each(t,function(t){e.push("undefined"!=typeof t.clientX?t.clientX:t.pageX),i.push("undefined"!=typeof t.clientY?t.clientY:t.pageY)}),{pageX:(Math.min.apply(Math,e)+Math.max.apply(Math,e))/2,pageY:(Math.min.apply(Math,i)+Math.max.apply(Math,i))/2}},getVelocity:function(t,e,i){return{x:Math.abs(e/t)||0,y:Math.abs(i/t)||0}},getAngle:function(t,e){var i=e.pageY-t.pageY,n=e.pageX-t.pageX;return 180*Math.atan2(i,n)/Math.PI},getDirection:function(t,e){var i=Math.abs(t.pageX-e.pageX),n=Math.abs(t.pageY-e.pageY);return i>=n?t.pageX-e.pageX>0?r:a:t.pageY-e.pageY>0?s:o},getDistance:function(t,e){var i=e.pageX-t.pageX,n=e.pageY-t.pageY;return Math.sqrt(i*i+n*n)},getScale:function(t,e){return t.length>=2&&e.length>=2?this.getDistance(e[0],e[1])/this.getDistance(t[0],t[1]):1},getRotation:function(t,e){return t.length>=2&&e.length>=2?this.getAngle(e[1],e[0])-this.getAngle(t[1],t[0]):0},isVertical:function(t){return t==s||t==o},toggleDefaultBehavior:function(t,e,i){if(e&&t&&t.style){f.each(["webkit","moz","Moz","ms","o",""],function(n){f.each(e,function(e,o){n&&(o=n+o.substring(0,1).toUpperCase()+o.substring(1)),o in t.style&&(t.style[o]=!i&&e)})});var n=function(){return!1};"none"==e.userSelect&&(t.onselectstart=!i&&n),"none"==e.userDrag&&(t.ondragstart=!i&&n)}}};n.Instance=function(t,e){var o=this;return i(),this.element=t,this.enabled=!0,this.options=f.extend(f.extend({},n.defaults),e||{}),this.options.stop_browser_behavior&&f.toggleDefaultBehavior(this.element,this.options.stop_browser_behavior,!1),this.eventStartHandler=v.onTouch(t,c,function(t){o.enabled&&x.startDetect(o,t)}),this.eventHandlers=[],this},n.Instance.prototype={on:function(t,e){var i=t.split(" ");return f.each(i,function(t){this.element.addEventListener(t,e,!1),this.eventHandlers.push({gesture:t,handler:e})},this),this},off:function(t,e){var i,n,o=t.split(" ");return f.each(o,function(t){for(this.element.removeEventListener(t,e,!1),i=-1;n=this.eventHandlers[++i];)n.gesture===t&&n.handler===e&&this.eventHandlers.splice(i,1)},this),this},trigger:function(t,e){e||(e={});var i=n.DOCUMENT.createEvent("Event");i.initEvent(t,!0,!0),i.gesture=e;var o=this.element;return f.hasParent(e.target,o)&&(o=e.target),o.dispatchEvent(i),this},enable:function(t){return this.enabled=t,this},dispose:function(){var t,e;for(this.options.stop_browser_behavior&&f.toggleDefaultBehavior(this.element,this.options.stop_browser_behavior,!0),t=-1;e=this.eventHandlers[++t];)this.element.removeEventListener(e.gesture,e.handler,!1);return this.eventHandlers=[],v.unbindDom(this.element,n.EVENT_TYPES[c],this.eventStartHandler),null}};var g=null,m=!1,y=!1,v=n.event={bindDom:function(t,e,i){var n=e.split(" ");f.each(n,function(e){t.addEventListener(e,i,!1)})},unbindDom:function(t,e,i){var n=e.split(" ");f.each(n,function(e){t.removeEventListener(e,i,!1)})},onTouch:function(t,e,i){var o=this,r=function(r){var s=r.type.toLowerCase();if(!s.match(/mouse/)||!y){s.match(/touch/)||s.match(/pointerdown/)||s.match(/mouse/)&&1===r.which?m=!0:s.match(/mouse/)&&!r.which&&(m=!1),s.match(/touch|pointer/)&&(y=!0);var a=0;m&&(n.HAS_POINTEREVENTS&&e!=d?a=b.updatePointer(e,r):s.match(/touch/)?a=r.touches.length:y||(a=s.match(/up/)?0:1),a>0&&e==d?e=p:a||(e=d),(a||null===g)&&(g=r),i.call(x,o.collectEventData(t,e,o.getTouchList(g,e),r)),n.HAS_POINTEREVENTS&&e==d&&(a=b.updatePointer(e,r))),a||(g=null,m=!1,y=!1,b.reset())}};return this.bindDom(t,n.EVENT_TYPES[e],r),r},determineEventTypes:function(){var t;t=n.HAS_POINTEREVENTS?b.getEvents():n.NO_MOUSEEVENTS?["touchstart","touchmove","touchend touchcancel"]:["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"],n.EVENT_TYPES[c]=t[0],n.EVENT_TYPES[p]=t[1],n.EVENT_TYPES[d]=t[2]},getTouchList:function(t){return n.HAS_POINTEREVENTS?b.getTouchList():t.touches?t.touches:(t.identifier=1,[t])},collectEventData:function(t,e,i,n){var o=l;return(n.type.match(/mouse/)||b.matchType(h,n))&&(o=h),{center:f.getCenter(i),timeStamp:(new Date).getTime(),target:n.target,touches:i,eventType:e,pointerType:o,srcEvent:n,preventDefault:function(){this.srcEvent.preventManipulation&&this.srcEvent.preventManipulation(),this.srcEvent.preventDefault&&this.srcEvent.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return x.stopDetect()}}}},b=n.PointerEvent={pointers:{},getTouchList:function(){var t=[];return f.each(this.pointers,function(e){t.push(e)}),t},updatePointer:function(t,e){return t==d?delete this.pointers[e.pointerId]:(e.identifier=e.pointerId,this.pointers[e.pointerId]=e),Object.keys(this.pointers).length},matchType:function(t,e){if(!e.pointerType)return!1;var i=e.pointerType,n={};return n[h]=i===h,n[l]=i===l,n[u]=i===u,n[t]},getEvents:function(){return["pointerdown MSPointerDown","pointermove MSPointerMove","pointerup pointercancel MSPointerUp MSPointerCancel"]},reset:function(){this.pointers={}}},x=n.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(t,e){this.current||(this.stopped=!1,this.current={inst:t,startEvent:f.extend({},e),lastEvent:!1,lastVelocityEvent:!1,velocity:!1,name:""},this.detect(e))},detect:function(t){if(this.current&&!this.stopped){t=this.extendEventData(t);var e=this.current.inst.options;return f.each(this.gestures,function(i){return this.stopped||e[i.name]===!1||i.handler.call(i,t,this.current.inst)!==!1?void 0:(this.stopDetect(),!1)},this),this.current&&(this.current.lastEvent=t),t.eventType==d&&!t.touches.length-1&&this.stopDetect(),t}},stopDetect:function(){this.previous=f.extend({},this.current),this.current=null,this.stopped=!0},extendEventData:function(t){var e=this.current,i=e.startEvent;(t.touches.length!=i.touches.length||t.touches===i.touches)&&(i.touches=[],f.each(t.touches,function(t){i.touches.push(f.extend({},t))}));var o,r,s=t.timeStamp-i.timeStamp,a=t.center.pageX-i.center.pageX,h=t.center.pageY-i.center.pageY,l=e.lastVelocityEvent,u=e.velocity;return l&&t.timeStamp-l.timeStamp>n.UPDATE_VELOCITY_INTERVAL?(u=f.getVelocity(t.timeStamp-l.timeStamp,t.center.pageX-l.center.pageX,t.center.pageY-l.center.pageY),e.lastVelocityEvent=t,e.velocity=u):e.velocity||(u=f.getVelocity(s,a,h),e.lastVelocityEvent=t,e.velocity=u),t.eventType==d?(o=e.lastEvent&&e.lastEvent.interimAngle,r=e.lastEvent&&e.lastEvent.interimDirection):(o=e.lastEvent&&f.getAngle(e.lastEvent.center,t.center),r=e.lastEvent&&f.getDirection(e.lastEvent.center,t.center)),f.extend(t,{deltaTime:s,deltaX:a,deltaY:h,velocityX:u.x,velocityY:u.y,distance:f.getDistance(i.center,t.center),angle:f.getAngle(i.center,t.center),interimAngle:o,direction:f.getDirection(i.center,t.center),interimDirection:r,scale:f.getScale(i.touches,t.touches),rotation:f.getRotation(i.touches,t.touches),startEvent:i}),t},register:function(t){var i=t.defaults||{};return i[t.name]===e&&(i[t.name]=!0),f.extend(n.defaults,i,!0),t.index=t.index||1e3,this.gestures.push(t),this.gestures.sort(function(t,e){return t.index<e.index?-1:t.index>e.index?1:0}),this.gestures}};n.gestures.Drag={name:"drag",index:50,defaults:{drag_min_distance:10,correct_for_drag_min_distance:!0,drag_max_touches:1,drag_block_horizontal:!1,drag_block_vertical:!1,drag_lock_to_axis:!1,drag_lock_min_distance:25},triggered:!1,handler:function(t,e){if(x.current.name!=this.name&&this.triggered)return e.trigger(this.name+"end",t),void(this.triggered=!1);if(!(e.options.drag_max_touches>0&&t.touches.length>e.options.drag_max_touches))switch(t.eventType){case c:this.triggered=!1;break;case p:if(t.distance<e.options.drag_min_distance&&x.current.name!=this.name)return;if(x.current.name!=this.name&&(x.current.name=this.name,e.options.correct_for_drag_min_distance&&t.distance>0)){var i=Math.abs(e.options.drag_min_distance/t.distance);x.current.startEvent.center.pageX+=t.deltaX*i,x.current.startEvent.center.pageY+=t.deltaY*i,t=x.extendEventData(t)}(x.current.lastEvent.drag_locked_to_axis||e.options.drag_lock_to_axis&&e.options.drag_lock_min_distance<=t.distance)&&(t.drag_locked_to_axis=!0);var n=x.current.lastEvent.direction;t.drag_locked_to_axis&&n!==t.direction&&(t.direction=f.isVertical(n)?t.deltaY<0?s:o:t.deltaX<0?r:a),this.triggered||(e.trigger(this.name+"start",t),this.triggered=!0),e.trigger(this.name,t),e.trigger(this.name+t.direction,t);var h=f.isVertical(t.direction);(e.options.drag_block_vertical&&h||e.options.drag_block_horizontal&&!h)&&t.preventDefault();break;case d:this.triggered&&e.trigger(this.name+"end",t),this.triggered=!1}}},n.gestures.Hold={name:"hold",index:10,defaults:{hold_timeout:500,hold_threshold:1},timer:null,handler:function(t,e){switch(t.eventType){case c:clearTimeout(this.timer),x.current.name=this.name,this.timer=setTimeout(function(){"hold"==x.current.name&&e.trigger("hold",t)},e.options.hold_timeout);break;case p:t.distance>e.options.hold_threshold&&clearTimeout(this.timer);break;case d:clearTimeout(this.timer)}}},n.gestures.Release={name:"release",index:1/0,handler:function(t,e){t.eventType==d&&e.trigger(this.name,t)}},n.gestures.Swipe={name:"swipe",index:40,defaults:{swipe_min_touches:1,swipe_max_touches:1,swipe_velocity:.7},handler:function(t,e){if(t.eventType==d){if(t.touches.length<e.options.swipe_min_touches||t.touches.length>e.options.swipe_max_touches)return;(t.velocityX>e.options.swipe_velocity||t.velocityY>e.options.swipe_velocity)&&(e.trigger(this.name,t),e.trigger(this.name+t.direction,t))}}},n.gestures.Tap={name:"tap",index:100,defaults:{tap_max_touchtime:250,tap_max_distance:10,tap_always:!0,doubletap_distance:20,doubletap_interval:300},has_moved:!1,handler:function(t,e){var i,n,o;t.eventType==c?this.has_moved=!1:t.eventType!=p||this.moved?t.eventType==d&&"touchcancel"!=t.srcEvent.type&&t.deltaTime<e.options.tap_max_touchtime&&!this.has_moved&&(i=x.previous,n=i&&i.lastEvent&&t.timeStamp-i.lastEvent.timeStamp,o=!1,i&&"tap"==i.name&&n&&n<e.options.doubletap_interval&&t.distance<e.options.doubletap_distance&&(e.trigger("doubletap",t),o=!0),(!o||e.options.tap_always)&&(x.current.name="tap",e.trigger(x.current.name,t))):this.has_moved=t.distance>e.options.tap_max_distance}},n.gestures.Touch={name:"touch",index:-1/0,defaults:{prevent_default:!1,prevent_mouseevents:!1},handler:function(t,e){return e.options.prevent_mouseevents&&t.pointerType==h?void t.stopDetect():(e.options.prevent_default&&t.preventDefault(),void(t.eventType==c&&e.trigger(this.name,t)))}},n.gestures.Transform={name:"transform",index:45,defaults:{transform_min_scale:.01,transform_min_rotation:1,transform_always_block:!1,transform_within_instance:!1},triggered:!1,handler:function(t,e){if(x.current.name!=this.name&&this.triggered)return e.trigger(this.name+"end",t),void(this.triggered=!1);if(!(t.touches.length<2)){if(e.options.transform_always_block&&t.preventDefault(),e.options.transform_within_instance)for(var i=-1;t.touches[++i];)if(!f.hasParent(t.touches[i].target,e.element))return;switch(t.eventType){case c:this.triggered=!1;break;case p:var n=Math.abs(1-t.scale),o=Math.abs(t.rotation);if(n<e.options.transform_min_scale&&o<e.options.transform_min_rotation)return;x.current.name=this.name,this.triggered||(e.trigger(this.name+"start",t),this.triggered=!0),e.trigger(this.name,t),o>e.options.transform_min_rotation&&e.trigger("rotate",t),n>e.options.transform_min_scale&&(e.trigger("pinch",t),e.trigger("pinch"+(t.scale<1?"in":"out"),t));break;case d:this.triggered&&e.trigger(this.name+"end",t),this.triggered=!1}}}},"function"==typeof define&&define.amd?define("hammer",[],function(){return n}):"object"==typeof module&&module.exports?module.exports=n:t.Hammer=n}(window),define("absolute/multipagedialog",["pixi","absolute/dialog","hammer","absolute/button","absolute/screenmetrics","lodash","absolute/pageindicator","absolute/coords"],function(t,e,i,n,o,r,s,a){var h=function(t,e){var i={pages:[],pagePadding:{x:a.x(10),y:a.y(100)},borderThickness:{left:a.x(18),right:a.x(35)},interfacePadding:{arrows:{x:a.x(50),y:a.y(50)},pips:a.y(50)},buttonScale:.5,pageButtonImage:"btn_main_LAGOONRETURN.png",pageChangedCallback:function(){},startPage:0};this.initMultiPageDialog(t,r.extend(i,e))};return h.prototype=Object.create(e.prototype),h.prototype.initMultiPageDialog=function(t,i){e.call(this,t,i),this.pages=this.options.pages;var n=this.options.startPage<this.pages.length?this.options.startPage:0;this.reset(!1,n)},h.prototype.reset=function(t,e){if(t)try{this.removeChild(this.pageTray),this.removeChild(this.pips),this.removeChild(this.nextpageButton),this.removeChild(this.prevpageButton)}catch(i){}this.initContent(),this.initTouchInterface(),this.initNonTouchInterface(),this.initPagePips(),this.scrollToPage(e)},h.prototype.initContent=function(){this.pageTray=new t.DisplayObjectContainer;for(var e=0,i=this.pages.length;i>e;e+=1){var n=this.pages[e];n.position.x=e*n.width,n.position.y=this.options.pagePadding.y,this.pageTray.addChild(n)}this.kPanThreshold=n.width/5,this.centerOffset=(this.width-n.width)/2,this.pageTray.position.x=this.centerOffset;var o=new t.Graphics;o.beginFill(16777215,1),o.drawRect(this.position.x+this.options.borderThickness.left,0,this.width-this.options.borderThickness.right,this.height),o.endFill(),this.pageTray.mask=o,this.addChild(this.pageTray)},h.prototype.initTouchInterface=function(){this.lastDeltaX=0,this.startX=0,i(this.ui.container).on("dragstart",this.handleDragStart.bind(this)),i(this.ui.container).on("drag",this.handleDrag.bind(this)),i(this.ui.container).on("dragend",this.handleDragEnd.bind(this))},h.prototype.initNonTouchInterface=function(){this.nextpageButton=new n(t.Texture.fromFrame(this.options.pageButtonImage),t.Texture.fromFrame(this.options.pageButtonImage),function(){this.currentPage<this.pages.length-1&&this.scrollToPage(this.currentPage+1)}.bind(this),!1);var e=this.height-this.nextpageButton.height*this.options.buttonScale-this.options.interfacePadding.arrows.y;this.nextpageButton.scale.x=-1*this.options.buttonScale,this.nextpageButton.scale.y=this.options.buttonScale,this.nextpageButton.position.x=this.width-this.options.interfacePadding.arrows.x,this.nextpageButton.position.y=e,this.nextpageButton.setActive(!1),this.addChild(this.nextpageButton),this.prevpageButton=new n(t.Texture.fromFrame(this.options.pageButtonImage),t.Texture.fromFrame(this.options.pageButtonImage),function(){this.currentPage>0&&this.scrollToPage(this.currentPage-1)}.bind(this),!1),this.prevpageButton.position.y=e,this.prevpageButton.scale.x=this.prevpageButton.scale.y=this.options.buttonScale,this.prevpageButton.position.x=this.options.interfacePadding.arrows.x,this.prevpageButton.setActive(!1),this.addChild(this.prevpageButton)},h.prototype.initPagePips=function(){this.pages.length>1&&(this.pips=new s(this.pages.length,0,{clickCallback:this.scrollToPage.bind(this)}),this.pips.position.x=(this.width-this.pips.width)/2,this.pips.position.y=this.height-this.pips.height-this.options.interfacePadding.pips,this.addChild(this.pips))},h.prototype.enableButtons=function(t){var e,i;for(e=0,i=this.pages.length;i>e;e++)this.pages[e].enableButtons(t)},h.prototype.handleDragStart=function(){this.lastDeltaX=0,this.startX=-(this.currentPage*this.pages[this.currentPage].width)+this.centerOffset,this.enableButtons(!1)},h.prototype.handleDrag=function(t){this.pageTray.position.x+=(t.gesture.deltaX-this.lastDeltaX)*o.devicePixelRatio/2,this.lastDeltaX=t.gesture.deltaX},h.prototype.handleDragEnd=function(t){this.lastDeltaX=0;var e=this.currentPage;t.gesture.deltaX<=-this.kPanThreshold?e+=1:t.gesture.deltaX>=this.kPanThreshold&&(e-=1),0>e?e=0:e>this.pages.length-1&&(e=this.pages.length-1),this.scrollToPage(e)},h.prototype.scrollToPage=function(t){this.pips&&this.pips.setPageIndex(t);var e=-(t*this.pages[t].width)+this.centerOffset,i=this;new TWEEN.Tween({x:this.pageTray.position.x}).to({x:e},200).easing(TWEEN.Easing.Quadratic.InOut).onUpdate(function(){i.pageTray.position.x=this.x}).onComplete(function(){i.enableButtons(!0),i.setCurrentPage(t)}).start()},h.prototype.setCurrentPage=function(t){this.currentPage=t,this.nextpageButton.setActive(t!==this.pages.length-1),this.prevpageButton.setActive(0!==t),this.options.pageChangedCallback(t)},h.prototype.enableButtons=function(t){var e,i;for(e=0,i=this.pages.length;i>e;e++)this.pages[e].interactive=t},h.prototype.handleOrientationChange=function(t){e.prototype.handleOrientationChange.call(this,t),this.reset(!0,this.currentPage)},h}),define("absolute/graphserializer",["pixi","absolute/button"],function(t,e){var i={serialize:function(i){var n,o,r={position:{x:i.position.x,y:i.position.y}};if(i instanceof e)r.type="button",r.asset=this.lookupTexture(i),r.id=r.asset.substring(0,r.asset.indexOf(".png"));else if(i instanceof t.Sprite)for(o=i.children.length,r.type="sprite",r.asset=this.lookupTexture(i),r.id=r.asset.substring(0,r.asset.indexOf(".png")),r.children=[],n=0;o>n;n+=1)r.children.push(this.serialize(i.getChildAt(n)));else if(i instanceof t.DisplayObjectContainer)for(o=i.children.length,r.type="container",r.children=[],n=0;o>n;n+=1)r.children.push(this.serialize(i.getChildAt(n)));return r},lookupTexture:function(e){var i;for(i in t.TextureCache)if(t.TextureCache.hasOwnProperty(i)&&t.TextureCache[i]===e.texture)return i;return""}};return i}),define("absolute/scrollarea",["pixi","absolute/platform"],function(t,e){var i=function(t,e,i,n,o){this._initScrollArea(t,e,i,n,o)};return i.constructor=i,i.prototype=Object.create(t.DisplayObjectContainer.prototype),i.prototype._initScrollArea=function(i,n,o,r,s){t.DisplayObjectContainer.call(this),o&&(o.x?(this.constrainX=!0,this.constrainXType=o.x):o.y?(this.constrainY=!0,this.constrainYType=o.y):this.constrainX=this.constrainY=!1),r&&(this.scrollArrow=new t.Sprite(r),this.scrollArrow.anchor.x=this.scrollArrow.anchor.y=.5),this.moveCompleteCallback=s,this.moving=!1,this.contents=new t.DisplayObjectContainer,this.contents.setInteractive(!0),e.supportsTouch()?(this.contents.touchstart=this.onMoveStart.bind(this),this.contents.touchmove=this.onMove.bind(this),this.contents.touchend=this.onMoveEnd.bind(this)):(this.contents.mousedown=this.onMoveStart.bind(this),this.contents.mousemove=this.onMove.bind(this),this.contents.mouseup=this.onMoveEnd.bind(this),this.contents.mouseupoutside=this.onMoveEnd.bind(this)),this.addChild(this.contents),this.resize(i,n)},i.prototype.resize=function(e,i){this.width=e,this.height=i,this.mask&&this.removeChild(this.mask);var n=new t.Graphics;n.beginFill(16777215,1),n.drawRect(0,0,this.width,this.height),n.endFill(),this.mask=n,this.addChild(this.mask),this.updateContentBounds()},i.prototype.addItem=function(t){this.contents.addChild(t),this.updateContentBounds()},i.prototype.scrollXAbsolute=function(t){this.constrainX||0>=t&&t>=this.width-this.contents.width&&(this.contents.position.x=Math.round(t))},i.prototype.scrollYAbsolute=function(t){this.constrainY||0>=t&&t>=this.height-this.contents.height&&(this.contents.position.y=Math.round(t))},i.prototype.scrollX=function(t){if(!this.constrainX){var e=this.contents.position.x+t;0>=e&&e>=this.width-this.contents.width&&(this.contents.position.x=Math.round(e))}},i.prototype.scrollY=function(t){if(!this.constrainY){var e=this.contents.position.y+t;0>=e&&e>=this.height-this.contents.height&&(this.contents.position.y=Math.round(e))}},i.prototype.scrollTop=function(){this.constrainY||(this.contents.position.y=0)},i.prototype.scrollBottom=function(){this.constrainY||(this.contents.position.y=this.height-this.contents.height)},i.prototype.scrollLeft=function(){this.constrainY||(this.contents.position.x=0)},i.prototype.scrollRight=function(){this.constrainY||(this.contents.position.x=this.width-this.contents.width)},i.prototype.updateContentBounds=function(){var e;if(e=this.computeAABB(this.contents),this.contents.width=e.width,this.contents.height=e.height,this.contents.hitArea=new t.Rectangle(0,0,e.width,e.height),this.constrainX)switch(this.constrainXType){case"left":this.contents.position.x=0;break;case"right":this.contents.position.x=this.width-this.contents.width;break;case"center":this.contents.position.x=(this.width-this.contents.width)/2}if(this.constrainY)switch(this.constrainYType){case"top":this.contents.position.y=0;break;case"bottom":this.contents.position.y=this.height-this.contents.height;break;case"center":this.contents.position.y=(this.height-this.contents.height)/2}},i.prototype.computeAABB=function(e){if(e instanceof t.Sprite)return new t.Rectangle(e.position.x,e.position.y,e.width,e.height);if(e instanceof t.DisplayObjectContainer){if(e.width&&e.height)return new t.Rectangle(e.position.x,e.position.y,e.width,e.height);if(e.children.length>0){for(var i=Number.MAX_VALUE,n=Number.MIN_VALUE,o=Number.MAX_VALUE,r=Number.MIN_VALUE,s=0;s<e.children.length;s+=1){var a=this.computeAABB(e.children[s]);a.x<i&&(i=a.x),a.y<o&&(o=a.y),a.x+a.width>n&&(n=a.x+a.width),a.y+a.height>r&&(r=a.y+a.height)}return i*=e.scale.x,n*=e.scale.x,o*=e.scale.y,r*=e.scale.y,new t.Rectangle(e.position.x+i,e.position.y+o,n-i,r-o)}return new t.Rectangle(e.position.x,e.position.y,0,0)}},i.prototype.onMoveStart=function(t){this.moving=!0,t.originalEvent.preventDefault();var e=t.getLocalPosition(this.parent);this.lastX=e.x,this.lastY=e.y,this.startX=e.x,this.startY=e.y,this.scrollArrow&&(this.addChild(this.scrollArrow),this.scrollArrow.position.x=e.x,this.scrollArrow.position.y=e.y,this.scrollArrow.anchor.x=this.scrollArrow.anchor.y=.5,this.scrollArrow.visible=!1)},i.prototype.onMove=function(t){if(this.moving){var e=t.getLocalPosition(this.parent),i=e.x,n=e.y,o=i-this.lastX,r=n-this.lastY;this.lastX=i,this.lastY=n,this.scrollY(r),this.scrollX(o),this.scrollArrow&&(this.scrollArrow.visible||(this.scrollArrow.visible=!0),this.constrainX||(this.scrollArrow.position.x=e.x),this.constrainY||(this.scrollArrow.position.y=e.y))}},i.prototype.onMoveEnd=function(t){this.moving=!1;{var e=t.getLocalPosition(this.parent),i=e.x,n=e.y;i-this.startX,n-this.startY}this.scrollArrow&&this.removeChild(this.scrollArrow),this.moveCompleteCallback&&this.moveCompleteCallback()},i.prototype.isChildVisible=function(e){this.contents.updateTransform();var i=new t.Rectangle(e.worldTransform.tx,e.worldTransform.ty,e.width,e.height),n=new t.Rectangle(this.worldTransform.tx,this.worldTransform.ty,this.width,this.height),o=n.contains(i.x+i.width/2,i.y+i.height/2),r=n.contains(i.x,i.y),s=n.contains(i.x+i.width,i.y),a=n.contains(i.x+i.width,i.y+i.height),h=n.contains(i.x+i.width,i.y+i.height);return o||r||s||a||h},i}),define("absolute/messagedialog",["pixi","absolute/dialog","lodash","absolute/button","absolute/coords","absolute/screenmetrics"],function(t,e,i,n,o,r){var s=function(t,e,n){var s={okFunc:function(){},displayOkButton:!0,okButtonText:"OK",okButtonImage:"dlg_btn_blank.png",okButtonTextStyle:{font:Math.floor(90*r.getResScale())+"px Ganache",align:"center",wordWrap:!0,wordWrapWidth:this.width-o.x(200)},textStyle:{font:Math.floor(80*r.getResScale())+"px Ganache",align:"center",wordWrap:!0,wordWrapWidth:this.width-o.x(200)}};this.initMessageDialog(t,e,i.extend(s,n))};return s.prototype=Object.create(e.prototype),s.prototype.initMessageDialog=function(i,r,s){if(e.call(this,i,s),this.ui=i,this.message=r,this.content=this.initContent(),this._setContent(this.content),this.options.displayOkButton){this.okButton=new n(t.Texture.fromFrame(this.options.okButtonImage),t.Texture.fromFrame(this.options.okButtonImage),function(){"function"==typeof this.options.okFunc&&this.options.okFunc()}.bind(this)),this.okButton.position.x=(this.width-this.okButton.width)/2,this.okButton.position.y=this.height-this.okButton.height,this.addChild(this.okButton);var a=new t.BitmapText(this.options.okButtonText,this.options.okButtonTextStyle);a.position.x=(this.okButton.width-a.textWidth)/2,a.position.y=o.y(-20),this.okButton.addChild(a)
}},s.prototype.initContent=function(){var e=new t.DisplayObjectContainer;return e.width=this.width,e.height=this.height,this.text=new t.BitmapText(this.message,this.options.textStyle),this.text.position.x=(e.width-this.text.textWidth)/2,this.text.position.y=o.y(120),e.addChild(this.text),e},s.prototype.setPosition=function(t,e,i){t.position.x=o.x(e),t.position.y=o.y(i)},s.prototype.setMessage=function(t){this.text.setText(t),setTimeout(function(){this.text.position.x=(this.width-this.text.textWidth)/2}.bind(this),10)},s}),define("absolute/integration",["absolute/debug","absolute/gameconfig"],function(t,e){var i={spil:{gameBreak:function(e,i){function n(){r||(e.call(this),r=!0),window.clearTimeout(o)}if(window.SpilGameAPIInstance&&!window.SpilGameAPIInstance.IS_STANDALONE&&window.SpilGameAPIInstance.GameBreak){var o,r=!1;window.SpilGameAPIInstance.GameBreak.request(i.bind(this),n.bind(this)),window.setTimeout(function(){t.log("ahg: Spil api failure: gamebreak"),n.call(this)}.bind(this),1e4)}else e.call(this)}},iwin:{ready:function(e){window.iConsole?window.iConsole.game.ready().result(function(){e.call(this)}):t.log("ahg: iWin api not available game ready failed.")},loadProgress:function(e){window.iConsole?window.iConsole.game.loadProgress({progress:e,file:"ahg: file name not available."}):t.log("ahg: iWin api not available loadProgress failed.")},loaded:function(e,i){window.iConsole?window.iConsole.game.loaded({success:e}):(t.log("ahg: iWin api not available loaded failed."),i.call(this))},levelStarted:function(t,e){window.iConsole?window.iConsole.game.levelStarted({level:t}).result(function(t){e.call(this,t)}.bind(this)):e.call(this)},levelFinished:function(t,e,i,n,o,r){window.iConsole?window.iConsole.game.levelFinished({level:e,score:i,time:n,won:o,data:r||{}}).result(function(){t.call(this)}):t.call(this)},getGameData:function(t,i){window.iConsole?window.iConsole.game.getGameData().result(function(e){var i={};if("undefined"!=typeof e&&null!==e&&""!==e)try{i=JSON.parse(e)}catch(n){}else i.data={};t.call(this,i.data)}.bind(this)):t.call(this,e.getVal(i))},setGameData:function(t,i){window.iConsole?window.iConsole.game.setGameData({data:t}):e.setVal(i,t)}}};return i}),define("absolute/lazyloadedsprite",["pixi","absolute/loader"],function(t,e){var i=function(t,e,i){this._initLazyLoadedSprite(t,e,i)};return i.constructor=i,i.prototype=Object.create(t.DisplayObjectContainer.prototype),i.prototype._initLazyLoadedSprite=function(e,i,n){t.DisplayObjectContainer.call(this),this.atlasName=e,this.assetName=i,this.placeholder=n,this.isLoaded=!1,this.isLoading=!1,this.addChild(this.placeholder)},i.prototype.load=function(i){if(t.TextureCache[this.assetName])this._replaceAsset();else{var n=new e;this.isLoading=!0,n.loadArt([{name:this.atlasName}],function(){},function(){this._replaceAsset(),this.isLoaded=!0,"function"==typeof i&&i(this)}.bind(this))}},i.prototype._replaceAsset=function(){this.asset=t.Sprite.fromFrame(this.assetName),this.placeholder.addChild(this.asset)},Object.defineProperty(i.prototype,"loaded",{get:function(){return this.isLoaded}}),Object.defineProperty(i.prototype,"loading",{get:function(){return this.isLoading}}),Object.defineProperty(i.prototype,"width",{get:function(){return this.placeholder.width*this.placeholder.scale.x}}),Object.defineProperty(i.prototype,"height",{get:function(){return this.placeholder.height*this.placeholder.scale.y}}),i}),define("absolute/utils",[],function(){var t={makeGUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,i="x"==t?e:3&e|8;return i.toString(16)})},makeUniqueId:function(){return"yxxxxxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,i="x"==t?e:3&e|8;return i.toString(16)})}};return t}),define("absolute",["require","absolute/asyncqueue","absolute/audiomanager","absolute/button","absolute/snapshot","absolute/coords","absolute/platform","absolute/screenmetrics","absolute/digitlabel","absolute/debug","absolute/digitsprite","absolute/eventbus","absolute/gameconfig","absolute/storagemanager","absolute/spriteutils","absolute/game","absolute/gameui","absolute/textutils","absolute/togglebutton","absolute/musicmanager","absolute/progressbar","absolute/progressdial","absolute/tweenutils","absolute/screen","absolute/simplemessagebox","absolute/spritemessagebox","absolute/loader","absolute/layouthelper","absolute/draggable","absolute/analytics","absolute/dialog","absolute/shims","absolute/sprite","absolute/texture","absolute/mathutils","absolute/randomutils","absolute/pageindicator","absolute/multipagedialog","absolute/graphserializer","absolute/scrollarea","absolute/textbutton","absolute/nineslice","absolute/messagedialog","absolute/integration","absolute/assetmap","absolute/uibuilder","absolute/stringmanager","absolute/animatedbutton","absolute/animatedtextbutton","absolute/lazyloadedsprite","absolute/utils"],function(t){"use strict";return{version:"1.0",AsyncQueue:t("absolute/asyncqueue"),AudioManager:t("absolute/audiomanager"),Button:t("absolute/button"),Snapshot:t("absolute/snapshot"),Coords:t("absolute/coords"),Platform:t("absolute/platform"),ScreenMetrics:t("absolute/screenmetrics"),DigitLabel:t("absolute/digitlabel"),Debug:t("absolute/debug"),DigitSprite:t("absolute/digitsprite"),EventBus:t("absolute/eventbus"),GameConfig:t("absolute/gameconfig"),StorageManager:t("absolute/storagemanager"),SpriteUtils:t("absolute/spriteutils"),Game:t("absolute/game"),GameUI:t("absolute/gameui"),TextUtils:t("absolute/textutils"),ToggleButton:t("absolute/togglebutton"),MusicManager:t("absolute/musicmanager"),ProgressBar:t("absolute/progressbar"),ProgressDial:t("absolute/progressdial"),TweenUtils:t("absolute/tweenutils"),Screen:t("absolute/screen"),SimpleMessageBox:t("absolute/simplemessagebox"),SpriteMessageBox:t("absolute/spritemessagebox"),Loader:t("absolute/loader"),LayoutHelper:t("absolute/layouthelper"),Draggable:t("absolute/draggable"),Analytics:t("absolute/analytics"),Dialog:t("absolute/dialog"),Shims:t("absolute/shims"),Sprite:t("absolute/sprite"),Texture:t("absolute/texture"),MathUtils:t("absolute/mathutils"),RandomUtils:t("absolute/randomutils"),PageIndicator:t("absolute/pageindicator"),MultiPageDialog:t("absolute/multipagedialog"),GraphSerializer:t("absolute/graphserializer"),ScrollArea:t("absolute/scrollarea"),TextButton:t("absolute/textbutton"),NineSlice:t("absolute/nineslice"),MessageDialog:t("absolute/messagedialog"),Integration:t("absolute/integration"),AssetMap:t("absolute/assetmap"),UIBuilder:t("absolute/uibuilder"),StringManager:t("absolute/stringmanager"),AnimatedButton:t("absolute/animatedbutton"),AnimatedTextButton:t("absolute/animatedtextbutton"),LazyLoadedSprite:t("absolute/lazyloadedsprite"),Utils:t("absolute/utils")}}),define("petengine/parallaxlayer",["pixi","absolute"],function(t,e){var i=function(t,e,i){this.initParallaxLayer(t,e,i)};return i.prototype=Object.create(t.DisplayObjectContainer.prototype),i.prototype.initParallaxLayer=function(e,i,n){t.DisplayObjectContainer.call(this),this.ui=e,this.game=i,this.scenes=[];var o=0,r=this.generateScene(null);for(r.position.x=o,this.scenes.push(r),this.addChild(r),o+=r.width;o<this.ui.width+this.scenes[0].width;)r=this.generateScene(null),r.position.x=o,this.scenes.push(r),this.addChild(r),o+=r.width;this.originalVelocity=n,this.velocityX=n,this.px=0},i.prototype.setVelocity=function(t){this.velocityX=this.originalVelocity*t},i.prototype.beforeRender=function(){if(this.lastTime){var t=Date.now(),i=(t-this.lastTime)*this.velocityX;this.px-=i;for(var n=Math.floor(e.Coords.x(this.px)),o=0;o<this.scenes.length;o+=1)this.scenes[o].position.x=n,n+=this.scenes[o].width;this.scenes[0].position.x<-this.scenes[0].width&&(this.scenes.push(this.scenes.shift()),this.scenes[this.scenes.length-1].position.x=n,this.px=0),this.lastTime=t}else this.lastTime=Date.now()},i.prototype.afterRender=function(){},i.prototype.generateScene=function(){},i.prototype.handlePause=function(){},i.prototype.handleResume=function(){this.lastTime=Date.now()},i.prototype.initLevel=function(){this.lastTime=null,this.px=0},i}),define("artconfig",[],function(){"use strict";var t={logo:"mainmenu_logo.png",loadingBarFrame:"loading_bar_frame.png",loadingBarFill:"loading_bar_marker.png",petStoreButton:"btn_care_puppy.png",environmentStoreButton:"btn_care_yard.png",trainButton:"btn_racemode_toggle.png",pauseButton:"btn_OPTIONS.png",storePetItems:["care_puppy_sponge.png","care_puppy_crackers.png","care_puppy_cookie.png","care_puppy_bacon.png","care_puppy_hotdog.png","care_puppy_steak.png"],storeEnvironmentItems:["care_friends_bee.png","care_friends_butterfly.png","care_friends_mouse.png","care_friends_gopher.png","care_toys_bandball.png","care_toys_frisbee.png","care_toys_hedgehog.png","care_toys_rope.png","care_toys_tennisball.png","care_yard_barrel.png","care_yard_elephant.png","care_yard_flowerbox.png","care_yard_shrub.png","care_yard_tire.png","care_yard_tirerope.png","care_puppy_doghouse.png","care_puppy_dogwater.png","care_puppy_dogfood.png","care_puppy_treatbox.png"],positionedBackgroundItems:[{url:"Bush_fence.png",x:52,y:419},{url:"tree_large.png",x:12,y:345},{url:"greenhouse.png",x:306,y:410}],positionedForegroundItems:[{url:"flower_btn_leftback.png",x:0,y:918},{url:"flower_btn_leftfront.png",x:0,y:1221},{url:"flower_btn_rightback.png",x:1732,y:868},{url:"flower_btn_rightfront.png",x:1407,y:1221}],randomItemSpacing:100,randomBackgroundItems:[{url:"yard_flowers_random1.png",fillDensity:.02},{url:"yard_flowers_random2.png",fillDensity:.01},{url:"yard_flowers_random3.png",fillDensity:.08},{url:"yard_flowers_random4.png",fillDensity:.08}],hudPetHealthIcon:{url:"meter_dolphin_icon.png",x:1,y:15},hudPetHealthText:{url:"",x:0,y:0},hudEnvironmentHealthIcon:{url:"meter_water_icon.png",x:15,y:-10},hudEnvironmentHealthText:{url:"",x:0,y:0},hudScoreIcon:{url:"statusdock_pearls.png"},hudScoreText:{x:185,y:55},background:{url:"tile_cloud_line.png",x:0,y:256},middleGround:{url:"tile_fence_line.png",x:0,y:400},backgroundGradient:[{location:0,color:"#359ccf"},{location:.15,color:"#6fcef8"},{location:.4,color:"#7cd5fb"},{location:.42,color:"#61892d"},{location:.5,color:"#5e872c"},{location:.6,color:"#7ca63e"},{location:.73,color:"#7ca63e"},{location:.9,color:"#4f7926"},{location:1,color:"#2a4d14"}],trainingPauseButton:"btn_ingame_OPTIONS.png",hudPanel:"HUD_panel.png",hudPetIcon:{url:"HUD_puppy_icon.png",y:32}};return t}),define("petengine/foregroundlayer",["pixi","absolute","petengine/parallaxlayer","artconfig"],function(t,e,i){var n=function(t,e,i){this.initForegroundLayer(t,e,i)};return n.prototype=Object.create(i.prototype),n.prototype.initForegroundLayer=function(t,e,n){this.ui=t,this.game=e,i.call(this,t,e,n)},n.prototype.generateScene=function(){},n}),define("customforegroundlayer",["pixi","absolute","petengine/foregroundlayer","artconfig"],function(t,e,i,n){var o=function(t,e,i){this.initCustomForegroundLayer(t,e,i)};return o.prototype=Object.create(i.prototype),o.prototype.initCustomForegroundLayer=function(t,e,n){this.ui=t,this.game=e,i.call(this,t,e,n)},o.prototype.generateScene=function(i){var o;if(i)o=i;else{o=new t.DisplayObjectContainer;var r=new t.Rectangle(0,e.Coords.y(1050),this.ui.width,this.ui.height-e.Coords.y(550)),s={minSpacing:n.randomItemSpacing,minScale:.4},a=new t.DisplayObjectContainer;o.addChild(e.RandomUtils.distributeItems(this.ui,n.randomBackgroundItems,r,a,s)),o.width=r.width}return o},o}),define("petengine/midgroundlayer",["pixi","absolute","petengine/parallaxlayer","artconfig"],function(t,e,i,n){var o=function(t,e,i){this.initMidgroundLayer(t,e,i)};return o.prototype=Object.create(i.prototype),o.prototype.initMidgroundLayer=function(t,e,n){this.ui=t,this.game=e,i.call(this,t,e,n)},o.prototype.generateScene=function(i){var o;if(i)o=i;else{o=new t.DisplayObjectContainer;var r=e.Sprite.fromFrame(n.middleGround.url);r.position.x=0,r.position.y=e.Coords.y(n.middleGround.y),o.addChild(r),o.width=r.width}return o},o}),define("petengine/obstacle",["pixi","absolute"],function(t,e){var i=function(t,e,i){this.initObstacle(t,e,i)};return i.prototype.initObstacle=function(t,e,i){this.type=t,this.x=e,this.game=i,this.obstacleBack=null,this.obstacleFront=null,this.collided=!1,this.collisionIsFail="undefined"!=typeof this.collisionIsFail?this.collisionIsFail:!1,this.initSprites(),this.setPosition()},i.prototype.setPosition=function(){this.obstacleBack&&(this.obstacleBack.position.x+=e.Coords.x(this.x)),this.obstacleFront&&(this.obstacleFront.position.x+=e.Coords.x(this.x))},i.prototype.reset=function(){this.obstacleFront&&this.obstacleFront.parent&&this.obstacleFront.parent.removeChild(this.obstacleFront),this.obstacleBack&&this.obstacleBack.parent&&this.obstacleBack.parent.removeChild(this.obstacleBack),this.initObstacle(this.type,this.x,this.game)},Object.defineProperty(i.prototype,"front",{get:function(){return this.obstacleFront}}),Object.defineProperty(i.prototype,"back",{get:function(){return this.obstacleBack}}),i.prototype.getEdges=function(t){var e=this.obstacleFront||this.obstacleBack;return{left:e.position.x-e.width*t,right:e.position.x+e.width+e.width*t,top:e.position.y-e.height*t,bottom:e.position.y+e.height+e.height*t}},i.prototype.intersects=function(t,e,i){return e>t.left&&e<t.right&&i>t.top&&i<t.bottom},i.prototype.pastPet=function(t){var e=this.obstacleFront||this.obstacleBack;return e.position.x+e.width<t},i.prototype.aheadOfPet=function(t){var e=this.obstacleFront||this.obstacleBack;return t<e.position.x-e.pivot.x},i.prototype.success=function(){},i.prototype.collide=function(){},i.prototype.globalPosition=function(){return new t.Point(this.front.worldTransform.tx,this.front.worldTransform.ty)},i.prototype.getPoints=function(){return this.points},i}),define("petengine/wallet",["absolute"],function(t){var e=function(t){this.initWallet(t),this.maxBalance=999};return e.prototype.initWallet=function(t){this.localStorageKey="cash",this.config=t.levelConfig,this.updateWalletState()},e.prototype._save=function(){t.GameConfig.setVal(this.localStorageKey,this.walletState)},e.prototype._load=function(){return t.GameConfig.getVal(this.localStorageKey)},e.prototype.updateWalletState=function(){var t=this._load();"undefined"==typeof t?(this.walletState={balance:this.config.startingCurrencyBalance},this._save()):this.walletState=t},e.prototype.setBalance=function(e){this.walletState.balance=e,this._save(),t.EventBus.dispatchEvent("Wallet:BalanceChange")},e.prototype.getBalance=function(){return this.updateWalletState(),this.walletState.balance},e.prototype.deposit=function(e){var i=this.getBalance()+e;i<=this.maxBalance&&this.setBalance(i),t.EventBus.dispatchEvent("Wallet:Deposit")},e.prototype.withdraw=function(t){var e=this.getBalance()-t;return e>=0?(this.setBalance(this.getBalance()-t),!0):!1},e}),define("trainingpet",["absolute","pixi","absoluteaudio"],function(t,e,i){var n=function(t,e){this.initTrainingPet(t,e)};return n.prototype=Object.create(e.DisplayObjectContainer.prototype),n.prototype.initTrainingPet=function(e,i){this.loader=new t.Loader,this.animation=null,this.collisionBone=null,this.ui=e,this.loadComplete=i||function(){},this.loadAssets()},n.prototype.loadAssets=function(){this.loader.loadArt(["training"],function(){},function(){this._loadTrainingAnimations()}.bind(this))},n.prototype._loadTrainingAnimations=function(){this.animation=new e.Spine(t.Platform.artPathPrefix+"/"+t.ScreenMetrics.getResClass()+"/training.json"),this.setStartPosition(),this.animation.stateData.setMixByName("jump_in","jump2_in",.2),this.animation.stateData.setMixByName("jump_out","run_loop",.1),this.animation.stateData.setMixByName("jump2_out","run_loop",.2),this.animation.state.setAnimationByName("run_loop",!0),window.setTimeout(function(){this.loadComplete()}.bind(this),100)},n.prototype.setStartPosition=function(){this.animation.position.x=t.Coords.x(375),this.animation.position.y=t.Coords.y(1200),i.context.usingWebAudio()&&(t.AudioManager.stopSound("puppy_running"),t.AudioManager.playSound("puppy_running",!0))},n.prototype.getCollisionBone=function(){if(!this.collisionBone)for(var t=0;t<this.animation.skeleton.bones.length;t+=1)if("head"===this.animation.skeleton.bones[t].data.name){this.collisionBone=this.animation.skeleton.bones[t];break}return this.collisionBone},n.prototype.tap=function(){if(this.animation){var e=1350;i.context.usingWebAudio()&&t.AudioManager.stopSound("puppy_running"),window.clearTimeout(this.runningSoundTimeout),"run_loop"===this.animation.state.current.name?(i.context.usingWebAudio()&&t.AudioManager.playSound("puppy_jump"),this.animation.state.setAnimationByName("jump_in"),this.animation.state.addAnimationByName("jump_out"),this.animation.state.addAnimationByName("run_loop",!0)):"jump_in"===this.animation.state.current.name?(i.context.usingWebAudio()&&t.AudioManager.playSound("puppy_jump"),this.animation.state.setAnimationByName("jump2_in"),this.animation.state.addAnimationByName("jump2_out"),this.animation.state.addAnimationByName("run_loop",!0),e=1400):"jump2_in"===this.animation.state.current.name&&(i.context.usingWebAudio()&&t.AudioManager.playSound("puppy_flip"),this.animation.state.setAnimationByName("frontflip"),this.animation.state.addAnimationByName("jump2_out"),this.animation.state.addAnimationByName("run_loop",!0),e=1e3),this.runningSoundTimeout=window.setTimeout(function(){i.context.usingWebAudio()&&t.AudioManager.playSound("puppy_running",!0)}.bind(this),e)}},n}),define("obstaclehoop",["pixi","absolute","petengine/obstacle"],function(t,e,i){var n=function(t,e,i){this.initHoopObstacle(t,e,i)};return n.prototype=Object.create(i.prototype),n.prototype.initHoopObstacle=function(t,e,n){this.points=1,i.call(this,t,e,n)},n.prototype.initSprites=function(){this.obstacleFront=e.Sprite.fromFrame("hoop_front.png"),this.obstacleBack=e.Sprite.fromFrame("hoop_back.png"),this.obstacleBack.pivot.y=this.obstacleFront.pivot.y=this.obstacleFront.texture.height/2,this.obstacleFront.position.y=this.obstacleBack.position.y="H"===this.type?e.Coords.y(220)+this.obstacleFront.texture.height/2:e.Coords.y(400)+this.obstacleFront.texture.height/2},n.prototype.intersects=function(t,e){var n=this.getEdges(0);return n.top=this.obstacleFront.position.y-this.obstacleFront.height/2,n.bottom=this.obstacleFront.position.y+this.obstacleFront.height/2,i.prototype.intersects.call(this,n,t,e)},n.prototype.success=function(){e.AudioManager.playSound("success_hoop")},n.prototype.collide=function(t){var e=this;this.collided=!0;var i=new TWEEN.Tween({rotation:0}).to({rotation:.01},50).easing(TWEEN.Easing.Cubic.Out).onUpdate(function(){e.obstacleFront.rotation=this.rotation,e.obstacleBack.rotation=this.rotation}).start(),n=new TWEEN.Tween({rotation:.01}).to({rotation:-.01},100).yoyo(!0).repeat(10).easing(TWEEN.Easing.Cubic.Out).onUpdate(function(){e.obstacleFront.rotation=this.rotation,e.obstacleBack.rotation=this.rotation});i.chain(n),t.level.updateScore(this.points),this.success()},n}),define("obstaclepuddle",["pixi","absolute","petengine/obstacle"],function(t,e,i){var n=function(t,e,i){this.initHoopObstacle(t,e,i)};return n.prototype=Object.create(i.prototype),n.prototype.initHoopObstacle=function(t,e,n){this.points=1,this.collisionIsFail=!0,i.call(this,t,e,n)},n.prototype.initSprites=function(){this.obstacleBack=e.Sprite.fromFrame("run_puddle_hurdle.png"),this.obstacleBack.position.y=e.Coords.y(1e3),this.splash?this.obstacleBack.addChild(this.splash):this.loadSplash()},n.prototype.loadSplash=function(){var i=new e.Loader;i.loadArt(["splash"],function(){},function(){this.splash=new t.Spine(e.Platform.artPathPrefix+"/"+e.ScreenMetrics.getResClass()+"/splash.json"),this.splash.position.x=(this.obstacleBack.width-e.Coords.x(50))/2,this.splash.position.y=(this.obstacleBack.height-e.Coords.y(0))/2,this.splash.scale.x=this.splash.scale.y=1.75,this.splash.visible=!1,this.obstacleBack.addChild(this.splash)}.bind(this))},n.prototype.intersects=function(t,e){var n,o=this.getEdges(0);return n=i.prototype.intersects.call(this,o,t,e),n&&(this.points=0),n},n.prototype.success=function(t){this.collided=!0,t.level.updateScore(this.points),e.AudioManager.playSound("success_ring")},n.prototype.collide=function(){this.collided||(this.collided=!0,this.splash.state.setAnimationByName("generic_splash"),this.splash.visible=!0,setTimeout(function(){this.splash.visible=!1}.bind(this),1200),e.AudioManager.playSound("fail_puddle"))},n}),define("obstaclestart",["pixi","absolute","petengine/obstacle"],function(t,e,i){var n=function(t,e,i){this.initHoopObstacle(t,e,i)};return n.prototype=Object.create(i.prototype),n.prototype.initHoopObstacle=function(t,e,n){this.points=0,i.call(this,t,e,n)},n.prototype.initSprites=function(){this.obstacleFront=e.Sprite.fromFrame("run_flag_go.png"),this.obstacleFront.position.y=e.Coords.y(1050)},n.prototype.intersects=function(t,e){var n=this.getEdges(0),o=i.prototype.intersects.call(this,n,t,e);return o},n.prototype.success=function(){},n}),define("obstaclefinish",["pixi","absolute","petengine/obstacle"],function(t,e,i){var n=function(t,e,i){this.initHoopObstacle(t,e,i)};return n.prototype=Object.create(i.prototype),n.prototype.initHoopObstacle=function(t,e,n){this.points=0,i.call(this,t,e,n)},n.prototype.initSprites=function(){this.obstacleFront=e.Sprite.fromFrame("run_flag_finishfront.png"),this.obstacleBack=e.Sprite.fromFrame("run_flag_finishback.png"),this.obstacleBack.position.y=e.Coords.y(900),this.obstacleBack.position.x=this.obstacleFront.position.x-e.Coords.x(125),this.obstacleFront.position.y=e.Coords.y(1050)},n.prototype.intersects=function(t,e){var n=this.getEdges(0),o=i.prototype.intersects.call(this,n,t,e);return o},n}),define("obstacletreat",["pixi","absolute","petengine/obstacle","tween"],function(t,e,i,n){var o=function(t,e,i){this.initHoopObstacle(t,e,i)};return o.prototype=Object.create(i.prototype),o.prototype.initHoopObstacle=function(n,o,r){this.points=1,this.scoreboardLocation=new t.Point(e.Coords.x(1800),e.Coords.y(100)),i.call(this,n,o,r)},o.prototype.initSprites=function(){this.obstacleFront=e.Sprite.fromFrame("lone_pearl.png"),this.obstacleFront.position.y=e.Coords.y("P"===this.type?400:700)},o.prototype.intersects=function(t,e){var n=this.getEdges(1.5),o=i.prototype.intersects.call(this,n,t,e);return o},o.prototype.success=function(t){e.AudioManager.playSound("puppy_bone_"+(t+1))},o.prototype.collide=function(t,e){this.collided||(this.collided=!0,this.doCollisionAnimation(t),this.success(e))},o.prototype.doCollisionAnimation=function(t){for(var i=this.globalPosition(),o=0;o<this.points;o+=1)this.obstacleFront.position.x=i.x,this.obstacleFront.position.y=i.y,this.obstacleFront.pivot.x=this.obstacleFront.width/2,this.obstacleFront.pivot.y=this.obstacleFront.height/2,t.addChild(this.obstacleFront),this.doCurrencyAnimation(t);var r=e.Sprite.fromFrame("lone_pearl_bling.png");r.pivot.x=r.width/2,r.pivot.y=r.height/2,r.position.x=i.x-this.obstacleFront.width/2,r.position.y=i.y+this.obstacleFront.height/2,t.addChild(r),new n.Tween({scale:r.scale.x,alpha:1}).delay(10).to({scale:10,alpha:0},200).easing(n.Easing.Cubic.In).onUpdate(function(){r.alpha=this.alpha,r.scale.x=r.scale.y=this.scale}).onComplete(function(){t.removeChild(r)}).start()},o.prototype.doCurrencyAnimation=function(t){var e=[this.scoreboardLocation.x/2,this.scoreboardLocation.x],i=[this.obstacleFront.position.y,this.scoreboardLocation.y],o=this;new n.Tween({x:this.obstacleFront.position.x,y:this.obstacleFront.position.y}).delay(10).to({x:e,y:i},800).easing(n.Easing.Cubic.In).onUpdate(function(){o.obstacleFront.position.x=this.x,o.obstacleFront.position.y=this.y,o.obstacleFront.rotation+=.2}).onComplete(function(){try{t.removeChild(o.obstacleFront)}catch(e){o.obstacleFront.visible=!1}t.level.updateScore(1),t.wallet.deposit(1)}).interpolation(n.Interpolation.Bezier).start()},o}),define("obstaclehurdle",["pixi","absolute","petengine/obstacle"],function(t,e,i){var n=function(t,e,i){this.initHoopObstacle(t,e,i)};return n.prototype=Object.create(i.prototype),n.prototype.initHoopObstacle=function(t,e,n){this.points=1,this.collisionIsFail=!0,i.call(this,t,e,n)},n.prototype.initSprites=function(){this.obstacleBack=e.Sprite.fromFrame("run_hurdle_back.png"),this.obstacleBack.position.y=e.Coords.y(820),this.limboStickBack=e.Sprite.fromFrame("run_hurdle_bar.png"),this.obstacleBack.addChild(this.limboStickBack),this.obstacleFront=e.Sprite.fromFrame("run_hurdle_front.png"),this.obstacleFront.position.y=e.Coords.y(860),this.limboStickFront=e.Sprite.fromFrame("run_hurdle_bar_front.png"),this.obstacleFront.addChild(this.limboStickFront)},n.prototype.setPosition=function(){this.tween1&&this.tween1.stop(),this.tween2&&this.tween2.stop(),this.tween3&&this.tween3.stop(),this.obstacleBack.position.x+=e.Coords.x(this.x),this.obstacleFront.position.x+=e.Coords.x(this.x)+e.Coords.x(180),this.limboStickBack.position.x=e.Coords.x(30),this.limboStickBack.position.y=e.Coords.y(140),this.limboStickFront.position.x=e.Coords.x(-150),this.limboStickFront.position.y=e.Coords.y(100)},n.prototype.intersects=function(t,e){var n=this.getEdges(0),o=i.prototype.intersects.call(this,n,t,e);return o&&(this.points=0),o},n.prototype.success=function(t){this.collided=!0,t.level.updateScore(this.points),e.AudioManager.playSound("success_ring")},n.prototype.collide=function(){if(!this.collided){this.collided=!0;var t=this,i=this.limboStickBack.position.x+e.Coords.x(600+200*Math.random()),n=this.limboStickBack.position.x+i,o=this.limboStickFront.position.x+i,r=e.Coords.y(300+50*Math.random()),s=this.limboStickBack.position.y-r,a=this.limboStickFront.position.y-r,h=e.Coords.y(200),l=this.limboStickBack.position.y+h,u=this.limboStickFront.position.y+h;this.tween1=new TWEEN.Tween({yFront:this.limboStickFront.position.y,yBack:this.limboStickBack.position.y}).to({yFront:a,yBack:s},400).easing(TWEEN.Easing.Cubic.Out).onUpdate(function(){t.limboStickBack.position.y=this.yBack,t.limboStickFront.position.y=this.yFront}).start(),this.tween2=new TWEEN.Tween({xFront:this.limboStickFront.position.x,xBack:this.limboStickBack.position.x}).delay(100).to({xFront:o,xBack:n},2500).easing(TWEEN.Easing.Cubic.Out).onUpdate(function(){t.limboStickBack.position.x=this.xBack,t.limboStickFront.position.x=this.xFront}).start(),this.tween3=smackDown=new TWEEN.Tween({yFront:a,yBack:s}).to({yFront:u,yBack:l},800).easing(TWEEN.Easing.Bounce.Out).onUpdate(function(){t.limboStickBack.position.y=this.yBack,t.limboStickFront.position.y=this.yFront}),this.tween1.chain(this.tween3),e.AudioManager.playSound("fail_hurdle")}},n}),define("obstaclefrisbee",["pixi","absolute","petengine/obstacle"],function(t,e,i){var n=function(t,e,i){this.initHoopObstacle(t,e,i)};return n.prototype=Object.create(i.prototype),n.prototype.initHoopObstacle=function(t,e,n){this.points=1,i.call(this,t,e,n)},n.prototype.initSprites=function(){this.obstacleFront=e.Sprite.fromFrame("frisbee.png"),this.obstacleFront.pivot.x=this.obstacleFront.width/2,this.obstacleFront.pivot.y=this.obstacleFront.height/2,this.obstacleFront.position.y=e.Coords.y("B"===this.type?450:725)},n.prototype.intersects=function(t,e){var n={},o=1.5;return n.top=this.obstacleFront.position.y-this.obstacleFront.height/2-this.obstacleFront.height*o,n.left=this.obstacleFront.position.x-this.obstacleFront.width/2-this.obstacleFront.width*o,n.right=this.obstacleFront.position.x+this.obstacleFront.width/2+this.obstacleFront.width*o,n.bottom=this.obstacleFront.position.y+this.obstacleFront.height/2+this.obstacleFront.height*o,i.prototype.intersects.call(this,n,t,e)},n.prototype.success=function(){e.AudioManager.playSound("success_ring")},n.prototype.collide=function(t){if(!this.collided){this.collided=!0,t.level.updateScore(this.points);var e=this,i=this.obstacleFront.position.x-400,n=this.obstacleFront.position.y-(300+100*Math.random());new TWEEN.Tween({x:this.obstacleFront.position.x,y:this.obstacleFront.position.y}).to({x:i,y:n},600).easing(TWEEN.Easing.Cubic.Out).onUpdate(function(){e.obstacleFront.position.x=this.x,e.obstacleFront.position.y=this.y,e.obstacleFront.rotation+=.4}).start(),this.success()}},n}),define("obstaclefactory",["pixi","absolute","obstaclehoop","obstaclepuddle","obstaclestart","obstaclefinish","obstacletreat","obstaclehurdle","obstaclefrisbee"],function(t,e,i,n,o,r,s,a,h){var l={makeObstacle:function(t,e,l){switch(t.toLowerCase()){case"b":return new h(t,e,l);case"r":return new n(t,e,l);case"h":return new i(t,e,l);case"s":return new o(t,e,l);case"f":return new r(t,e,l);case"p":return new s(t,e,l);case"i":return new a(t,e,l)}},makeHudIcon:function(t,i){var n;switch(t.toLowerCase()){case"b":n=e.Sprite.fromFrame("HUD_puppy_frisbee.png"),n.position.y=(i-n.height)/2-e.Coords.y(4);break;case"r":n=e.Sprite.fromFrame("HUD_puppy_puddle.png"),n.position.y=e.Coords.y(80);break;case"h":n=e.Sprite.fromFrame("HUD_puppy_hoop.png"),n.position.y=(i-n.height)/2-e.Coords.y(4);break;case"s":break;case"f":n=e.Sprite.fromFrame("HUD_dolphin_finishline.png"),n.position.y=(i-n.height)/2-e.Coords.y(4);break;case"p":n=e.Sprite.fromFrame("HUD_puppy_treat.png"),n.position.y=(i-n.height)/2-e.Coords.y(4);break;case"i":n=e.Sprite.fromFrame("HUD_puppy_hurdle.png"),n.position.y=(i-n.height)/2-e.Coords.y(4)}return n}};return l}),define("petengine/obstaclelayer",["pixi","absolute","petengine/obstacle","petengine/wallet","trainingpet","obstaclefactory"],function(t,e,i,n,o,r){var s=function(t,e,i){this.initObstacleLayer(t,e,i)};return s.prototype=Object.create(t.DisplayObjectContainer.prototype),s.prototype.initObstacleLayer=function(e,i,o){t.DisplayObjectContainer.call(this),this.ui=e,this.game=i,this.originalVelocity=o,this.velocityX=o,this.wallet=new n(this.game),this.pet=null,this.obstacleSpacing=this.game.levelConfig.obstacleSpacerWidth},s.prototype.initLevel=function(e){var i=!0;e===this.level&&(i=!1),this.level=e,this.complete=!1,this.sceneReady=!1,this.lastTime=null,this.px=0,this.sceneFront&&this.removeChild(this.sceneFront),this.sceneBack&&this.removeChild(this.sceneBack),i?(this.sceneBack=new t.DisplayObjectContainer,this.sceneFront=new t.DisplayObjectContainer,this.obstacles=[],this.generateScene()):this.resetScene(),this.pet?this.onPetLoaded():this.pet=new o(this.ui,this.onPetLoaded.bind(this)),this.previousObstacleCollission="",this.obstacleConsecutiveHitCounts={}},s.prototype.onPetLoaded=function(){this.pet.setStartPosition(),this.head=this.pet.getCollisionBone(),this.addChild(this.sceneBack),this.addChild(this.pet.animation),this.addChild(this.sceneFront)},s.prototype.tap=function(){this.pet&&this.pet.tap()},s.prototype.resetScene=function(){for(var t=0;t<this.obstacles.length;t+=1){var e=this.obstacles[t];e.reset(),e.back&&this.sceneBack.addChild(e.back),e.front&&this.sceneFront.addChild(e.front)}this.sceneBack.position.x=0,this.sceneFront.position.x=0,this.sceneReady=!0},s.prototype.generateScene=function(){if(this.level){this.sceneBack.width=e.Coords.y(this.level.config.obstacles.length*this.obstacleSpacing),this.sceneFront.width=e.Coords.y(this.level.config.obstacles.length*this.obstacleSpacing);for(var t=0;t<this.level.config.obstacles.length;t+=1){var i=this.level.config.obstacles[t];if("-"!==i){var n=r.makeObstacle(i,t*this.obstacleSpacing,this.game);n.back&&this.sceneBack.addChild(n.back),n.front&&this.sceneFront.addChild(n.front),this.obstacles.push(n)}}}this.sceneReady=!0},s.prototype.setVelocity=function(t){this.velocityX=this.originalVelocity*t},s.prototype.setPetExitVelocity=function(t){this.pet.velocityX=this.originalVelocity*t},s.prototype.beforeRender=function(t){if(this.sceneFront&&this.sceneBack)if(this.lastTime){var i=Date.now();if(this.px-=(i-this.lastTime)*this.velocityX,this.sceneBack.position.x=Math.floor(e.Coords.x(this.px)),this.sceneFront.position.x=Math.floor(e.Coords.x(this.px)),t&&(this.pet.animation.position.x+=Math.floor(e.Coords.x((i-this.lastTime)*this.pet.velocityX))),this.lastTime=i,this.head)for(var n=this.head.worldX+this.pet.animation.position.x-Math.floor(e.Coords.x(this.px)),o=this.head.worldY+this.pet.animation.position.y,r=0;r<this.obstacles.length;r+=1){var s=this.obstacles[r],a=s.type.toLowerCase();
if(!s.collided){if(s.aheadOfPet(n))break;if(s.intersects(n,o)){this.previousObstacleCollission==a?this.obstacleConsecutiveHitCounts[a]++:this.obstacleConsecutiveHitCounts[a]=0,s.collide(this,this.obstacleConsecutiveHitCounts[a]),this.previousObstacleCollission=a;break}if(s.pastPet(n)&&s.collisionIsFail){s.success(this),this.previousObstacleCollission=a;break}}}}else this.lastTime=Date.now(),this.px=0},s.prototype.afterRender=function(){},s.prototype.isComplete=function(){if(!this.sceneReady||!this.obstacles||!this.sceneFront||0==this.obstacles.length)return!1;var t=this.obstacles[this.obstacles.length-1].obstacleFront||this.obstacles[this.obstacles.length-1].obstacleBack;return t.position.x+this.sceneFront.position.x<0},s.prototype.getPosition=function(){return this.px},s.prototype.handlePause=function(){},s.prototype.handleResume=function(){this.lastTime=+new Date},s}),define("customdistantbackgroundlayer",["pixi","absolute","petengine/foregroundlayer","artconfig"],function(t,e,i){var n=function(t,e,i,n){this.initCustomDistantBackgroundLayer(t,e,i,n)};return n.prototype=Object.create(i.prototype),n.prototype.initCustomDistantBackgroundLayer=function(t,e,n,o){this.ui=t,this.game=e,this.opacity=o,i.call(this,t,e,n)},n.prototype.generateScene=function(e){var i;return i=e?e:new t.DisplayObjectContainer},n}),define("petengine/trainingview",["pixi","absolute","customforegroundlayer","petengine/midgroundlayer","petengine/obstaclelayer","artconfig","customdistantbackgroundlayer"],function(t,e,i,n,o,r,s){var a=function(t,e,i){this.initTrainingView(t,e,i)};return a.prototype=Object.create(t.DisplayObjectContainer.prototype),a.prototype.initTrainingView=function(e,r,a){t.DisplayObjectContainer.call(this),this.ui=e,this.game=r,this.screen=a,this.levelComplete=!1,this.velocity=.1,this.vsBackground1=.01,this.vsBackground2=.03,this.vsMidground=.06,this.vsForeground=.3,this.deceleration=-.01,this.petLayerIndex=4,this.layers=[],this.layers.push(new s(this.ui,this.game,this.vsBackground1,{minSpacing:1500,minScale:.95,maxScale:.95,shade:.5})),this.layers.push(new s(this.ui,this.game,this.vsBackground2,{minSpacing:1500,minScale:1,maxScale:1.2,shade:0})),this.layers.push(new n(this.ui,this.game,this.vsMidground)),this.layers.push(new i(this.ui,this.game,this.vsForeground)),this.layers.push(new o(this.ui,this.game,this.vsForeground)),a.background.addChild(this.makeBackground()),this.addChild(this.layers[0]),this.addChild(this.layers[1]),this.addChild(this.layers[2]),this.addChild(this.layers[3]),this.addChild(this.layers[4]),this.ready=!0},a.prototype.initLevel=function(t){var e=!0;if(t===this.level&&(e=!1),this.level=t,this.levelComplete=!1,e){try{this.screen.background.removeChild(screen.background.getChildAt(0))}catch(i){}this.screen.background.addChild(this.makeBackground())}for(var n=0;n<this.layers.length;n+=1)this.layers[n].initLevel(this.level)},a.prototype.makeBackground=function(){var i=new t.DisplayObjectContainer,n=["#0096d1","#add7da","#13beb0","#042855"];if(this.level&&this.level.config&&this.level.config.gradient)for(var o=0;o<this.level.config.gradient.length;o+=1)n[o]=this.level.config.gradient[o];var s=new t.CanvasRenderer(this.ui.width,this.ui.height);s.context.clearRect(0,0,this.ui.width,this.ui.height),s.context.rect(0,0,this.ui.width,this.ui.height);for(var a=s.context.createLinearGradient(0,0,0,this.ui.height),o=0;o<r.backgroundGradient.length;o++)a.addColorStop(r.backgroundGradient[o].location,r.backgroundGradient[o].color);s.context.fillStyle="#FFFFFF",s.context.fill(),s.context.fillStyle=a,s.context.fill();var h=new t.Sprite(t.Texture.fromCanvas(s.view));i.addChild(h);var l=e.Sprite.fromFrame(r.background.url);return l.position.x=0,l.position.y=e.Coords.y(r.background.y),i.addChild(l),i},a.prototype.initPet=function(){this.layers[this.petLayerIndex].initPet()},a.prototype.setVelocity=function(t){this.velocity=t;for(var e=0;e<this.layers.length;e+=1)this.layers[e].setVelocity(this.velocity)},a.prototype.start=function(){this.lastTime=Date.now()},a.prototype.beforeRender=function(){this.levelComplete&&this.velocity>0&&(this.velocity+=this.deceleration,this.velocity<=.01&&(this.velocity=0));for(var t=0;t<this.layers.length;t+=1)this.layers[t].setVelocity(this.velocity),this.layers[t].beforeRender(this.levelComplete)},a.prototype.afterRender=function(){for(var t=0;t<this.layers.length;t+=1)this.layers[t].afterRender(this.levelComplete)},a.prototype.isReady=function(){return this.ready&&this.layers[this.petLayerIndex].sceneReady},a.prototype.isComplete=function(){return this.layers[this.petLayerIndex].isComplete()},a.prototype.getPosition=function(){return this.layers[this.petLayerIndex].getPosition()},a.prototype.handleTap=function(){this.layers[this.petLayerIndex].tap()},a.prototype.handlePause=function(){for(var t=0;t<this.layers.length;t+=1)this.layers[t].handlePause()},a.prototype.handleResume=function(){for(var t=0;t<this.layers.length;t+=1)this.layers[t].handleResume()},a.prototype.handleLevelComplete=function(){this.levelComplete=!0,this.layers[this.petLayerIndex].setPetExitVelocity(this.velocity)},a}),define("petengine/mainmenu",["absolute","petengine/trainingview","pixi"],function(t,e,i){var n=function(t,e){this.game=e,this.ui=t,this._initMainMenu()};return n.prototype=Object.create(t.Screen.prototype),n.prototype._initMainMenu=function(){function n(){a.action()}var o=this;if(t.Screen.call(this),this.trainingView=new e(this.ui,this.game,this),this.trainingView.setVelocity(this.game.levelConfig.mainMenuVelocity||.5),this.addChild(this.trainingView),this.logo=t.Sprite.fromFrame("mainmenu_logo.png"),this.logo.position.x=(this.ui.width-this.logo.width)/2,this.logo.position.y=t.Coords.y(this.ui.layout.MainMenu.logo.y),this.addChild(this.logo),this.playButton=new t.Button(t.Texture.fromFrame("btn_main_PLAY.png"),t.Texture.fromFrame("btn_main_PLAY.png"),function(){t.Debug.log("Play pressed!"),t.MusicManager.playMusic("menu_bg_music"),o.game.care()},!0),this.playButton.position.x=t.Coords.x(this.ui.layout.MainMenu.playButton.x),this.playButton.position.y=t.Coords.y(this.ui.layout.MainMenu.playButton.y),this.addChild(this.playButton),this.absHeroLogo=t.Sprite.fromFrame("AH_logo_watermark_dolphin.png"),this.absHeroLogo.position.x=t.Coords.y(1725),this.absHeroLogo.position.y=t.Coords.y(1255),this.addChild(this.absHeroLogo),"undefined"!=typeof window.SpilGameAPIInstance&&window.AH_show_branding){var r=window.SpilGameAPIInstance.Branding.getLogo();if(r.image){var s=new i.ImageLoader(r.image);s.addEventListener("loaded",function(){function e(){r.action()}this.portalLogo=i.Sprite.fromFrame(r.image),this.portalLogo.scale.x=this.portalLogo.scale.y=t.Coords.x(404)/this.portalLogo.width,this.portalLogo.click=e,this.portalLogo.touchstart=e,this.portalLogo.position.x=t.Coords.x(20),this.portalLogo.position.y=this.ui.height-this.portalLogo.height-t.Coords.y(200),this.portalLogo.buttonMode=!0,this.portalLogo.setInteractive(!0),this.addChild(this.portalLogo)}.bind(this)),s.load()}var a=window.SpilGameAPIInstance.Branding.getLink("more_games");a&&(this.moreGames=new i.Sprite.fromFrame("btn_moregames_404.png"),this.moreGames.scale.x=this.moreGames.scale.y=t.Coords.x(404)/this.moreGames.width,this.moreGames.mousedown=n,this.moreGames.touchstart=n,this.moreGames.position.x=t.Coords.x(50),this.moreGames.position.y=this.ui.height-this.moreGames.height-t.Coords.y(50),this.moreGames.buttonMode=!0,this.moreGames.setInteractive(!0),this.addChild(this.moreGames))}for(var h=0;h<this.children.length;h+=1)this.getChildAt(h).alpha=0;this.logo.alpha=1,this.background.alpha=0,this.firstShow=!0},n.prototype.onShow=function(){if(t.Screen.prototype.onShow.call(this),this.firstShow){var e=this;this.firstShow=!1,new TWEEN.Tween({alpha:0}).to({alpha:1},1e3).easing(TWEEN.Easing.Sinusoidal.InOut).onUpdate(function(){for(var t=0;t<e.children.length;t+=1)e.getChildAt(t).alpha=this.alpha,e.background.alpha=this.alpha,e.ui.refreshBackground=!0;e.logo.alpha=1}).onComplete(function(){e.ui.refreshBackground=!1}).start(),t.MusicManager.playMusic("menu_bg_music")}},n.prototype.onHide=function(){t.Screen.prototype.onHide.call(this)},n.prototype.beforeRender=function(){this.trainingView.beforeRender()},n.prototype.afterRender=function(){this.trainingView.afterRender()},n}),define("petengine/scoredisplay",["absolute","pixi","artconfig"],function(t,e,i){var n=function(t){this._initScoreDisplay(t)};return n.prototype=Object.create(e.Sprite.prototype),n.prototype._initScoreDisplay=function(n){e.Sprite.call(this,t.Texture.fromFrame(i.hudScoreIcon.url)),this.text=new t.DigitLabel(3,.6,"MDS_number"),this.text.setText(n.toString()),this.text.position.x=t.Coords.x(i.hudScoreText.x),this.text.position.y=t.Coords.y(i.hudScoreText.y),this.addChild(this.text)},n.prototype.setScore=function(t){this.text.setText(t.toString())},n}),define("petengine/trainprogress",["absolute","pixi","artconfig","obstaclefactory"],function(t,e,i,n){var o=function(t,e,i){this._initTrainProgress(t,e,i)};return o.prototype=Object.create(e.Sprite.prototype),o.prototype._initTrainProgress=function(o,r,s){e.Sprite.call(this,t.Texture.fromFrame(i.hudPanel)),this.ui=o,this.game=r,this.level=s,this.pet=t.Sprite.fromFrame(i.hudPetIcon.url),this.pet.position.x=(this.width-this.pet.width)/2,this.pet.position.y=t.Coords.y(i.hudPetIcon.y),this.addChild(this.pet),this.previewContainer=new e.DisplayObjectContainer,this.addChild(this.previewContainer);var a=new e.Graphics;a.beginFill(),a.drawRect(t.Coords.x(33),0,this.width-t.Coords.x(66),this.height),a.endFill(),this.previewContainer.addChild(a),this.previewContainer.mask=a,this.previewRail=new e.DisplayObjectContainer;for(var h=0;h<this.level.config.obstacles.length;h+=1){var l=this.level.config.obstacles[h],u=n.makeHudIcon(l,this.height);u&&(u.position.x=t.Coords.x(h*this.game.levelConfig.obstacleSpacerWidth/6),this.previewRail.addChild(u))}this.previewContainer.addChild(this.previewRail),this.previewRail.position.x=this.pet.position.x},o.prototype.setPosition=function(e){this.previewRail.position.x=t.Coords.x(e/6)+this.pet.position.x},o}),define("petengine/awardprogressbar",["pixi","absolute","lodash"],function(t,e,i){var n=function(t,e){var n={frameImage:"award_meter.png",fillImage:"award_meter_fill.png",awardImages:["award_meter_star_1.png","award_meter_star_2.png","award_meter_star_3.png"],awardMask:{image:"award_meter_star_empty.png",position:{x:0,y:0}},awardSounds:["award_bronze","award_silver","award_gold"],frameBorderWidth:33};this._initAchievementProgressBar(t,i.extend(n,e))};return n.constructor=n,n.prototype=Object.create(e.ProgressBar.prototype),n.prototype._initAchievementProgressBar=function(t,i){this.level=t,this.options=i,this.targets=[this.level.config.bronze,this.level.config.silver,this.level.config.gold],this.targetsPassed=[!1,!1,!1],this.fillTexure=e.Texture.fromFrame(this.options.fillImage),this.frameBorder=e.Coords.x(this.options.frameBorderWidth),e.ProgressBar.call(this,e.Texture.fromFrame(this.options.frameImage),this.fillTexure),e.ProgressBar.prototype.setProgress.call(this,0),this.addAchievementMarkers(),e.EventBus.addEventListener("Level:PointsScored",this.setProgress.bind(this))},n.prototype.setProgress=function(){this.percent=this.level.getScore()/this.level.getScorePossible(),e.ProgressBar.prototype.setProgress.call(this,this.percent,!0,this.updateMasks.bind(this))},n.prototype.updateMasks=function(){for(var t=0;t<this.options.awardImages.length;t++)if(!this.targetsPassed[t]&&this.percent>=this.targets[t]){var i=this.markersContainer.getChildAt(t),n=i.getChildAt(0);i.removeChild(n),e.AudioManager.playSound(this.options.awardSounds[t]),this.targetsPassed[t]=!0}},n.prototype.addAchievementMarkers=function(){var i=[this.level.config.bronze,this.level.config.silver,this.level.config.gold],n=this.fillTexure.width-2*this.frameBorder;this.markersContainer=new t.DisplayObjectContainer;for(var o=0;o<this.options.awardImages.length;o++){var r=e.Sprite.fromFrame(this.options.awardImages[o]),s=e.Sprite.fromFrame(this.options.awardMask.image);r.position.x=n*i[o]-r.width/2,r.position.y=-this.height/2,s.position.x=this.options.awardMask.position.x,s.position.y=this.options.awardMask.position.y,r.addChildAt(s,0),this.markersContainer.addChildAt(r,o)}this.markersContainer.position.x=this.frameBorder,this.addChild(this.markersContainer)},n}),define("petengine/tutorial",["pixi","absolute","lodash"],function(t,e,i){var n=function(t,n){n=n||{};var o={queue:[],textStyle:{font:Math.floor(80*e.ScreenMetrics.getResScale())+"px Verdana, Helvetica, sans-serif",fill:"white",align:"center",wordWrap:!0,padding:e.Coords.y(80)},pageIndicators:{empty:"btn_main_pagepip_empty.png",full:"btn_main_pagepip_full.png"},closeCallback:function(){}};this.initTutorial(t,i.extend(o,n))};return n.prototype=Object.create(t.DisplayObjectContainer.prototype),n.prototype.initTutorial=function(e,i){t.DisplayObjectContainer.call(this),this.ui=e,this.options=i,this.queue=[],this.localStorageKey="tutorial"},n.prototype.hasBeenShown=function(){var t=e.GameConfig.getVal(this.localStorageKey)||{},n=!1;return i.has(t,this.options.name)?n=t[this.options.name]:(t[this.options.name]=!0,e.GameConfig.setVal(this.localStorageKey,t)),n},n.prototype.getState=function(){return e.GameConfig.getVal(this.localStorageKey)||{}},n.prototype.setState=function(t){var i=this.getState();i[this.options.name]=t,e.GameConfig.setVal(this.localStorageKey,i)},n.prototype.start=function(t){return t&&this.setState(!1),this.hasBeenShown()?(this.stop(),!1):(this.queue=i.clone(this.options.queue),void this._next())},n.prototype.stop=function(t){this.queue=[],this.setState(!0),t&&this.dialog&&this.dialog.close(),this.dialog=null,this.options.closeCallback()},n.prototype._next=function(){if(this.currentPage=this.queue.shift(),"undefined"==typeof this.currentPage)return void this.stop(!0);var t=this._getContent(this.currentPage),i={content:t,width:this.currentPage.dialog.width,height:t.height,x:(this.ui.width-this.currentPage.dialog.width)/2,y:(this.ui.height-t.height)/2,callbacks:{onClose:this.stop.bind(this)}};this.dialog?this.dialog.updateDialog(i):(this.dialog=new e.Dialog(this.ui,i),this.dialog.open())},n.prototype._getContent=function(i){var n,o,r=new t.DisplayObjectContainer;switch(i.dialog.type){case"text":this.options.textStyle.wordWrapWidth=this.currentPage.dialog.width-2*this.options.textStyle.padding,n=new t.Text(i.dialog.content,this.options.textStyle);break;case"image":n=t.Sprite.fromFrame(i.dialog.content)}n.position.x=n.position.y=this.options.textStyle.padding,r.addChild(n);for(var s=0;s<i.arrows.length;s++){var a=t.Sprite.fromFrame("tutorial_arrow.png");a.position.x=i.arrows[s].x,a.position.y=i.arrows[s].y,a.rotation=i.arrows[s].rotation,a.scale.x=a.scale.y=.6,r.addChild(a)}o=new e.Button(e.Texture.fromFrame("btn_main_OK.png"),e.Texture.fromFrame("btn_main_OK.png"),function(){o.interactive=!1,this._next()}.bind(this),!0),o.scale.x=o.scale.y=.7,o.position.x=(i.dialog.width-o.width)/2,o.position.y=n.position.y+n.height+this.options.textStyle.padding,r.addChild(o);var h=0;if(this.options.queue.length>1){var l=new e.PageIndicator(this.options.queue.length,this.options.queue.length-this.queue.length-1);l.position.y=o.position.y+o.height+this.options.textStyle.padding,l.position.x=(i.dialog.width-l.width)/2,h=l.height,r.addChild(l)}return r.height=this.options.textStyle.padding+n.height+this.options.textStyle.padding+o.height+this.options.textStyle.padding,h>0&&(r.height+=h+this.options.textStyle.padding),r},n}),define("petengine/trainscreen",["pixi","absolute","petengine/trainingview","petengine/scoredisplay","petengine/trainprogress","petengine/wallet","petengine/awardprogressbar","petengine/tutorial","artconfig","absoluteaudio"],function(t,e,i,n,o,r,s,a,h,l){var u=function(t,e){this.initTrainScreen(t,e)};return u.prototype=Object.create(e.Screen.prototype),u.prototype.initTrainScreen=function(n,o){e.Screen.call(this),this.ui=n,this.game=o,this.timeWarningPlaying=!1,this.wallet=new r(o),this.hud=this.makeHUD(),this.hitArea=new t.Rectangle(0,e.Coords.y(250),this.ui.width,this.ui.height-e.Coords.y(250)),e.Platform.supportsTouch()?this.touchstart=this.onTap.bind(this):this.mousedown=this.onTap.bind(this),this.firstCurrencyEarned=!1,this.tutorial=new a(this.ui,{name:"preRaceMode",queue:this.game.tutorialConfig.preRaceMode,closeCallback:this.resume.bind(this)}),this.trainingView=new i(this.ui,this.game,this),this.addChild(this.trainingView)},u.prototype.showScoreSummary=function(){},u.prototype.configLevel=function(t){if(this.level=t,this.level.setScore(0),this.levelComplete=!1,this.setInteractive(!0),this.buttonMode=!0,this.trainingView.initLevel(t),this.hud)try{this.removeChild(this.hud)}catch(i){}if(this.hud&&this.trainingProgress)try{this.hud.removeChild(this.trainingProgress)}catch(i){}if(this.trainingProgress=new o(this.ui,this.game,this.level),this.trainingProgress.position.x=(this.ui.width-this.trainingProgress.width)/2,this.trainingProgress.position.y=e.Coords.y(75),this.hud.addChild(this.trainingProgress),this.hud&&this.achievementProgressBar)try{this.hud.removeChild(this.achievementProgressBar)}catch(i){}this.achievementProgressBar=new s(this.level),this.achievementProgressBar.position.x=(this.ui.width-this.achievementProgressBar.width)/2,this.achievementProgressBar.position.y=e.Coords.y(1300),this.hud.addChild(this.achievementProgressBar),this.addChild(this.hud),this.trainingView.setVelocity(this.level.config.velocity||2)},u.prototype.makeHUD=function(){var i=new t.DisplayObjectContainer;return this.optionsMenuButton=new e.Button(e.Texture.fromFrame(h.trainingPauseButton),e.Texture.fromFrame(h.trainingPauseButton),function(){this._stopTutorial(),this.pause()}.bind(this),!0),e.LayoutHelper.layout(this.optionsMenuButton,"TrainScreen","optionsMenuButton"),i.addChild(this.optionsMenuButton),this.replayButton=new e.Button(e.Texture.fromFrame("btn_ingame_REPLAY.png"),e.Texture.fromFrame("btn_ingame_REPLAY.png"),function(){this._stopTutorial(),this.game.train()}.bind(this)),e.LayoutHelper.layout(this.replayButton,"TrainScreen","replayButton"),this.replayButton.scale.x=this.replayButton.scale.y=1,i.addChild(this.replayButton),this.scoreDisplay=new n(this.wallet.getBalance()),e.LayoutHelper.layout(this.scoreDisplay,"TrainScreen","scoreDisplay"),i.addChild(this.scoreDisplay),e.EventBus.addEventListener("Wallet:BalanceChange",this.setScore.bind(this)),e.EventBus.addEventListener("Wallet:Deposit",function(){if(!this.firstCurrencyEarned){this.firstCurrencyEarned=!0,this.pause(!1);var t=new a(this.ui,{name:"currencyCaptured",queue:this.game.tutorialConfig.currencyCaptured,closeCallback:this.resume.bind(this)});t.start()}}.bind(this)),i},u.prototype.setScore=function(){this.scoreDisplay.setScore(this.wallet.getBalance())},u.prototype.handleVisibilityChange=function(t){!t||this.paused||this.levelComplete||this.pause()},u.prototype.pause=function(t){this.paused||(t="undefined"==typeof t?!0:t,this.paused=!0,t&&this.ui.showOptionsModal(this.resume.bind(this),function(){this.tutorial.start(!0)}.bind(this),!0),this.trainingView.handlePause())},u.prototype.resume=function(){this.paused=!1,this.trainingView.handleResume()},u.prototype.onTap=function(){this.trainingView.handleTap()},u.prototype.onShow=function(){this.paused&&this.resume(),e.Screen.prototype.onShow.call(this),e.MusicManager.stopMusic(),l.context.usingWebAudio()?e.MusicManager.playMusic("train_mode_music"):window.setTimeout(function(){e.MusicManager.playMusic("train_mode_music")},500),this.tutorialTimeout=window.setTimeout(function(){this.pause(!1),this.tutorial.start()}.bind(this),1500),"undefined"==typeof this.scoreSummary?(this.scoreSummary=this.ui.getScoreSummaryModal(),this.addChild(this.scoreSummary)):(this.removeChild(this.scoreSummary),this.addChild(this.scoreSummary)),this.scoreSummary.onHide()},u.prototype.onHide=function(){e.Screen.prototype.onHide.call(this)},u.prototype.beforeRender=function(){this.trainingView&&this.trainingView.isReady()&&!this.paused&&(this.trainingProgress.setPosition(this.trainingView.getPosition()),this.trainingView.beforeRender())},u.prototype.afterRender=function(){this.trainingView&&!this.paused&&(this.trainingView.afterRender(),this.trainingView.isComplete()&&!this.levelComplete&&(this.setInteractive(!1),this.buttonMode=!1,this.game.levelManager.setLevelState(this.level),e.AudioManager.playSound("course_end"),this.levelComplete=!0,this.trainingView.handleLevelComplete(),this.trainingProgress.visible=!1,this.scoreSummary.onShow(),this.hud.removeChild(this.achievementProgressBar)))},u.prototype._stopTutorial=function(){"undefined"!=typeof this.tutorialTimeout&&(clearTimeout(this.tutorialTimeout),this.tutorial.stop(!0))},u}),define("petengine/loadingscreen",["pixi","absolute","artconfig"],function(t,e,i){var n=function(t,e){this.initLoadingScreen(t,e)};return n.prototype=Object.create(e.Screen.prototype),n.prototype.initLoadingScreen=function(t,n){e.Screen.call(this),this.ui=t,this.game=n,this.logo=e.Sprite.fromFrame(i.logo),this.logo.position.x=(this.ui.width-this.logo.width)/2,this.logo.position.y=e.Coords.y(this.ui.layout.LoadingScreen.logo.y),this.progressBar=new e.ProgressBar(e.Texture.fromFrame(i.loadingBarFrame),e.Texture.fromFrame(i.loadingBarFill)),this.progressBar.position.x=(this.ui.width-this.progressBar.width)/2,this.progressBar.position.y=e.Coords.y(this.ui.layout.LoadingScreen.progressBar.y),this.progressBar.setProgress(0),this.addChild(this.logo),this.addChild(this.progressBar)},n.prototype.updateLoadingProgress=function(t){this.progressBar.setProgress(t)},n.prototype.onShow=function(){e.Screen.prototype.onShow.call(this)},n.prototype.onHide=function(){e.Screen.prototype.onHide.call(this)},n}),define("petengine/itemdetailscreen",["pixi","absolute"],function(t,e){var i=function(t,e){this.initItemDetailScreen(t,e)};return i.prototype=Object.create(e.Screen.prototype),i.prototype.initItemDetailScreen=function(t,i){e.Screen.call(this),this.item=t,this.card=i,this._addItemImage(),this._addPriceLabel(),this._addBoostIcons()},i.prototype._addItemImage=function(){this.itemSprite=null,this.itemSprite="string"==typeof this.item.image?e.Sprite.fromFrame(this.item.image):this.item.image;var t=1,i=1,n=this.card.width,o=.6*this.card.height;this.itemSprite.width>n&&(t=n/this.itemSprite.width),this.itemSprite.height>o&&(i=o/this.itemSprite.height),this.itemSprite.scale.x=this.itemSprite.scale.y=Math.min(t,i),this.itemSprite.position.x=(this.card.width-this.itemSprite.width)/2,this.itemSprite.position.y=(this.card.height-this.itemSprite.height)/2,this.addChild(this.itemSprite)},i.prototype._addBoostIcons=function(){for(var i=e.Coords.x(this.item.boostImages.gutterWidth),n=5,o=Math.min(5,Math.ceil(10*this.item.boost)),r=0,s=new t.DisplayObjectContainer,a=0;n>a;a++){var h="";h=e.Sprite.fromFrame(o>a?this.item.boostImages.on:this.item.boostImages.off),h.position.x=(h.width+i)*a,r+=h.width,n-1>a&&(r+=i),s.addChild(h)}s.position.x=(this.card.width-r)/2,s.position.y=e.Coords.y(this.item.boostImages.y),this.addChild(s)},i.prototype._addPriceLabel=function(){var t=new e.DigitLabel(3,1,"MDS_number"),i=e.Sprite.fromFrame("pearls_icon.png");t.setText(this.item.price.toString()),t.position.x=e.Coords.x(220),t.position.y=e.Coords.y(455),i.position.x=e.Coords.x(100),i.position.y=e.Coords.y(445),this.addChild(t),this.addChild(i)},i}),define("petengine/careitemmenu",["pixi","absolute","petengine/itemdetailscreen"],function(t,e,i){var n=function(t,e,i,n,o,r,s,a){this.initCareItemMenu(t,e,i,n,o,s,a)};return n.prototype=Object.create(t.DisplayObjectContainer.prototype),n.prototype.initCareItemMenu=function(i,n,o,r,s,a,h,l){t.DisplayObjectContainer.call(this),this.ui=i,this.game=n,this.items=o,this.buyCallback=r,this.closeCallback=s,this.cardTexture=e.Texture.fromFrame(a||"item-card.png"),this.cardScale=h||.83,this.cardGutters=l||{x:e.Coords.x(50),y:e.Coords.y(50)},this.width=e.Coords.x(1700),this.height=e.Coords.y(1200),this.pages=[],this.setItems(o)},n.prototype.setItems=function(e){this.items=e;var i=new t.DisplayObjectContainer;this.cellWidth=this.cardTexture.width*this.cardScale+this.cardGutters.x/2,this.cellHeight=this.cardTexture.height*this.cardScale+this.cardGutters.y/2,this.colsPerPage=Math.floor(this.width/this.cellWidth),this.rowsPerPage=Math.floor(this.height/this.cellHeight);for(var n=this.items.length/this.colsPerPage,o=Math.ceil(n/this.rowsPerPage),r=0;o>r;r+=1){var s=this.rowsPerPage*this.colsPerPage*r,a=this.rowsPerPage*this.colsPerPage*(r+1);a>this.items.length&&(a=this.items.length),this.pages.push(this.makePage(this.items.slice(s,a)))}i.addChild(this.pages[0]),this.addChild(i)},n.prototype.makePage=function(e){for(var i=new t.DisplayObjectContainer,n=0,o=0;o<this.rowsPerPage;o+=1)for(var r=0;r<this.colsPerPage&&n<e.length;r++){var s=this.makeItemCard(e[n]);s.position.x=r*(s.width+this.cardGutters.x),s.position.y=o*(s.height+this.cardGutters.y),i.addChild(s),n++}return i.width=(s.width+this.cardGutters.x)*this.colsPerPage,i},n.prototype.makeItemCard=function(t){var n=new e.Button(this.cardTexture,this.cardTexture,function(){this.onBuy(t)}.bind(this),!0,!0),o=new i(t,n);return o.position.x=0,o.position.y=0,n.addChild(o),n.scale.x=this.cardScale,n.scale.y=this.cardScale,n},n.prototype.onBuy=function(t){"function"==typeof this.buyCallback&&this.buyCallback(t)},n.prototype.onClose=function(){"function"==typeof this.closeCallback&&this.closeCallback(this)},n}),define("petengine/decayitem",[],function(){var t=function(t,e,i){this._initDecayItem(t,e,i)};return t.constructor=t,t.prototype._initDecayItem=function(t,e,i){this.boost=t,this.updated=Date.now(),this.duration=e,this.remaining=i},t.prototype.update=function(){var t=Date.now();this.remaining-=Math.floor((t-this.updated)/1e3),this.remaining<0&&(this.remaining=0),this.updated=t},Object.defineProperty(t.prototype,"strength",{get:function(){return this.update(),this.remaining/this.duration}}),Object.defineProperty(t.prototype,"health",{get:function(){return this.update(),this.boost*this.strength}}),t.prototype.reset=function(){this.remaining=this.duration,this.updated=Date.now()},t.prototype.recharge=function(t){t>1?t=1:0>t&&(t=0),this.update(),this.remaining+=this.duration*t,this.remaining>this.duration&&(this.remaining=this.duration)},t.prototype.toJSON=function(){return this.update(),{boost:this.boost,duration:this.duration,remaining:this.remaining}},t}),define("petengine/careitem",["pixi","absolute","petengine/decayitem"],function(t,e,i){var n=function(t,e,i,n,o,r,s){this.initCareItem(t,e,i,n,o,r,s)};return n.constructor=n,n.prototype=Object.create(e.Draggable.prototype),n.prototype.initCareItem=function(t,n,o,r,s,a,h){if(e.Draggable.call(this,n,o,r,s,a),this.showHealthBar="undefined"!=typeof h?h:!0,this.visible=!1,this.child=n,this.showHealthBar){this.progressBar=new e.ProgressBar(e.Texture.fromFrame("inspect_timer_base.png"),e.Texture.fromFrame("inspect_timer_fill.png"));var l=0;l=this.child.height?this.child.height:1.5*this.progressBar.height,t.offsetY&&(l-=t.offsetY,this.child.position.y=t.offsetY),this.progressBar.position.x=-this.progressBar.width/2,this.progressBar.position.y=-l-this.progressBar.height,this.progressBar.visible=!1,this.child.addChild(this.progressBar)}this.decay=new i(t.boost,t.duration,t.remaining)},Object.defineProperty(n.prototype,"health",{get:function(){return this.decay.health}}),n.prototype.globalPosition=function(){return new t.Point(this.worldTransform.tx,this.worldTransform.ty)},n.prototype.toJSON=function(){return this.decay.toJSON()},n.prototype.onShow=function(){this.visible=!0},n.prototype.onHide=function(){this.visible=!1},n.prototype._onGrab=function(t){e.Draggable.prototype._onGrab.call(this,t),this.showHealthBar&&(this.progressBar.setProgress(this.decay.strength),this.progressBar.visible=!0,this.progressBar.alpha=1)},n.prototype._onDrop=function(t){function i(t,e){return!(e.left>t.right||e.right<t.left||e.top>t.bottom||e.bottom<t.top)}e.Draggable.prototype._onDrop.call(this,t),this.showHealthBar&&window.setTimeout(function(){e.TweenUtils.fadeOut([this.progressBar],{duration:500})}.bind(this),1e3),this.width=this.width*this.scale.x,this.height=this.height*this.scale.y;var n={left:this.position.x-this.width/4,right:this.position.x+this.width/4,top:this.position.y-this.height,bottom:this.position.y};if("undefined"!=typeof this.petAreas&&0!=this.petAreas.length){for(var o=!1,r=0,s=0;s<this.petAreas.length;s++)if(o=i(n,{left:this.petAreas[s].x,right:this.petAreas[s].x+this.petAreas[s].width,top:this.petAreas[s].y,bottom:this.petAreas[s].y+this.petAreas[s].height})){r=s;break}if(o){var a=Math.round(this.petAreas[r].x-e.Coords.x(60)-this.width/2),h=this;this.position.x>this.petAreas[r].x+this.petAreas[r].width/2&&(a=Math.round(this.petAreas[r].x+this.petAreas[r].width+e.Coords.x(60)+this.width/2)),new TWEEN.Tween({x:this.position.x}).to({x:a},500).onUpdate(function(){h.position.x=this.x}).interpolation(TWEEN.Interpolation.Linear).start()}else this.position.x=Math.round(this.position.x),this.position.y=Math.round(this.position.y)}},n}),define("petengine/animatedcareitem",["pixi","absolute","petengine/careitem"],function(t,e,i){var n=function(t,e,i,n,o,r,s){this.initAnimatedCareItem(t,e,i,n,o,r,s)};return n.constructor=n,n.prototype=Object.create(i.prototype),n.prototype.initAnimatedCareItem=function(e,n,o,r,s,a,h){var l=new t.DisplayObjectContainer,u=new t.Texture.fromFrame(e.image);this.config=e,this.width=u.width,this.height=u.height,l.height=this.height,l.anchor={},l.anchor.x=e.anchorX||.5,l.anchor.y=e.anchorY||.8,this.petAreas=h,this.animationContainer=new t.DisplayObjectContainer,e.offsetY&&(this.animationContainer.position.y=e.offsetY),i.call(this,e,l,n,o,r,s,a),this.assetName=e.assetName,this.direction=1,this.animating=!1,this.loadAnimation(this.assetName,function(t){this.animation=t,this.animationContainer.addChild(this.animation),l.addChild(this.animationContainer),this.animate()}.bind(this))},n.prototype.loadAnimation=function(i,n){var o=new e.Loader;o.loadArt([i],function(){},function(){var o=new t.Spine(e.Platform.artPathPrefix+"/"+e.ScreenMetrics.getResClass()+"/"+i+".json");n(o)})},n.prototype.animate=function(){this.animating=!0,this._animate()},n.prototype._animate=function(){},n.prototype.stop=function(){this.animating=!1},n.prototype.toJSON=function(){var t=i.prototype.toJSON.call(this);return t.kind="animated",t.assetName=this.assetName,t.position={x:e.Coords.worldX(this.position.x),y:e.Coords.worldY(this.position.y)},t.image=this.config.image,t.offsetY=this.config.offsetY,t},n.prototype.onShow=function(){this.animate(),i.prototype.onShow.call(this)},n.prototype.onHide=function(){this.stop(),i.prototype.onShow.call(this)},n.prototype.faceYourMaster=function(){this.animationContainer.scale.x=this.position.x>this.limit.width/2?-1:1},n.prototype._onMove=function(t){this.faceYourMaster(),i.prototype._onMove.call(this,t)},n}),define("bumblebee",["pixi","absolute","petengine/animatedcareitem"],function(t,e,i){var n=function(t,e,i,n,o,r,s){this.initBumbleBee(t,e,i,n,o,r,s)};return n.constructor=n,n.prototype=Object.create(i.prototype),n.prototype.initBumbleBee=function(n,o,r,s,a,h,l){o=new t.Rectangle(0,0,2008*e.ScreenMetrics.getResScale(),1536*e.ScreenMetrics.getResScale()),s=function(){},i.call(this,n,o,r,s,a,h,l)},n.prototype._animate=function(){this.visible&&!this.animation.state.current?this.animation.state.setAnimationByName("fly",!0):setTimeout(function(){this._animate()}.bind(this),100)},n.prototype.buzz=function(){e.AudioManager.playSound("bumblebee_buzz"),this.buzzTimeout=setTimeout(function(){this.buzz()}.bind(this),15e3+5e3*Math.random())},n.prototype._onGrab=function(t){this.stop(),i.prototype._onGrab.call(this,t)},n.prototype._onDrop=function(t){this.animate(),i.prototype._onDrop.call(this,t)},n.prototype.onHide=function(){window.clearTimeout(this.buzzTimeout),i.prototype.onHide.call(this)},n.prototype.onShow=function(){this.buzz(),i.prototype.onShow.call(this)},n.prototype.toJSON=function(){var t=i.prototype.toJSON.call(this);
return t.skipScaling=!0,t},n.prototype.faceYourMaster=function(){this.animationContainer.scale.x=this.position.x>this.limit.width/2?1:-1},n}),define("butterfly",["pixi","absolute","petengine/animatedcareitem"],function(t,e,i){var n=function(t,e,i,n,o,r,s){this.initButterfly(t,e,i,n,o,r,s)};return n.constructor=n,n.prototype=Object.create(i.prototype),n.prototype.initButterfly=function(n,o,r,s,a,h,l){o=new t.Rectangle(0,0,2008*e.ScreenMetrics.getResScale(),1536*e.ScreenMetrics.getResScale()),s=function(){},i.call(this,n,o,r,s,a,h,l)},n.prototype._animate=function(){this.visible&&!this.animation.state.current?this.animation.state.setAnimationByName("fly",!0):setTimeout(function(){this._animate()}.bind(this),100)},n.prototype._onGrab=function(t){this.stop(),i.prototype._onGrab.call(this,t)},n.prototype._onDrop=function(t){this.animate(),i.prototype._onDrop.call(this,t)},n.prototype.toJSON=function(){var t=i.prototype.toJSON.call(this);return t.skipScaling=!0,t},n}),define("mouse",["pixi","absolute","petengine/animatedcareitem"],function(t,e,i){var n=function(t,e,i,n,o,r,s){this.initMouse(t,e,i,n,o,r,s)};return n.constructor=n,n.prototype=Object.create(i.prototype),n.prototype.initMouse=function(t,e,n,o,r,s,a){i.call(this,t,e,n,o,r,s,a),this.tweening=!1},n.prototype._animate=function(){this.visible&&!this.animation.state.current?this.walk():setTimeout(function(){this._animate()}.bind(this),100)},n.prototype.walk=function(){if(this.animating&&!this.tweening){var t=this,i=this.getDirection(),n=this.position.x+e.Coords.x(400*Math.abs(this.scale.x)*i);this.tweening=!0,this.tween=new TWEEN.Tween({x:this.position.x}).to({x:n},500).delay(1e3+1e3*Math.random()).onStart(function(){(t.animationContainer.scale.x>0&&i>0||t.animationContainer.scale.x<0&&0>i)&&(t.animationContainer.scale.x*=-1),t.animation.state.setAnimationByName("walk",!0)}).onUpdate(function(){t.position.x=this.x}).onComplete(function(){t.animation.state.clearAnimation(),t.animating&&setTimeout(function(){t.tweening=!1,t.walk()}.bind(t),0)}).interpolation(TWEEN.Interpolation.Linear).start()}},n.prototype.getDirection=function(){var t=this.globalPosition(),e=1;return t.x>this.limit.x+this.limit.width?e=-1:e*=Math.random()<.5?1:-1,e},n.prototype._onGrab=function(t){this.stop(),this.tween&&(this.tween.stop(),this.tweening=!1,this.animation.state.clearAnimation()),i.prototype._onGrab.call(this,t)},n.prototype._onDrop=function(t){i.prototype._onDrop.call(this,t),window.setTimeout(function(){this.animate(),this.walk()}.bind(this),1500)},n}),define("gopher",["pixi","absolute","petengine/animatedcareitem"],function(t,e,i){var n=function(t,e,i,n,o,r,s){this.initGopher(t,e,i,n,o,r,s)};return n.constructor=n,n.prototype=Object.create(i.prototype),n.prototype.initGopher=function(t,e,n,o,r,s,a){i.call(this,t,e,n,o,r,s,a),this.randomTriggerFired=!0},n.prototype._animate=function(){this.makeHole(),this.visible&&this.randomTriggerFired&&this.animation.state.isComplete()&&(this.randomTriggerFired=!1,setTimeout(function(){this.randomTriggerFired=!0,this.animation.state.setAnimationByName("up"),this.animation.state.addAnimationByName("down")}.bind(this),2e3+5e3*Math.random())),setTimeout(function(){this._animate()}.bind(this),100)},n.prototype.makeHole=function(){this.animation.skeleton.findSlot("right_arm").attachment=null,this.animation.skeleton.findSlot("right_hand").attachment=null,this.animation.skeleton.findSlot("body").attachment=null,this.animation.skeleton.findSlot("left_arm").attachment=null,this.animation.skeleton.findSlot("left_eye").attachment=null,this.animation.skeleton.findSlot("right_eye").attachment=null,this.animation.skeleton.findSlot("left_eyelid").attachment=null,this.animation.skeleton.findSlot("right_eyelid").attachment=null,this.animation.skeleton.findSlot("head").attachment=null,this.animation.skeleton.findSlot("left_hand").attachment=null},n.prototype._onGrab=function(t){this.stop(),i.prototype._onGrab.call(this,t)},n.prototype._onDrop=function(t){this.animate(),i.prototype._onDrop.call(this,t)},n}),define("critterfactory",["pixi","absolute","bumblebee","butterfly","mouse","gopher"],function(t,e,i,n,o,r){var s={makeCritter:function(t,e,s,a,h,l,u){var c=null;switch(t.assetName){case"bumblebee":c=new i(t,e,s,a,h,l,u);break;case"butterfly":c=new n(t,e,s,a,h,l,u);break;case"mouse":c=new o(t,e,s,a,h,l,u);break;case"gopher":c=new r(t,e,s,a,h,l,u)}return c}};return s}),define("petengine/staticcareitem",["pixi","absolute","petengine/careitem"],function(t,e,i){var n=function(t,e,i,n,o,r,s){this.initStaticCareItem(t,e,i,n,o,r,s)};return n.constructor=n,n.prototype=Object.create(i.prototype),n.prototype.initStaticCareItem=function(n,o,r,s,a,h,l){this.assetName=n.assetName,this.petAreas=l,this.name=n.name||this.assetName,this.container=new t.DisplayObjectContainer;var u=e.Sprite.fromFrame(this.assetName);u.anchor.x=n.anchorX||.5,u.anchor.y=n.anchorY||.8,n.offsetY&&(u.position.y=n.offsetY),this.sprite=u,this.container.addChild(this.sprite),this.container.width=this.sprite.width,this.container.height=this.sprite.height,this.width=this.sprite.width,this.height=this.sprite.height,i.call(this,n,this.container,o,r,s,a,h)},n.prototype.toJSON=function(){var t=i.prototype.toJSON.call(this);return t.kind="static",t.assetName=this.assetName,t.name=this.name||this.assetName,t.position={x:e.Coords.worldX(this.position.x),y:e.Coords.worldY(this.position.y)},t.scale=this.scale,t},n.prototype._onMove=function(t){this.faceYourMaster(),i.prototype._onMove.call(this,t)},n.prototype.faceYourMaster=function(){this.sprite.scale.x=this.position.x>this.limit.width/2?-1:1},n}),define("petengine/sinkingcareitem",["pixi","absolute","petengine/staticcareitem"],function(t,e,i){var n=function(t,e,i,n,o){this.initSinkingCareItem(t,e,i,n,o)};return n.constructor=n,n.prototype=Object.create(i.prototype),n.prototype.initSinkingCareItem=function(t,e,n,o,r){i.call(this,t,e,n,o,r)},n.prototype.drop=function(t,e,i,n){var o=this;this.position.x=t,this.position.y=e,this.sinking=new TWEEN.Tween({y:this.position.y}).delay(0).to({y:this.position.y+i},1e3).onUpdate(function(){o.position.y=this.y}).onComplete(function(){o.sinking=null,"function"==typeof n&&n()}).interpolation(TWEEN.Interpolation.Linear).start()},n}),define("petengine/sponge",["pixi","absolute","petengine/staticcareitem"],function(t,e,i){var n=function(t,e,i,n,o){this.initSponge(t,e,i,n,o)};return n.constructor=n,n.prototype=Object.create(i.prototype),n.prototype.initSponge=function(t,e,n,o,r){i.call(this,t,e,n,o,r,!1),this.xMove=0,this.yMove=0},n.prototype._onGrab=function(t){e.AudioManager.loopSound("dolphin_sponge"),i.prototype._onGrab.call(this,t)},n.prototype._onDrop=function(t){this.stopSound(),i.prototype._onDrop.call(this,t)},n.prototype.stopSound=function(){e.AudioManager.stopSound("dolphin_sponge")},n.prototype._onMove=function(t){if(this.parent){if(this.dragging){var e=this.data.getLocalPosition(this.parent);this.limit&&e.x>this.limit.x&&e.x<this.limit.x+this.limit.width&&e.y>this.limit.y&&e.y<this.limit.y+this.limit.height&&(this.xMove=Math.abs(this.position.x-Math.round(e.x)),this.yMove=Math.abs(this.position.y-Math.round(e.y)))}i.prototype._onMove.call(this,t)}},n}),define("ropeswing",["pixi","absolute","petengine/staticcareitem"],function(t,e,i){var n=function(t,e,i,n,o,r,s){this.initRopeSwing(t,e,i,n,o,r,s)};return n.constructor=n,n.prototype=Object.create(i.prototype),n.prototype.initRopeSwing=function(t,e,n,o,r,s,a){i.call(this,t,e,n,o,r,s,a),this.scale=t.scale,this.addRope()},n.prototype.addRope=function(){var i,n=new t.DisplayObjectContainer,o=new t.Texture.fromFrame("care_yard_tirerope.png"),r=e.Coords.y(1920),s=Math.ceil(r/o.height),a=this.sprite.height*this.sprite.anchor.y+e.Coords.y(34);for(i=0;s>i;i++){var h=new t.Sprite(o);h.position.x=e.Coords.x(-42),h.position.y=Math.round(-(o.height*i)-a),n.addChild(h)}this.sprite.addChild(n)},n}),define("careitemfactory",["pixi","absolute","critterfactory","petengine/staticcareitem","petengine/sinkingcareitem","petengine/sponge","ropeswing"],function(t,e,i,n,o,r,s){var a={makeCareItem:function(t,e,a,h,l,u){return"animated"===t.kind?i.makeCritter(t,e,a,h,l,!0,u):"sinking"===t.kind?new o(t,e,a,h,l):"sponge"===t.name?new r(t,e,a,h,l):"ropeSwing"===t.name?new s(t,e,a,h,l,!0,u):new n(t,e,a,h,l,!0,u)}};return a}),define("petengine/healthmeter",["pixi","absolute"],function(t,e){var i=function(t,e,i){this._initHealthMeter(t,e,i)};return i.constructor=i,i.prototype=Object.create(t.DisplayObjectContainer.prototype),i.prototype._initHealthMeter=function(i,n,o){t.DisplayObjectContainer.call(this),this.progressBar=new e.ProgressBar(e.Texture.fromFrame("statusbar_base_empty.png"),e.Texture.fromFrame("statusbar_fill.png"),e.Coords.x(32),e.Coords.x(510));var r,s=e.Sprite.fromFrame(n);this.addChild(this.progressBar),this.addChild(s),""!==i&&(r=e.Sprite.fromFrame(i),this.addChild(r),r.position.x=e.Coords.x(0)),s.position.x=e.Coords.x(o.x),s.position.y=e.Coords.y(o.y)},i.prototype.setProgress=function(t){this.progressBar.setProgress(t)},i}),define("petengine/carehud",["pixi","absolute","petengine/healthmeter","petengine/scoredisplay","petengine/wallet","artconfig"],function(t,e,i,n,o,r){var s=function(t){this.initCareHUD(t)};return s.prototype=Object.create(t.DisplayObjectContainer.prototype),s.prototype.initCareHUD=function(s){t.DisplayObjectContainer.call(this),this.game=s,this.wallet=new o(this.game),this.petHealthMeter=new i(r.hudPetHealthText.url,r.hudPetHealthIcon.url,{x:r.hudPetHealthIcon.x,y:r.hudPetHealthIcon.y}),this.petHealthMeter.setProgress(.5),e.LayoutHelper.layout(this.petHealthMeter,"CareHUD","petHealthMeter"),this.addChild(this.petHealthMeter),this.environmentHealthMeter=new i(r.hudEnvironmentHealthText.url,r.hudEnvironmentHealthIcon.url,{x:r.hudEnvironmentHealthIcon.x,y:r.hudEnvironmentHealthIcon.y}),this.environmentHealthMeter.setProgress(.75),e.LayoutHelper.layout(this.environmentHealthMeter,"CareHUD","environmentHealthMeter"),this.addChild(this.environmentHealthMeter),this.score=new n(this.wallet.getBalance()),e.LayoutHelper.layout(this.score,"CareHUD","score"),this.addChild(this.score),e.EventBus.addEventListener("Wallet:BalanceChange",this.setScore.bind(this))},s.prototype.setDolphinHealth=function(t){this.petHealthMeter.setProgress(t)},s.prototype.setLagoonHealth=function(t){this.environmentHealthMeter.setProgress(t)},s.prototype.setScore=function(){this.score.setScore(this.wallet.getBalance())},s}),define("petengine/careitemlist",["absolute","careitemfactory"],function(t,e){var i=function(){this._initCareItemList()};return i.constructor=i,i.prototype._initCareItemList=function(){this.id="",this.items=[]},i.prototype.addItem=function(t){this.items.push(t)},i.prototype.removeItem=function(t){this.items.splice(t,1)},i.prototype.save=function(e){for(var i=[],n=0;n<this.items.length;n+=1){var o=this.items[n];i.push(o.toJSON())}this.id=e||this.id,t.GameConfig.setVal("_CareItemList_"+this.id,this.items)},i.prototype.load=function(i,n){this.id=i||this.id;var o=t.GameConfig.getVal("_CareItemList_"+this.id);if(o)for(var r=0;r<o.length;r+=1){var s=e.makeCareItem(o[r],null,null,null,null,n);s.position.x=t.Coords.x(o[r].position.x),s.position.y=t.Coords.y(o[r].position.y),this.items.push(s)}},i.prototype.onShow=function(){for(var t=0;t<this.items.length;t++)this.items[t].onShow()},i.prototype.onHide=function(){for(var t=0;t<this.items.length;t++)this.items[t].onHide()},i}),define("carepet",["pixi","absolute","petengine/decayitem"],function(t,e,i){var n=function(t){this.cleanlinessFactor=.4,this.satietyFactor=.4,this.affectionFactor=.2,this.cleanlinessDuration=600,this.satietyDuration=600,this.affectionDuration=600;var n=e.GameConfig.getVal("cleanliness")||{boost:this.cleanlinessFactor,duration:this.cleanlinessDuration,remaining:this.cleanlinessDuration},o=e.GameConfig.getVal("satiety")||{boost:this.satietyFactor,duration:this.satietyDuration,remaining:this.satietyDuration},r=e.GameConfig.getVal("affection")||{boost:this.affectionFactor,duration:this.affectionDuration,remaining:this.affectionDuration};this.cleanliness=new i(n.boost,n.duration,n.remaining),this.satiety=new i(o.boost,o.duration,o.remaining),this.affection=new i(r.boost,r.duration,r.remaining),this.previousAnimation={},this.queryCount=0,this.initCarePet(t)};return n.constructor=n,n.prototype=Object.create(t.DisplayObjectContainer.prototype),n.prototype.initCarePet=function(){t.DisplayObjectContainer.call(this),this.position.x=e.Coords.x(1050),this.position.y=e.Coords.y(1200),this.setInteractive(!0),e.Platform.supportsTouch()?(this.touchstart=this._onTouchStart,this.touchend=this.touchendoutside=this._onTouchEnd,this.touchmove=this._onDrag):(this.mousedown=this._onTouchStart,this.mouseup=this.mouseupoutside=this._onTouchEnd,this.mousemove=this._onDrag);var i=function(i){var n=new t.Spine(e.Platform.artPathPrefix+"/"+e.ScreenMetrics.getResClass()+"/"+i+".json");return n.visible=!1,n}.bind(this),n=new e.Loader;this.dirty=[],n.loadArt(["care"],function(){},function(){this.animation=i("care"),this.addChild(this.animation),this.setDirtySprites(),this.animation.stateData.setMixByName("sit","jump_for_treat",1),this.animation.stateData.setMixByName("jump","jump_for_treat",1),this.animation.stateData.setMixByName("bark","jump_for_treat",1),this.animation.stateData.setMixByName("sit","jump",1),this.animation.stateData.setMixByName("beg","jump",1),this.animation.stateData.setMixByName("idle","jump",1),this.animation.stateData.setMixByName("idle_with_pant","jump",1),this.animation.stateData.setMixByName("sad_idle","jump",1),this.animation.stateData.setMixByName("bark","jump",1)}.bind(this))},n.prototype.setDirtySprites=function(){this.animation.updateTransform();var t=this.animation.skeleton.slots;this.dirty=[];for(var i=0;i<t.length;i+=1){var n=t[i].data.name;try{if(e.Debug.log("------------------------------"),t[i].currentSprite&&t[i].currentSprite.children.length>=1){var o=t[i].currentSprite.getChildAt(t[i].currentSprite.children.length-1);t[i].currentSprite.removeChild(o)}try{var r=t[i].currentSpriteName,s=e.Sprite.fromFrame(r+"_d.png");s.anchor.x=s.anchor.y=.5,s.alpha=1-this.cleanliness.strength,t[i].currentSprite.addChild(s),e.Debug.log("Found "+r+"_d.png"),this.dirty.push(s)}catch(a){e.Debug.log("Can not find dirty image for "+n)}}catch(a){e.Debug.log("Error "+n)}}},n.prototype._onTouchStart=function(t){this.loveCup+=1,this.love(t.global.x-this.position.x,t.global.y-this.position.y)},n.prototype._onDrag=function(){},n.prototype._onTouchEnd=function(){},n.prototype.isDirty=function(){return this.cleanliness.strength<.9},n.prototype.scrub=function(t){this.state="cleaning";var i=!1;this.cleanliness.recharge(t.xMove/e.Coords.x(5e3)),e.Debug.log("scrub cleanliness "+this.cleanliness.strength);for(var n=0;n<this.dirty.length;n+=1)this.cleanliness.strength>.9?(this.dirty[n].alpha=0,i=!0):this.dirty[n].alpha=1-this.cleanliness.strength;i&&(e.AudioManager.playSound("pet_clean_sparkle"),this.state="idle",this.cleanliness.reset(),this.updateCleanliness())},n.prototype.feed=function(t,i){if(this.state="feeding",this.animation.state.setAnimationByName("jump_for_treat"),!t)return!1;var n="puppy_eat_crunchy";switch(t.name){case"food3":case"food4":case"food5":n="puppy_eat_meaty"}e.AudioManager.playSound(n);var o=this;new TWEEN.Tween({y:t.position.y,scale:1}).delay(500).to({scale:0,y:t.position.y+e.Coords.y(30)},200).easing(TWEEN.Easing.Cubic.In).onUpdate(function(){t.position.y=this.y,t.scale.x=t.scale.y=this.scale}).onComplete(function(){"function"==typeof i&&i(),o.satiety.recharge(t.decay.boost),o.satiety.strength>.95&&o.satiety.reset(),o.updateSatiety(),o.state="idle"}).interpolation(TWEEN.Interpolation.Linear).start()},n.prototype.love=function(t,i){if(this.affection.strength<1){this.state="love",e.AudioManager.playSound("puppy_love"),this.animation.state.current&&"idle"!==this.animation.state.current.name&&this.animation.state.setAnimationByName("idle",!0);var n=e.Sprite.fromFrame("dolphin_love_heart.png"),o=this;n.anchor.x=.5,n.anchor.y=.5,n.position.x=t,n.position.y=i,this.addChild(n),new TWEEN.Tween({alpha:1,y:n.position.y}).to({alpha:0,y:n.position.y-e.Coords.y(300)},500).easing(TWEEN.Easing.Cubic.In).onUpdate(function(){n.position.y=this.y,n.alpha=this.alpha}).onComplete(function(){o.state="idle"}).interpolation(TWEEN.Interpolation.Linear).start(),this.affection.recharge(.1),this.affection.strength>.95&&this.affection.reset(),this.updateAffection()}},n.prototype.enter=function(){this.state="entering",window.setTimeout(function(){var t=this.idleAnimations.happy[n.prototype.entryAnimationIndex];this.animation.state.setAnimationByName(t.name),t.sound&&(t.delaySound?window.setTimeout(function(){e.AudioManager.playSound(t.sound)},t.delaySound):e.AudioManager.playSound(t.sound)),this.animation.visible=!0}.bind(this),500)},Object.defineProperty(n.prototype,"emotionalState",{get:function(){return this.health<=.5?"sad":"happy"}}),Object.defineProperty(n.prototype,"state",{get:function(){return this.currentState||"idle"},set:function(t){window.clearTimeout(this.randomIdleTimeout),this.currentState=t,"idle"==t&&this.setRandomIdle()}}),n.prototype.setRandomIdle=function(){var t=this.getRandomIdle(),i=2e3+4e3*Math.random(),n=!this.previousAnimation.transitionOut&&!t.transitionIn;return"idle"!==this.state||this.animation.state.current&&!this.animation.state.isComplete()?("exiting"!==this.state&&(this.randomIdleTimeout=setTimeout(function(){this.setRandomIdle()}.bind(this),100)),!1):(this.previousAnimation.transitionOut&&this.animation.state.setAnimationByName(this.previousAnimation.transitionOut),this.previousAnimation.transitionOut&&t.transitionIn?this.animation.state.addAnimationByName(t.transitionIn):t.transitionIn&&this.animation.state.setAnimationByName(t.transitionIn),n?this.animation.state.setAnimationByName(t.name,t.loop):this.animation.state.addAnimationByName(t.name,t.loop),t.startIdle&&(i=100),t.sound&&(t.delaySound?window.setTimeout(function(){e.AudioManager.playSound(t.sound)},t.delaySound):e.AudioManager.playSound(t.sound)),this.previousAnimation=t,void(this.randomIdleTimeout=setTimeout(function(){this.setRandomIdle()}.bind(this),i)))},n.prototype.idleAnimations={happy:[{name:"idle",transitionIn:"idle_intro",loop:!0,transitionOut:"idle_outro"},{name:"idle_with_pant",sound:"pant",transitionIn:"idle_intro",loop:!0,transitionOut:"idle_outro"},{name:"jump",sound:"jump",loop:!1,startIdle:!0,delaySound:1e3},{name:"sit",sound:"sit",transitionOut:"sit_to_stand",loop:!1}],sad:[{name:"beg",sound:"beg",loop:!1,startIdle:!0},{name:"bark",loop:!1,sound:"bark",startIdle:!0},{name:"sad_idle",transitionIn:"sad_intro",loop:!0,transitionOut:"sad_outro",sound:"puppy_sad"},{name:"sad_idle",transitionIn:"sad_intro",loop:!0,transitionOut:"sad_outro",sound:"puppy_sad"},{name:"sad_idle",transitionIn:"sad_intro",loop:!0,transitionOut:"sad_outro",sound:"puppy_sad"}]},n.prototype.entryAnimationIndex=2,n.prototype.getRandomIdle=function(){var t=this.idleAnimations[this.emotionalState];return t[e.RandomUtils.getRandomIntFromRange(0,t.length-1)]},n.prototype.exit=function(){this.state="exiting",window.clearTimeout(this.randomIdleTimeout),e.AudioManager.playSound("jump"),this.animation.state.setAnimationByName("jump")},n.prototype.updateCleanliness=function(){e.GameConfig.setVal("cleanliness",this.cleanliness.toJSON());for(var t=0;t<this.dirty.length;t+=1)this.dirty[t].alpha=1-this.cleanliness.strength},n.prototype.updateSatiety=function(){e.GameConfig.setVal("satiety",this.satiety.toJSON())},n.prototype.updateAffection=function(){e.GameConfig.setVal("affection",this.affection.toJSON())},Object.defineProperty(n.prototype,"health",{get:function(){var t=this.cleanliness.health+this.satiety.health+this.affection.health;return this.queryCount++%10===0&&(this.updateCleanliness(),this.updateSatiety(),this.updateAffection(),e.Debug.log("cleanliness	strength	health"),e.Debug.log("           	"+this.cleanliness.strength.toFixed(2)+"       	"+this.cleanliness.health.toFixed(2)),e.Debug.log("satiety    	strength	health"),e.Debug.log("           	"+this.satiety.strength.toFixed(2)+"       	"+this.satiety.health.toFixed(2)),e.Debug.log("affection  	strength	health"),e.Debug.log("           	"+this.affection.strength.toFixed(2)+"       	"+this.affection.health.toFixed(2))),t}}),n.prototype.beforeRender=function(){"entering"===this.state&&this.animation.state&&this.animation.state.isComplete()&&this.animation.state.current&&"jump"===this.animation.state.current.name&&(this.state="idle")},n.prototype.afterRender=function(){},n.prototype.onHide=function(){this.animation.visible=!1,this.animation.state.clearAnimation()},n.prototype.onShow=function(){this.enter()},n}),define("petengine/careenviron",["pixi","absolute","petengine/careitemlist","careitemfactory"],function(t,e,i,n){var o=function(t,e,i,n,o){this.initCareEnviron(t,e,i,n,o)};return o.constructor=o,o.prototype=Object.create(t.DisplayObjectContainer.prototype),o.prototype.initCareEnviron=function(e,n,o,r,s){t.DisplayObjectContainer.call(this),this.ui=e,this.moveScale=n,this.itemDropPoint=r,this.pet=s,this.queryCount=0,this.itemArea=o||new t.Rectangle(0,.5*this.ui.height,this.ui.width,.5*this.ui.height),this.items=new i,this.items.load(null,this.pet.petAreas),this.populateItems()},o.prototype.healthChanged=function(){e.EventBus.dispatchEvent("EnvironHealthChanged")},Object.defineProperty(o.prototype,"health",{get:function(){for(var t=0,e=0;e<this.items.items.length;e+=1){var i=this.items.items[e];if(t+=i.health,i.health<=0&&this.removeItem(i,e),t>1){t=1;break}}return this.queryCount++%10===0&&this.items.save(),t}}),o.prototype.populateItems=function(){for(var e=0;e<this.items.items.length;e+=1){var i=this.items.items[e];i.config&&i.config.skipScaling?(i.scale.x=i.scale.y=1,i.limit=new t.Rectangle(0,0,this.ui.width,this.ui.height)):(i.scale.x=i.scale.y=this.getScale(i.position.y),i.limit=this.itemArea,i.onMove=this.handleMoveItem.bind(this)),i.onGrab=this.handleGrabItem.bind(this),i.onDrop=this.handleDropItem.bind(this),this.insertItem(i)}this.insertItem(this.pet)},o.prototype.addItem=function(t){var i=this.makeItem(t);i.position.x=e.Coords.x(this.itemDropPoint.x),i.position.y=e.Coords.y(this.itemDropPoint.y),"undefined"!=typeof t.offsetY&&(i.position.y+=-(t.offsetY/2)),this.insertItem(i),this.items.addItem(i),this.items.save(),i.visible=!0,this.healthChanged()},o.prototype.makeItem=function(t){var i={};return i.boost=t.boost,i.duration=t.duration,i.remaining=t.duration,i.anchorX=t.anchorX,i.anchorY=t.anchorY,i.offsetY=e.Coords.y(t.offsetY),i.name=t.name,i.scale=t.scale||{x:1,y:1},i.image=t.image,i.skipScaling=t.skipScaling||!1,t.animated?(i.kind="animated",i.assetName=t.name):(i.kind="static",i.assetName=t.image),n.makeCareItem(i,this.itemArea,this.handleGrabItem.bind(this),this.handleMoveItem.bind(this),this.handleDropItem.bind(this),this.pet.petAreas)},o.prototype.removeItem=function(t,i){e.TweenUtils.fadeOut([t],{duration:500},function(){this.items.removeItem(i),this.items.save();try{this.removeChild(t)}catch(e){}}.bind(this))},o.prototype.handleGrabItem=function(t){try{this.removeChild(t)}catch(i){}this.addChild(t),e.AudioManager.playSound("care_object_move")},o.prototype.getScale=function(t){var e=(t-this.itemArea.y)/this.itemArea.height;return e+=this.moveScale,e>1&&(e=1),e},o.prototype.handleMoveItem=function(t){t.scale.x=t.scale.y=this.getScale(t.position.y),this.insertItem(t)},o.prototype.handleDropItem=function(t){this.insertItem(t),this.items.save()},o.prototype.insertItem=function(t){try{this.removeChild(t)}catch(e){}if(t.config&&t.config.skipScaling)i=this.children.length;else for(var i=0;i<this.children.length&&!(t.position.y<this.children[i].position.y);i+=1);this.addChildAt(t,i)},o.prototype.onShow=function(){this.items.onShow()},o.prototype.onHide=function(){this.items.onHide()},o}),define("carescreenconfig",["artconfig"],function(t){var e={on:"dolphin_health_icon_on.png",off:"dolphin_health_icon_off.png",gutterWidth:0,y:30},i={on:"lagoon_health_icon_on.png",off:"lagoon_health_icon_off.png",gutterWidth:0,y:25},n={careMenus:{petMenu:[{name:"sponge",image:t.storePetItems[0],price:5,use:"pet",boost:.1,boostImages:e,duration:450},{name:"food1",image:t.storePetItems[1],price:5,use:"pet",boost:.15,boostImages:e,duration:300,anchorY:.5},{name:"food2",image:t.storePetItems[2],price:10,use:"pet",boost:.2,boostImages:e,duration:450,anchorY:.5},{name:"food3",image:t.storePetItems[3],price:15,use:"pet",boost:.25,boostImages:e,duration:600,anchorY:.5},{name:"food4",image:t.storePetItems[4],price:20,use:"pet",boost:.3,boostImages:e,duration:600,anchorY:.5},{name:"food5",image:t.storePetItems[5],price:50,use:"pet",boost:.5,boostImages:e,duration:600,anchorY:.5}],environmentMenu:[{image:t.storeEnvironmentItems[15],price:5,use:"environment",boost:.1,boostImages:i,duration:1200,anchorY:.99},{image:t.storeEnvironmentItems[4],price:10,use:"environment",boost:.1,boostImages:i,duration:900,anchorY:.99},{image:t.storeEnvironmentItems[5],price:15,use:"environment",boost:.15,boostImages:i,duration:1e3,anchorY:.99},{image:t.storeEnvironmentItems[6],price:25,use:"environment",boost:.25,boostImages:i,duration:1100,anchorY:.99},{image:t.storeEnvironmentItems[7],price:35,use:"environment",boost:.35,boostImages:i,duration:1200,anchorY:.99},{image:t.storeEnvironmentItems[8],price:45,use:"environment",boost:.45,boostImages:i,duration:1400,anchorY:.99},{image:t.storeEnvironmentItems[9],price:10,use:"environment",boost:.1,boostImages:i,duration:900,anchorY:.99,offsetY:0},{image:t.storeEnvironmentItems[10],price:25,use:"environment",boost:.25,boostImages:i,duration:1800,anchorY:.99},{image:t.storeEnvironmentItems[11],price:40,use:"environment",boost:.2,boostImages:i,duration:1800,anchorY:.99},{image:t.storeEnvironmentItems[12],price:50,use:"environment",boost:.25,boostImages:i,duration:1800,anchorY:.99},{name:"ropeSwing",image:t.storeEnvironmentItems[13],price:5,use:"environment",boost:.25,boostImages:i,duration:2400,anchorY:.99,offsetY:-50},{name:"bumblebee",image:t.storeEnvironmentItems[0],animated:!0,price:15,use:"environment",boost:.2,boostImages:i,duration:1200,anchorY:.5,offsetY:0,skipScaling:!0},{name:"butterfly",image:t.storeEnvironmentItems[1],animated:!0,price:25,use:"environment",boost:.25,boostImages:i,duration:1800,anchorY:.5,offsetY:0,skipScaling:!0},{name:"mouse",image:t.storeEnvironmentItems[2],animated:!0,price:50,use:"environment",boost:.35,boostImages:i,duration:2100,anchorY:.99,offsetY:0},{name:"gopher",image:t.storeEnvironmentItems[3],animated:!0,price:60,use:"environment",boost:.35,boostImages:i,duration:2400,anchorY:.99,offsetY:0},{name:"water",image:t.storeEnvironmentItems[16],animated:!1,price:60,use:"environment",boost:.4,boostImages:i,duration:2400,anchorY:0,offsetY:0}]},careItemMoveScaleMin:.4,petAreaRects:[{x:700,y:720,width:400,height:250,name:"head"},{x:800,y:970,width:450,height:200,name:"body"}],itemAreaRect:{x:0,y:850,width:2008,height:686},itemDropPoint:{x:950,y:1450}};return n}),define("petengine/carescreen",["pixi","absolute","petengine/careitemmenu","careitemfactory","petengine/carehud","petengine/careitemlist","carepet","petengine/careenviron","petengine/wallet","carescreenconfig","petengine/tutorial","artconfig","absoluteaudio"],function(t,e,i,n,o,r,s,a,h,l,u,c,p){var d=function(t,i){this.dialogOptions={name:"caremenu",content:"",width:e.Coords.x(1900),height:e.Coords.y(1300),y:e.Coords.y(180),pageChangedCallback:this.saveLastPageViewedInStore.bind(this)},this.initCareScreen(t,i)};return d.prototype=Object.create(e.Screen.prototype),d.prototype.initCareScreen=function(i,n){e.Screen.call(this),this.ui=i,this.game=n,this.menu=null,this.petAreas=[];for(var r=0;r<l.petAreaRects.length;r++){var s=new t.Rectangle(e.Coords.x(l.petAreaRects[r].x),e.Coords.y(l.petAreaRects[r].y),e.Coords.x(l.petAreaRects[r].width),e.Coords.y(l.petAreaRects[r].height));this.petAreas.push(s),"body"===l.petAreaRects[r].name&&(this.petArea=s)}this.itemArea=new t.Rectangle(e.Coords.x(l.itemAreaRect.x),e.Coords.y(l.itemAreaRect.y),e.Coords.x(l.itemAreaRect.width),e.Coords.y(l.itemAreaRect.height)),this.bg=this.makeBackground(),this.fg=this.makeForeground(),this.pet=this.makePet(),this.pet.petAreas=this.petAreas,this.environment=new a(this.ui,l.careItemMoveScaleMin,this.itemArea,l.itemDropPoint,this.pet),this.wallet=new h(this.game),this.edible=null,this.careUI=this.makeCareUI(),this.background.addChild(this.bg),this.addChild(this.environment),this.addChild(this.fg),this.addChild(this.careUI),this.hud=new o(this.game),e.LayoutHelper.layout(this.hud,"CareScreen","hud"),this.addChild(this.hud),this.tutorial=new u(this.ui,{name:"carescreen",queue:this.game.tutorialConfig.careScreen,pageIndicators:this.game.tutorialConfig.pageIndicators})},d.prototype.showMenu=function(t){this._stopTutorial(),null===this.edible&&(this.dialogOptions.pages=t.pages,this.dialog=new e.MultiPageDialog(this.ui,this.dialogOptions),this.dialog.open())},d.prototype.onCloseMenu=function(){this.dialog.close()},d.prototype.onBuyItem=function(i){var n=this.wallet.withdraw(i.price);if(n)"environment"===i.use?this.environment.addItem(i):"sponge"===i.name?(this.sponge=this.makeSponge(i),this.sponge.position.x=this.petArea.x+this.petArea.width/2,this.sponge.position.y=this.petArea.y+this.petArea.height/2,this.addChild(this.sponge),this.sponge.visible=!0):-1!==i.name.indexOf("food")&&(this.edible=this.makeEdible(i),this.addChild(this.edible),this.edible.visible=!0,this.edible.drop(e.Coords.x(this.ui.layout.CareScreen.edibleDrop.x),e.Coords.y(this.ui.layout.CareScreen.edibleDrop.y),e.Coords.y(this.ui.layout.CareScreen.edibleDrop.dy),function(){this.pet.feed(this.edible,function(){this.removeChild(this.edible),this.edible=null}.bind(this))}.bind(this))),this.dialog.close();else{var o=new t.DisplayObjectContainer,r=new t.Graphics,s=e.Sprite.fromFrame("MDS_text_notenough.png"),a=.3;s.position.x=(this.menu.width-s.width)/2,s.position.y=(this.menu.height-s.height)/2,r.beginFill(65793,.5),r.drawRect(s.position.x-s.width*(a/2),s.position.y-s.height*(a/2),s.width*(1+a),s.height*(1+a)),r.endFill(),o.addChild(r),o.addChild(s),this.dialog.addChild(o),e.TweenUtils.fadeOut([o],{duration:500,delay:2e3},function(){this.dialog.removeChild(o)}.bind(this))}},d.prototype.makeSponge=function(t){var e={};return e.name="sponge",e.boost=t.boost,e.duration=t.duration,e.created=Date.now(),e.kind="static",e.assetName=t.image,n.makeCareItem(e,this.petArea,this.handleGrabSponge.bind(this),this.handleMoveSponge.bind(this),this.handleDropSponge.bind(this))},d.prototype.makeEdible=function(t){var e={};e.name=t.name,e.boost=t.boost,e.duration=t.duration,e.created=Date.now(),e.kind="sinking",e.assetName=t.image;var i=n.makeCareItem(e,this.petAreas,function(){this.sinking&&(this.sinking.stop(),this.sinking=null)}.bind(this),function(){},function(){});return i},d.prototype.handleGrabSponge=function(){},d.prototype.handleMoveSponge=function(){if(this.sponge)if(this.pet.isDirty())this.pet.scrub(this.sponge);else{this.sponge.stopSound(),this.removeChild(this.sponge),e.AudioManager.playSound("pet_clean_sparkle");for(var t=this,i=0;3>i;i+=1){var n=e.Sprite.fromFrame("sparkle.png");n.pivot.x=n.width/2,n.pivot.y=n.height/2,n.position.x=this.sponge.position.x+Math.random()*e.Coords.x(100),n.position.y=this.sponge.position.y+Math.random()*e.Coords.y(100),this.addChild(n),new TWEEN.Tween({s:n,scale:n.scale.x,alpha:1}).delay(50*i).to({scale:10,alpha:0},300).easing(TWEEN.Easing.Cubic.In).onUpdate(function(){this.s.alpha=this.alpha,this.s.scale.x=this.s.scale.y=this.scale}).onComplete(function(){t.removeChild(this.s)}).start()}this.sponge=null}},d.prototype.handleDropSponge=function(){},d.prototype.makeBackground=function(){var i=new t.CanvasRenderer(this.ui.width,this.ui.height);i.context.clearRect(0,0,this.ui.width,this.ui.height),i.context.rect(0,0,this.ui.width,this.ui.height);for(var n=i.context.createLinearGradient(0,0,0,this.ui.height),o=0;o<c.backgroundGradient.length;o++)n.addColorStop(c.backgroundGradient[o].location,c.backgroundGradient[o].color);
i.context.fillStyle=n,i.context.fill();var r=new t.DisplayObjectContainer,s=new t.Sprite(t.Texture.fromCanvas(i.view));r.addChild(s);var a=e.Sprite.fromFrame(c.background.url);if(a.position.x=0,a.position.y=e.Coords.y(c.background.y),r.addChild(a),c.distantBackgroundItems)for(var o=0;o<c.distantBackgroundItems.length;o++){var h=new e.Sprite.fromFrame(c.distantBackgroundItems[o].url);h.position.x=e.Coords.x(c.distantBackgroundItems[o].x),h.position.y=e.Coords.y(c.distantBackgroundItems[o].y),h.scale.x=c.distantBackgroundItems[o].scaleX,-1==c.distantBackgroundItems[o].scaleX&&(h.position.x-=h.width),r.addChild(h)}var l=e.Sprite.fromFrame(c.middleGround.url);l.position.x=0,l.position.y=e.Coords.y(c.middleGround.y),r.addChild(l);var u={minSpacing:c.randomItemSpacing,minScale:.4,minAlpha:.4},p=new t.DisplayObjectContainer;r.addChild(e.RandomUtils.distributeItems(this.ui,c.randomBackgroundItems,this.itemArea,p,u));for(var o=0;o<c.positionedBackgroundItems.length;o++){var d=e.Sprite.fromFrame(c.positionedBackgroundItems[o].url);d.position.x=e.Coords.x(c.positionedBackgroundItems[o].x),d.position.y=e.Coords.y(c.positionedBackgroundItems[o].y),r.addChild(d)}var f=new t.RenderTexture(this.ui.width,this.ui.height);return f.render(r),new t.Sprite(f)},d.prototype.makeForeground=function(){for(var i=new t.DisplayObjectContainer,n=0;n<c.positionedForegroundItems.length;n++){var o=e.Sprite.fromFrame(c.positionedForegroundItems[n].url);o.position.x=e.Coords.x(c.positionedForegroundItems[n].x),o.position.y=e.Coords.y(c.positionedForegroundItems[n].y),i.addChild(o)}var r=new t.RenderTexture(this.ui.width,this.ui.height);return r.render(i),new t.Sprite(r)},d.prototype.makeCareUI=function(){var n=new t.DisplayObjectContainer;return this.optionsMenuButton=new e.Button(e.Texture.fromFrame(c.pauseButton),e.Texture.fromFrame(c.pauseButton),function(){this._stopTutorial(),this.ui.showOptionsModal(function(){},function(){this.tutorial.start(!0)}.bind(this),!1)}.bind(this),!0),e.LayoutHelper.layout(this.optionsMenuButton,"CareScreen","optionsMenuButton"),n.addChild(this.optionsMenuButton),this.petStoreButton=new e.Button(e.Texture.fromFrame(c.petStoreButton),e.Texture.fromFrame(c.petStoreButton),function(){this.menu=this.petMenu,this.showMenu(this.petMenu)}.bind(this),!0),e.LayoutHelper.layout(this.petStoreButton,"CareScreen","petStoreButton"),n.addChild(this.petStoreButton),this.trainModeButton=new e.Button(e.Texture.fromFrame(c.trainButton),e.Texture.fromFrame(c.trainButton),function(){this.trainModeButton.interactive=!1,this._stopTutorial(),this.pet.exit(),setTimeout(function(){this.game.selectLevel()}.bind(this),1500)}.bind(this),!0),e.LayoutHelper.layout(this.trainModeButton,"CareScreen","trainModeButton"),n.addChild(this.trainModeButton),this.environmentStoreButton=new e.Button(e.Texture.fromFrame(c.environmentStoreButton),e.Texture.fromFrame(c.environmentStoreButton),function(){this.menu=this.environementMenu,this.showMenu(this.environementMenu)}.bind(this),!0),e.LayoutHelper.layout(this.environmentStoreButton,"CareScreen","environmentStoreButton"),n.addChild(this.environmentStoreButton),this.petMenu=new i(this.ui,this.game,l.careMenus.petMenu,this.onBuyItem.bind(this),this.onCloseMenu.bind(this)),this.petMenu.position.x=e.Coords.x(110),this.petMenu.position.y=e.Coords.y(70),this.environementMenu=new i(this.ui,this.game,l.careMenus.environmentMenu,this.onBuyItem.bind(this),this.onCloseMenu.bind(this)),this.environementMenu.position.x=e.Coords.x(110),this.environementMenu.position.y=e.Coords.y(70),n},d.prototype.makePet=function(){var t=new s(this.ui);return t},d.prototype.configLevel=function(t){this.level=t},d.prototype.handlePause=function(){},d.prototype.handleResume=function(){},d.prototype.onShow=function(){e.Screen.prototype.onShow.call(this),this.hidden=!1,this.trainModeButton.interactive=!0,this.updateHealthMeters(),this.pet.onShow(),this.environment.onShow(),this.tutorialTimeout=window.setTimeout(function(){this.tutorial.start()}.bind(this),2300),e.MusicManager.stopMusic(),p.context.usingWebAudio()?e.MusicManager.playMusic("care_mode_music"):window.setTimeout(function(){e.MusicManager.playMusic("care_mode_music")},500)},d.prototype.onHide=function(){window.SpilGameAPIInstance.GameBreak.request(function(){e.MusicManager.stopMusic()},function(){this.environment.onHide(),this.pet.onHide(),this.hidden=!0,e.Screen.prototype.onHide.call(this)}.bind(this))},d.prototype.beforeRender=function(){this.hidden||this.pet.beforeRender()},d.prototype.afterRender=function(){this.hidden||this.pet.afterRender()},d.prototype.updateHealthMeters=function(){this.hidden||(this.hud.setDolphinHealth(this.pet.health),this.hud.setLagoonHealth(this.environment.health),setTimeout(this.updateHealthMeters.bind(this),1e3))},d.prototype._stopTutorial=function(){"undefined"!=typeof this.tutorialTimeout&&(clearTimeout(this.tutorialTimeout),this.tutorial.stop(!0))},d.prototype.saveLastPageViewedInStore=function(t){this.dialogOptions.startPage=t},d}),define("petengine/optionsmodal",["pixi","absolute","absoluteaudio"],function(t,e,i){var n=function(t,e,i){var i=i||{helpCallback:function(){}};this.initOptionsScreen(t,e,i)};return n.prototype=Object.create(e.Dialog.prototype),n.prototype.initOptionsScreen=function(t,i,n){this.ui=t,this.game=i,n.content=this._buildButtons(),e.Dialog.call(this,t,n),this.originalHeight=this.options.height||0},n.prototype._buildButtons=function(){function n(){d.action()}var o=new t.DisplayObjectContainer;o.width=this.ui.width,o.height=this.ui.height;var r=new e.ToggleButton("btn_options_MUSIC",function(){e.MusicManager.setMuted(!e.MusicManager.isMuted())},!e.MusicManager.isMuted(),!1);i.context.usingWebAudio()||e.AudioManager.setSfxEnabled(!1);var s=new e.ToggleButton("btn_options_SFX",function(){e.AudioManager.setSfxEnabled(!e.AudioManager.isSfxEnabled())},e.AudioManager.isSfxEnabled(),!1);this.careButton=new e.Button(e.Texture.fromFrame("btn_caremode_summary.png"),e.Texture.fromFrame("btn_caremode_summary.png"),function(){this.close(),this.game.back()}.bind(this),!0),e.LayoutHelper.layout(this.careButton,"OptionsScreen","careButton"),this.careText=e.Sprite.fromFrame("MDS_text_returnlagoon.png"),this.careText.position.x=this.careButton.position.x+this.careButton.width/2-this.careText.width/2,this.careText.position.y=this.careButton.position.y+this.careButton.height+e.Coords.y(15),this.careButton.interactive=!1,this.careButton.visible=!1,this.careText.visible=!1;{var a,h,l=new e.Button(e.Texture.fromFrame("btn_options_HTP.png"),e.Texture.fromFrame("btn_options_HTP.png"),function(){this.close(),window.setTimeout(function(){this.options.helpCallback()}.bind(this),100)}.bind(this),!0);new t.DisplayObjectContainer}if("undefined"!=typeof window.SpilGameAPIInstance&&window.AH_show_branding){var u=window.SpilGameAPIInstance.Branding.getLogo(),c=e.Coords.x(40);if(u.image){var p=new t.ImageLoader(u.image);p.addEventListener("loaded",function(){function i(){u.action()}a=t.Sprite.fromFrame(u.image),a.scale.x=a.scale.y=e.Coords.x(404)/a.width,a.click=i,a.touchstart=i,a.position.x=c,a.position.y=e.Coords.y(740),a.buttonMode=!0,a.setInteractive(!0),o.addChild(a)}.bind(this)),p.load()}var d=window.SpilGameAPIInstance.Branding.getLink("more_games");d&&(h=new t.Sprite.fromFrame("btn_moregames_404.png"),h.scale.x=h.scale.y=e.Coords.x(404)/h.width,h.mousedown=n,h.touchstart=n,h.position.x=e.Coords.x(1150),h.position.y=e.Coords.y(760),h.buttonMode=!0,h.setInteractive(!0),o.addChild(h))}return e.LayoutHelper.layout(r,"OptionsScreen","musicButton"),e.LayoutHelper.layout(s,"OptionsScreen","sfxButton"),e.LayoutHelper.layout(l,"OptionsScreen","htpButton"),o.addChild(r),o.addChild(s),o.addChild(l),o.addChild(this.careButton),o.addChild(this.careText),o},n.prototype.open=function(t,i,n){i="function"==typeof i?i:function(){},this.options.helpCallback=i,this.careButton.interactive=n,this.careButton.visible=n,this.careText.visible=n,this.updateDialog(this.options),e.Dialog.prototype.open.call(this,t)},n}),define("petengine/levelselectbutton",["pixi","absolute"],function(t,e){"use strict";var i=function(t,e,i){this.initLevelSelectButton(t,e,i)};return i.prototype=Object.create(t.DisplayObjectContainer.prototype),i.prototype.initLevelSelectButton=function(e,i,n){t.DisplayObjectContainer.call(this),this.ui=e,this.level=i,this.levelIndex=i.getId(),this.levelConfig=i.getConfig(),this.locked=i.isLocked(),this.score=i.getScore(),this.scorePossible=i.getScorePossible(),this.complete=i.isComplete(),this.buttonImages={play:"btn_level_playlevel.png",replay:"btn_main_REPLAYlevel.png",locked:"btn_level_locked.png"},this.setEnable(!this.locked),this.tap=this.click=function(){this.locked||n(this.levelIndex)}.bind(this),this.render()},i.prototype.render=function(){for(this.setStateImage();this.children.length>0;)this.removeChild(this.getChildAt(0));var t=e.Sprite.fromFrame("levelselect_pane.png");this.width=t.width,this.height=t.height;var i=new e.DigitLabel(5,this.ui.layout.LevelSelectButton.levelNumber.scale,"MDS_number");i.setText(String((this.levelIndex+1).toString())),i.position.x=e.Coords.x(this.ui.layout.LevelSelectButton.levelNumber.x)-i.width/2,i.position.y=e.Coords.y(this.ui.layout.LevelSelectButton.levelNumber.y),t.addChild(i);var n=e.Sprite.fromFrame("MDS_number_hack.png");n.scale.x=this.ui.layout.LevelSelectButton.score.scale,n.scale.y=this.ui.layout.LevelSelectButton.score.scale,n.position.x=e.Coords.x(this.ui.layout.LevelSelectButton.score.x),n.position.y=e.Coords.y(this.ui.layout.LevelSelectButton.score.y),t.addChild(n);var o=new e.DigitLabel(3,this.ui.layout.LevelSelectButton.score.scale,"MDS_number");o.setText(String(this.score.toString())),o.position.x=e.Coords.x(this.ui.layout.LevelSelectButton.score.x)-o.width,o.position.y=e.Coords.y(this.ui.layout.LevelSelectButton.score.y),t.addChild(o);var r=new e.DigitLabel(3,this.ui.layout.LevelSelectButton.score.scale,"MDS_number");r.setText(String(this.scorePossible.toString())),r.position.x=e.Coords.x(this.ui.layout.LevelSelectButton.score.x)+n.width,r.position.y=e.Coords.y(this.ui.layout.LevelSelectButton.score.y),t.addChild(r);var s=e.Sprite.fromFrame(this.stateImage);s.position.x=e.Coords.x(this.ui.layout.LevelSelectButton.stateButton.x),s.position.y=e.Coords.y(this.ui.layout.LevelSelectButton.stateButton.y),t.addChild(s);var a=this.getMedalMasks();t.addChild(a),this.addChild(t)},i.prototype.setStateImage=function(){this.stateImage=this.buttonImages.locked,this.stateImage=this.locked?this.buttonImages.locked:this.complete?this.buttonImages.replay:this.buttonImages.play},i.prototype.getMedalMasks=function(){for(var i=this.level.totalMedals-this.level.getLevelAchieved(),n=new t.DisplayObjectContainer,o=0;i>o;o++){var r=e.Sprite.fromFrame("levelselect_empty_medal.png");r.position.x=e.Coords.x(this.ui.layout.LevelSelectButton.medalMask.x)-o*r.width-o*e.Coords.x(this.ui.layout.LevelSelectButton.medalMask.gutter),r.position.y=e.Coords.y(this.ui.layout.LevelSelectButton.medalMask.y),n.addChild(r)}return n},i.prototype.setLocked=function(t){this.locked=t,this.locked||this.setEnable(!0)},i.prototype.setScore=function(t){this.score=t,this.level.setScore(t)},i.prototype.setComplete=function(t){this.complete=t},i.prototype.setEnable=function(t){this.setInteractive(t)},i}),define("petengine/scoresummary",["pixi","absolute","petengine/levelselectbutton","petengine/wallet","petengine/tutorial","absoluteaudio"],function(t,e,i,n,o){var r=function(t,e){this.initScoreSummaryScreen(t,e)};return r.prototype=Object.create(e.Screen.prototype),r.prototype.initScoreSummaryScreen=function(t,i){e.Screen.call(this),this.ui=t,this.game=i,this.wallet=new n(i),this.medalText=["","MDS_text_bronzemedal.png","MDS_text_silvermedal.png","MDS_text_goldmedal.png"],this.tutorial=new o(this.ui,{name:"levelCompleteToLagoon",queue:this.game.tutorialConfig.levelCompleteToLagoon})},r.prototype.onShow=function(){if(e.Screen.prototype.onShow.call(this),this.visible=!0,this.interactive=!0,this.summaryPanel)try{this.removeChild(this.summaryPanel)}catch(n){}this.summaryPanel=new t.DisplayObjectContainer,this.level=this.game.levelManager.getSelectedLevel();var o=this.level.getId();this.level.setScore(this.game.levelManager.getLevelState(o).currentScore);var r=this.game.levelManager.getLevel(this.level.getId()+1);this.hasNextLevel=r&&!r.isLocked(),this.summaryPanel.addChild(this.addText()),this.summaryPanel.addChild(this.addButtons());var s=new i(this.ui,this.level,this.replay.bind(this));s.position.x=(this.ui.width-s.width)/2,s.position.y=e.Coords.y(this.ui.layout.ScoreSummaryScreen.levelDetails.y),this.summaryPanel.addChild(s),this.summaryPanel.y=-e.Coords.y(185),this.addChild(this.summaryPanel),e.MusicManager.stopMusic(),this.tutorialTimeout=window.setTimeout(function(){this.tutorial.start()}.bind(this),2300)},r.prototype.onHide=function(){e.Screen.prototype.onHide.call(this),this.visible=!1,this.interactive=!1,this._stopTutorial()},r.prototype.addButton=function(t,i,n,o){var r=new e.Button(e.Texture.fromFrame(i),e.Texture.fromFrame(i),o,!0);return e.LayoutHelper.layout(r,"ScoreSummaryScreen",n),t.addChild(r),r},r.prototype.addButtons=function(){function i(){u.action()}var n=new t.DisplayObjectContainer;n.width=this.ui.width,n.height=this.ui.height,this.addButton(n,"btn_main_LAGOONRETURN.png","levelSelectButton",this.toLevelSelect.bind(this)),this.hasNextLevel?this.addButton(n,"btn_main_PLAY.png","playButton",this.nextLevel.bind(this)):this.addButton(n,"btn_main_REPLAY.png","playButton",this.replay.bind(this));var o=new e.Button(e.Texture.fromFrame("btn_caremode_summary.png"),e.Texture.fromFrame("btn_caremode_summary.png"),this.toLagoon.bind(this),!0);if(o.position.x=(this.ui.width-o.width)/2,o.position.y=e.Coords.y(this.ui.layout.ScoreSummaryScreen.goToLagoon.y),n.addChild(o),"undefined"!=typeof window.SpilGameAPIInstance&&window.AH_show_branding){var r,s,a=(new t.DisplayObjectContainer,window.SpilGameAPIInstance.Branding.getLogo()),h=e.Coords.x(40);if(a.image){var l=new t.ImageLoader(a.image);l.addEventListener("loaded",function(){function i(){a.action()}r=t.Sprite.fromFrame(a.image),r.scale.x=r.scale.y=e.Coords.x(404)/r.width,r.click=i,r.touchstart=i,r.position.x=h,r.position.y=e.Coords.y(1580),r.buttonMode=!0,r.setInteractive(!0),n.addChild(r)}.bind(this)),l.load()}var u=window.SpilGameAPIInstance.Branding.getLink("more_games");u&&(s=new t.Sprite.fromFrame("btn_moregames_404.png"),s.scale.x=s.scale.y=e.Coords.x(404)/s.width,s.mousedown=i,s.touchstart=i,s.position.x=this.ui.width-s.width*s.scale.x-h,s.position.y=e.Coords.y(1600),s.buttonMode=!0,s.setInteractive(!0),n.addChild(s))}return n.position.x=(n.width-this.ui.width)/2,n.position.y=(n.height-this.ui.height)/2,n},r.prototype.addText=function(){var i=new t.DisplayObjectContainer;i.position.x=0,i.position.y=0;var n=e.Sprite.fromFrame("MDS_text_greatjob.png");n.position.x=(this.ui.width-n.width)/2,n.position.y=e.Coords.y(this.ui.layout.ScoreSummaryScreen.headline.y);var o=this.level.getLevelAchieved();if(o>0){var r=e.Sprite.fromFrame(this.medalText[this.level.getLevelAchieved()]);r.position.x=(this.ui.width-r.width)/2,r.position.y=e.Coords.y(this.ui.layout.ScoreSummaryScreen.awardMessage.y),i.addChild(r)}var s=e.Sprite.fromFrame("MDS_text_levelselect.png");e.LayoutHelper.layout(s,"ScoreSummaryScreen","levelSelectText");var a=e.Sprite.fromFrame("MDS_text_returnlagoon.png");if(a.position.x=(this.ui.width-a.width)/2,a.position.y=e.Coords.y(this.ui.layout.ScoreSummaryScreen.goToLagoonText.y),this.hasNextLevel){var h=e.Sprite.fromFrame("MDS_text_bronzenextchallenge.png");e.LayoutHelper.layout(h,"ScoreSummaryScreen","nextLevelText"),i.addChild(h)}return i.addChild(n),i.addChild(s),i.addChild(a),i},r.prototype.nextLevel=function(){function t(){this.resume(),this.ui.hideModal(),this.game.levelManager.setNextLevel(this.level.getId()+1)?this.game.train():this.toLevelSelect()}this._stopTutorial(),e.Integration.spil.gameBreak.call(this,t,this.pause)},r.prototype.toLevelSelect=function(){function t(){this.resume(),this.ui.hideModal(),this.game.selectLevel()}this._stopTutorial(),e.Integration.spil.gameBreak.call(this,t,this.pause)},r.prototype.replay=function(){function t(){this.resume(),this.ui.hideModal(),this.game.train()}this._stopTutorial(),e.Integration.spil.gameBreak.call(this,t,this.pause)},r.prototype.toLagoon=function(){function t(){this.resume(),this.game.back()}this._stopTutorial(),e.Integration.spil.gameBreak.call(this,t,this.pause)},r.prototype._stopTutorial=function(){"undefined"!=typeof this.tutorialTimeout&&(clearTimeout(this.tutorialTimeout),this.tutorial.stop(!0))},r.prototype.resume=function(){this.paused=!1,e.MusicManager.isMuted()||e.MusicManager.playMusic("train_mode_music"),e.AudioManager.isSfxEnabled()&&e.AudioManager.unmuteAll()},r.prototype.pause=function(){this.paused||(this.paused=!0,e.MusicManager.stopMusic(),e.AudioManager.isSfxEnabled()&&e.AudioManager.muteAll())},r}),define("petengine/levelselectpanel",["absolute","petengine/levelselectbutton","pixi"],function(t,e,i){var n=function(t,e,i){this.ui=t,this.game=e,this.completed=!1,this._initLevelSelectPanel(t,e,i)};return n.prototype=Object.create(i.DisplayObjectContainer.prototype),n.prototype._initLevelSelectPanel=function(t,n,o){i.DisplayObjectContainer.call(this),this.startIndex=o,this.levels=this.game.levelManager.getLevels(),this.levelButtons=[];for(var r=0;r<this.levels.length;++r)this.levelButtons.push(new e(this.ui,this.levels[r],this.levelSelected.bind(this)));this.layoutButtons()},n.prototype.layoutButtons=function(){for(var t=this.levelButtons[0],e=t.width+t.width/8,i=t.height+t.height/50,n=(this.ui.width-(3*e-t.width/8))/2,o=(this.ui.height-(4*i-t.height/50))/2,r=0,s=this.levelButtons.length;s>r;++r)t=this.levelButtons[r],t.position.x=n+r%3*e,t.position.y=o,this.addChild(t),(r+1)%3===0&&(o+=i)},n.prototype.levelSelected=function(e){t.Debug.log("Level select pressed!"),this.game.levelManager.setSelectedLevel(e),this.game.train()},n.prototype.enableButtons=function(t){var e,i;for(e=0,i=this.levelButtons.length;i>e;e++)this.levelButtons[e].setEnable(t)},n.prototype.updateButtons=function(){for(var t=this.game.levelManager.getLevelStates(),e=0;e<this.levelButtons.length;e++)this.levelButtons[e].setLocked(t[e].locked),this.levelButtons[e].setScore(t[e].topScore),this.levelButtons[e].setComplete(t[e].complete),this.levelButtons[e].render()},n}),define("petengine/levelselectscreen",["absolute","petengine/levelselectpanel","petengine/trainingview","pixi"],function(t,e,i,n){var o=function(t,e){this.ui=t,this.game=e,this._initLevelSelectScreen(t,e)};return o.prototype=Object.create(t.Screen.prototype),o.prototype._initLevelSelectScreen=function(){t.Screen.call(this),this.trainingView=new i(this.ui,this.game,this),this.background.addChild(this.trainingView);var o=new t.Button(n.Texture.fromFrame("btn_main_LAGOONRETURN.png"),n.Texture.fromFrame("btn_main_LAGOONRETURN.png"),function(){this.game.back()}.bind(this));o.scale.x=o.scale.y=.5,o.position.x=t.Coords.x(30),o.position.y=this.ui.height-o.height-t.Coords.y(30),this.addChild(o),this.levelSelectPanel=new e(this.ui,this.game,0),this.addChild(this.levelSelectPanel)},o.prototype.onShow=function(){t.Screen.prototype.onShow.call(this),this.levelSelectPanel.updateButtons()},o.prototype.onHide=function(){t.Screen.prototype.onHide.call(this)},o}),define("petengine/petgameui",["absolute","petengine/mainmenu","petengine/trainscreen","petengine/loadingscreen","petengine/carescreen","petengine/optionsmodal","petengine/scoresummary","petengine/levelselectscreen"],function(t,e,i,n,o,r,s,a){var h=function(t,e,i,n,o,r){this._initPetGameUI(t,e,i,n,o,r)};return h.prototype=Object.create(t.GameUI.prototype),h.prototype._initPetGameUI=function(e,i,n,o,r,s){t.GameUI.call(this,i,n,o,s),this.game=e,this.layout=r,t.LayoutHelper.setLayoutMap(r)},h.prototype.load=function(h,l,u){var c=new t.Loader;c.loadArt(["loading.json"],function(){},function(){this.loadingScreen=new n(this,this.game),this.showScreen(this.loadingScreen),setTimeout(function(){var n=new t.Loader;n.loadAssets(h,function(t){this.render(),this.loadingScreen.updateLoadingProgress(t),l(t)}.bind(this),function(){this.mainMenu=new e(this,this.game),this.levelSelect=new a(this,this.game),this.careScreen=new o(this,this.game),this.trainScreen=new i(this,this.game),this.optionsModal=new r(this,this.game,{height:t.Coords.y(900)}),this.scoreSummaryModal=new s(this,this.game),t.MusicManager.setMuted(t.MusicManager.isMuted()),u(),this.animate()}.bind(this))}.bind(this),0)}.bind(this))},h.prototype.showGameScreen=function(){this.showScreen(this.gameScreen)},h.prototype.showCareScreen=function(){this.showScreen(this.careScreen)},h.prototype.showTrainScreen=function(){this.trainScreen.configLevel(this.game.levelManager.getSelectedLevel()),this.showScreen(this.trainScreen)},h.prototype.showMainMenu=function(){this.showScreen(this.mainMenu)},h.prototype.showLevelSelect=function(){this.showScreen(this.levelSelect)},h.prototype.showOptionsModal=function(t,e,i){this.optionsModal.open(t,e,i)},h.prototype.getScoreSummaryModal=function(){return this.scoreSummaryModal},h.prototype.handlePause=function(){this.trainScreen.handlePause()},h.prototype.handleResume=function(){this.trainScreen.handleResume()},h.prototype.beforeRender=function(){this.currentScreen&&this.currentScreen.beforeRender()},h.prototype.afterRender=function(){this.currentScreen&&this.currentScreen.afterRender()},h.prototype.handleVisibilityChange=function(t){this.currentScreen&&this.currentScreen.handleVisibilityChange(t)},h}),function(t){var e={VERSION:"2.2.0",Result:{SUCCEEDED:1,NOTRANSITION:2,CANCELLED:3,PENDING:4},Error:{INVALID_TRANSITION:100,PENDING_TRANSITION:200,INVALID_CALLBACK:300},WILDCARD:"*",ASYNC:"async",create:function(t,i){var n="string"==typeof t.initial?{state:t.initial}:t.initial,o=t.terminal||t["final"],r=i||t.target||{},s=t.events||[],a=t.callbacks||{},h={},l=function(t){var i=t.from instanceof Array?t.from:t.from?[t.from]:[e.WILDCARD];h[t.name]=h[t.name]||{};for(var n=0;n<i.length;n++)h[t.name][i[n]]=t.to||i[n]};n&&(n.event=n.event||"startup",l({name:n.event,from:"none",to:n.state}));for(var u=0;u<s.length;u++)l(s[u]);for(var c in h)h.hasOwnProperty(c)&&(r[c]=e.buildEvent(c,h[c]));for(var c in a)a.hasOwnProperty(c)&&(r[c]=a[c]);return r.current="none",r.is=function(t){return t instanceof Array?t.indexOf(this.current)>=0:this.current===t},r.can=function(t){return!this.transition&&(h[t].hasOwnProperty(this.current)||h[t].hasOwnProperty(e.WILDCARD))},r.cannot=function(t){return!this.can(t)},r.error=t.error||function(t,e,i,n,o,r,s){throw s||r},r.isFinished=function(){return this.is(o)},n&&!n.defer&&r[n.event](),r},doCallback:function(t,i,n,o,r,s){if(i)try{return i.apply(t,[n,o,r].concat(s))}catch(a){return t.error(n,o,r,s,e.Error.INVALID_CALLBACK,"an exception occurred in a caller-provided callback function",a)}},beforeAnyEvent:function(t,i,n,o,r){return e.doCallback(t,t.onbeforeevent,i,n,o,r)},afterAnyEvent:function(t,i,n,o,r){return e.doCallback(t,t.onafterevent||t.onevent,i,n,o,r)},leaveAnyState:function(t,i,n,o,r){return e.doCallback(t,t.onleavestate,i,n,o,r)},enterAnyState:function(t,i,n,o,r){return e.doCallback(t,t.onenterstate||t.onstate,i,n,o,r)},changeState:function(t,i,n,o,r){return e.doCallback(t,t.onchangestate,i,n,o,r)},beforeThisEvent:function(t,i,n,o,r){return e.doCallback(t,t["onbefore"+i],i,n,o,r)},afterThisEvent:function(t,i,n,o,r){return e.doCallback(t,t["onafter"+i]||t["on"+i],i,n,o,r)},leaveThisState:function(t,i,n,o,r){return e.doCallback(t,t["onleave"+n],i,n,o,r)},enterThisState:function(t,i,n,o,r){return e.doCallback(t,t["onenter"+o]||t["on"+o],i,n,o,r)},beforeEvent:function(t,i,n,o,r){return!1===e.beforeThisEvent(t,i,n,o,r)||!1===e.beforeAnyEvent(t,i,n,o,r)?!1:void 0},afterEvent:function(t,i,n,o,r){e.afterThisEvent(t,i,n,o,r),e.afterAnyEvent(t,i,n,o,r)},leaveState:function(t,i,n,o,r){var s=e.leaveThisState(t,i,n,o,r),a=e.leaveAnyState(t,i,n,o,r);return!1===s||!1===a?!1:e.ASYNC===s||e.ASYNC===a?e.ASYNC:void 0},enterState:function(t,i,n,o,r){e.enterThisState(t,i,n,o,r),e.enterAnyState(t,i,n,o,r)},buildEvent:function(t,i){return function(){var n=this.current,o=i[n]||i[e.WILDCARD]||n,r=Array.prototype.slice.call(arguments);if(this.transition)return this.error(t,n,o,r,e.Error.PENDING_TRANSITION,"event "+t+" inappropriate because previous transition did not complete");if(this.cannot(t))return this.error(t,n,o,r,e.Error.INVALID_TRANSITION,"event "+t+" inappropriate in current state "+this.current);if(!1===e.beforeEvent(this,t,n,o,r))return e.Result.CANCELLED;if(n===o)return e.afterEvent(this,t,n,o,r),e.Result.NOTRANSITION;var s=this;this.transition=function(){return s.transition=null,s.current=o,e.enterState(s,t,n,o,r),e.changeState(s,t,n,o,r),e.afterEvent(s,t,n,o,r),e.Result.SUCCEEDED},this.transition.cancel=function(){s.transition=null,e.afterEvent(s,t,n,o,r)};var a=e.leaveState(this,t,n,o,r);return!1===a?(this.transition=null,e.Result.CANCELLED):e.ASYNC===a?e.Result.PENDING:this.transition?this.transition():void 0}}};"function"==typeof define?define("state-machine",["require"],function(){return e}):t.StateMachine=e}(this),define("petengine/level",["petengine/wallet","absolute"],function(t,e){var i=function(t,e,i,n,o,r){this.initLevel(t,e,i,n,o,r)};return i.prototype.initLevel=function(t,e,i,n,o,r){this.game=t,this.levelNum=e,this.config=i,this.complete=o,this.score=r,this.setScorePossible(),this.locked=n,this.music=i.music||"game_bg_music",this.totalMedals=3},i.prototype.getLevelAchieved=function(){var t=this.score/this.scorePossible,e=0;return t>=this.config.gold?e=3:t>=this.config.silver?e=2:t>=this.config.bronze&&(e=1),e},i.prototype.getId=function(){return this.levelNum},i.prototype.getConfig=function(){return this.config},i.prototype.getScore=function(){return this.score},i.prototype.updateScore=function(t){this.score+t<=this.scorePossible&&(this.score=this.score+t),e.EventBus.dispatchEvent("Level:PointsScored")},i.prototype.setScore=function(t){t<=this.scorePossible&&(this.score=t)},i.prototype.getScorePossible=function(){return this.scorePossible},i.prototype.setScorePossible=function(){var t=["b","p","h","r","i"];return this.scorePossible=this.config.obstacles.split("").filter(function(e){return t.indexOf(e.toLowerCase())>-1}).length,this.scorePossible},i.prototype.isLocked=function(){return this.locked},i.prototype.setLocked=function(t){return this.locked=t},i.prototype.isComplete=function(){return this.complete},i.prototype.setComplete=function(t){this.complete=t},i}),define("petengine/levelmanager",["absolute","petengine/level"],function(t,e){var i=function(t){this.initLevelManager(t)};return i.prototype.initLevelManager=function(t){this.game=t,this.localStorageKey="levelStates",this.levelConfig=t.levelConfig,this.levelStates=this.getLevelStates(),this._save(),this.levels=this._loadLevels()},i.prototype.setLevelState=function(t){var e=t.getId(),i=t.getScore(),n=t.getScore()>this.levelStates[e].topScore;n&&(this.levelStates[e].topScore=i),this.levelStates[e].currentScore=i,this.levelStates[e].complete=!0,this.levelStates[e].locked=!1,"undefined"!=typeof this.levelStates[e+1]&&t.getLevelAchieved()>0&&(this.levelStates[e+1].locked=!1),this._save()},i.prototype._save=function(){t.GameConfig.setVal(this.localStorageKey,this.levelStates)},i.prototype._loadLevels=function(){for(var t=[],i=0;i<this.levelConfig.levels.length;i++)t.push(new e(this.game,i,this.levelConfig.levels[i],this.levelStates[i].locked,this.levelStates[i].complete,this.levelStates[i].topScore));return t},i.prototype._loadLevelStates=function(){return t.GameConfig.getVal(this.localStorageKey)},i.prototype.getLevelStates=function(){for(var e=[],i=this._loadLevelStates(),n=0;n<this.levelConfig.levels.length;n++){var o={};"undefined"!=typeof i&&n<i.length?o=i[n]:(o.topScore=0,o.currentScore=0,o.locked=t.Debug.enabled?!1:this.levelConfig.levels[n].locked,o.complete=!1),e.push(o)}return e},i.prototype._findNextUnfinishedLevel=function(){for(var t=this.levelStates.length,e=0;e<this.levelStates.length;e++)if(!this.levelStates[e].complete){t=e;break}return t},i.prototype.setNextLevel=function(e){return e>=this.levels.length||this.getLevel(e).locked?!1:(t.Debug.log("Loading next level "+e),this.setSelectedLevel(e),!0)},i.prototype._updateLevels=function(){this.levelStates=this.getLevelStates();for(var t=0;t<this.levels.length;t++)this.levels[t].setComplete(this.levelStates[t].complete),this.levels[t].setScore(this.levelStates[t].score),this.levels[t].setLocked(this.levelStates[t].locked)},i.prototype.getLevel=function(t){return this._updateLevels(),this.levels[t]},i.prototype.getLevelState=function(t){return this._updateLevels(),this.levelStates[t]},i.prototype.getLevels=function(){return this._updateLevels(),this.levels},i.prototype.setSelectedLevel=function(e){t.GameConfig.setVal("selectedLevel",e)},i.prototype.getSelectedLevel=function(){var e=t.GameConfig.getVal("selectedLevel");return this._updateLevels(),"undefined"==typeof e&&(e=0),this.levels[e]},i}),define("petengine/petgame",["absolute","petengine/petgameui","state-machine","petengine/levelmanager"],function(t,e,i,n){var o=function(t){this._initPetGame(t)};return o.prototype=Object.create(t.Game.prototype),o.prototype._initPetGame=function(i){this.levelConfig=i.levelConfig,this.tutorialConfig=i.tutorialConfig,t.Game.call(this,i.gameId,{version:1,musicEnabled:!0,sfxEnabled:!0,lastLevel:0,levelStates:[],config:i.config}),this.lastState="init",this.currentLevelIndex=0,this.currentLevel=0,this.initStateMachine(),this.ui=new e(this,i.container,i.width,i.height,i.layout,i.backgroundColor),this.savedMusicState=t.MusicManager.isMuted(),this.savedGameState="",this.levelManager=new n(this)},o.prototype.handleVisibilityChange=function(e){t.Game.prototype.handleVisibilityChange.call(this,e),this.ui.handleVisibilityChange(e),e?(this.savedGameState=this.fsm.current,t.MusicManager.stopMusic(),t.AudioManager.isSfxEnabled()&&t.AudioManager.muteAll()):("trainmode"!==this.savedGameState||t.MusicManager.isMuted()?t.MusicManager.isMuted()||t.MusicManager.playMusic("care_mode_music"):t.MusicManager.playMusic("train_mode_music"),t.AudioManager.isSfxEnabled()&&t.AudioManager.unmuteAll())},o.prototype.load=function(t,e,i){this.ui.load(t,e,i)},o.prototype.initStateMachine=function(){this.fsm=i.create({events:[{name:"init",from:"none",to:"loading"},{name:"start",from:"loading",to:"mainmenu"},{name:"care",from:"mainmenu",to:"caremode"},{name:"care",from:"optionsmode",to:"caremode"},{name:"care",from:"trainmode",to:"caremode"},{name:"care",from:"levelmenu",to:"caremode"},{name:"train",from:"levelmenu",to:"trainmode"},{name:"train",from:"trainmode",to:"trainmode"},{name:"selectlevel",from:"caremode",to:"levelmenu"},{name:"selectlevel",from:"trainmode",to:"levelmenu"}],callbacks:{onstart:this.onStart.bind(this),onmainmenu:this.onMainMenu.bind(this),oncare:this.onCare.bind(this),ontrain:this.onTrain.bind(this),onselectlevel:this.onSelectLevel.bind(this),onchangestate:function(e,i,n){this.lastState=i,t.Debug.log("CHANGED STATE: "+i+" to "+n)}.bind(this)}}),this.fsm.init()},o.prototype.onStart=function(){},o.prototype.onSelectLevel=function(){this.ui.showLevelSelect()},o.prototype.onCare=function(){this.ui.showCareScreen()},o.prototype.onTrain=function(){this.ui.showTrainScreen()},o.prototype.onMainMenu=function(){this.ui.showMainMenu()},o.prototype.start=function(){this.fsm.start()},o.prototype.care=function(){this.fsm.care()},o.prototype.train=function(){this.fsm.train()},o.prototype.selectLevel=function(){this.fsm.selectlevel()},o.prototype.back=function(){"trainmode"===this.lastState?this.fsm.train():this.fsm.care()},o}),define("petengine",["require","petengine/petgame","petengine/obstacle"],function(t){"use strict";return{version:"1.0",PetGame:t("petengine/petgame"),Obstacle:t("petengine/obstacle")}}),define("locale",[],function(){return"en"}),define("strings",["locale"],function(t){"use strict";var e={en:{tutorial:{step1:"Link all matching tiles to remove them from the board before time runs out!\n\nTap on the indicated tile.",step2:"\n\nAny two matching tiles that are next to each other can be linked.",step3:"Nice! You made your first link!\n\nYou can also link tiles with an open path between them.",step4:"\n\nEven though these tiles aren't right next to each other, you can link them!",step5:"\n\nYou can even link tiles around corners.",step6:"\n\nThese tiles only require one corner in the path to link them.",step7:"Nice!\n\nYou can't link tiles if the path has more than two corners.",step8:"\n\nThese two tiles won't link.",step9:"\n\nBut these two will, because the path only has one corner.",step10:"\n\nAnd these two tiles will link with a two corner path.",step11:"\n\nGo ahead, try it!",step12:"There are some special tiles that give you extra powers.\n\nLinking two shuffle tiles gives you a free shuffle.",step13:"Use the shuffle to mix up the tiles when you get stuck.\n\nThere are other special tiles that you'll discover as you play.",complete:"You're ready to play!\nYou can always get back to this tutorial by replaying the first level of the game.\n\nHave fun!"}}};
return e.locale?e[t]:e.en}),define("levelconfig",["strings"],function(){"use strict";var t=2.75,e={strt1:"--------------s",strt2:"--------------sPPPP",strt3:"--------------sHHH",strt4:"--------------sB-B--b",strt5:"--------------sr",fnsh1:"f----------",fnsh2:"pp-PPfPPpp----------",fnsh3:"B-Bf-B-B-b-b----------",fnsh4:"fBPP-B---b-b----------",fnsh5:"pp-PfP-P-pp----------",lowTreats1:"ppp",lowTreats2:"pppppp",lowTreats3:"pppppppppp",highTreats1:"PPP",highTreats2:"PPPPPP",highTreats3:"PPPPPPPPPP",treatSpree1:"p-ppppp-p",treatSpree2:"ppp-PPP---pppp",treatSpree3:"ppphhh-ppp",treatSpree4:"PPPHHH-PPP",treatSpree5:"i-PPi--PPPPpp",mudSpree1:"r-ppp",mudSpree2:"r----PrP",mudSpree3:"r-h-H-rP-P",mudSpree4:"r-h-H-rB-PP--b",highHoops1:"HHH",highHoops2:"HHHH",highHoops3:"HHHHHH",lowHoops1:"hh",lowHoops2:"hhh",lowHoops3:"hhhh",hoopSpree1:"h-HHH",hoopSpree2:"hh-H--BH",hoopSpree3:"h--H-PH--p",hoopSpree4:"p-HH--BHH",hoopSpree5:"hh-HH--BHH--b",discSpree1:"i-B-Bi-B-B-b-b",discSpree2:"BiB-r--Bpp",discSpree3:"bi-B-B",discSpree4:"i--B-Bi-B-B-ppp",discSpree5:"iBPP-B---b-b",hurdleSpree1:"iBrPPP-iB",hurdleSpree2:"i--HHHH-i",hurdleSpree3:"i-B-H-H-iB",hurdleSpree4:"i-B-PPP-iB",hoopMud1:"h-Hr---H-h--------ppppp--------h-Hr---H-h",hoopMud2:"h-Hr---H-h--------ppppp--------h-Hr---H-h",Gap1:"--------",Gap2:"-----------",Gap3:"--------------"},i={levels:[{obstacles:e.strt1+e.Gap2+e.lowTreats1+e.Gap2+"H-PPH"+e.Gap2+e.lowTreats2+e.Gap2+e.mudSpree1+e.Gap2+e.highTreats1+e.Gap2+e.fnsh1,locked:!1,gold:.8,silver:.6,bronze:.4,gradient:["#e86ddb","#fffc00"],velocity:t},{obstacles:e.strt1+e.Gap2+e.lowTreats2+e.Gap2+e.hoopSpree1+e.Gap2+e.lowTreats1+e.Gap2+e.hoopSpree2+e.Gap2+e.hoopSpree1+e.Gap2+e.Gap2+e.mudSpree1+e.Gap2+e.mudSpree1+e.Gap2+e.fnsh1,locked:!0,gold:.8,silver:.6,bronze:.4,gradient:["#cb54cc","#1dbee0"],velocity:t},{obstacles:e.Gap1+e.strt1+e.Gap2+e.highTreats2+e.Gap2+e.discSpree2+e.Gap2+e.lowTreats3+e.Gap2+"H---H"+e.Gap2+e.hoopSpree3+e.Gap2+e.highTreats3+e.Gap2+e.discSpree3+e.Gap3+e.lowTreats2+e.Gap3+e.mudSpree2+e.Gap3+e.mudSpree3+e.Gap3+e.fnsh1,locked:!0,gold:.8,silver:.6,bronze:.5,gradient:["#cb54cc","#1dbee0"],velocity:t},{obstacles:e.Gap1+e.strt2+e.Gap2+e.lowTreats2+e.Gap2+e.hoopSpree2+e.Gap2+e.lowTreats2+e.Gap2+e.hoopSpree3+e.Gap2+e.lowTreats3+e.Gap2+e.discSpree3+e.Gap2+e.lowTreats2+e.Gap3+e.hoopSpree4+e.Gap3+e.highTreats3+e.Gap3+"hh-PPfPPpp----------",locked:!0,gold:.85,silver:.6,bronze:.5,gradient:["#cb54cc","#1dbee0"],velocity:t},{obstacles:e.Gap1+e.strt5+e.Gap3+e.discSpree5+e.Gap3+e.discSpree5+e.Gap3+e.hoopSpree5+e.Gap2+e.treatSpree3+e.Gap2+e.mudSpree2+e.Gap2+e.highTreats3+e.Gap2+e.mudSpree3+e.Gap2+e.lowTreats3+e.Gap3+e.mudSpree4+e.Gap2+e.mudSpree2+e.Gap3+e.mudSpree3+e.Gap2+e.mudSpree2+e.Gap3+e.mudSpree3+e.Gap2+e.hoopSpree1+e.Gap2+e.fnsh3,locked:!0,gold:.85,silver:.75,bronze:.5,gradient:["#e86ddb","#fffc00"],velocity:t},{obstacles:e.Gap3+e.strt4+e.Gap3+e.hurdleSpree1+e.Gap3+e.hurdleSpree2+e.Gap2+"HHHH"+e.Gap3+e.mudSpree2+e.Gap2+e.hurdleSpree3+e.Gap3+e.hurdleSpree4+e.Gap2+e.discSpree4+e.Gap3+e.mudSpree2+e.Gap2+e.discSpree5+e.Gap3+e.hurdleSpree1+e.Gap3+e.discSpree4+e.Gap3+e.hurdleSpree1+e.Gap2+e.hoopSpree2+e.Gap3+e.hurdleSpree3+e.Gap3+e.fnsh4,locked:!0,gold:.95,silver:.85,bronze:.5,gradient:["#e86ddb","#fffc00"],velocity:t},{obstacles:e.Gap3+e.strt2+e.Gap3+e.highHoops3+e.Gap3+e.discSpree4+e.Gap3+e.treatSpree5+e.Gap3+e.mudSpree4+e.Gap2+e.mudSpree3+e.Gap2+e.treatSpree2+e.Gap2+e.hoopSpree4+e.Gap3+e.discSpree2+e.Gap2+e.discSpree1+e.Gap3+e.mudSpree2+e.Gap2+e.hoopSpree2+e.Gap3+"B"+e.Gap2+e.hoopSpree2+e.Gap2+e.mudSpree1+e.Gap3+e.hurdleSpree3+e.Gap3+e.treatSpree5+e.Gap3+e.mudSpree4+e.Gap2+e.highTreats2+e.Gap2+e.discSpree2+e.Gap2+e.lowTreats3+e.Gap2+e.lowHoops1+e.Gap1+e.fnsh2,locked:!0,gold:.95,silver:.8,bronze:.65,gradient:["#cb54cc","#1dbee0"],velocity:t},{obstacles:e.Gap3+e.strt2+e.Gap3+"r-pp--------r--h---------r"+e.Gap3+"H--B-H"+e.Gap3+e.mudSpree1+e.Gap2+"r-p---------r--h---------r"+e.Gap3+e.mudSpree2+e.Gap3+e.highTreats3+e.Gap2+e.mudSpree3+e.Gap2+e.treatSpree1+e.Gap3+e.hoopSpree2+e.Gap2+e.treatSpree1+e.Gap3+"H--B-H"+e.Gap3+e.treatSpree5+e.Gap3+e.hurdleSpree2+e.Gap3+e.discSpree3+e.Gap3+e.highTreats2+e.Gap3+"b-HHH-----b"+e.Gap3+e.lowTreats1+e.Gap3+e.mudSpree3+e.Gap3+e.mudSpree1+e.Gap3+e.fnsh5,locked:!0,gold:.95,silver:.8,bronze:.65,velocity:t},{obstacles:e.Gap3+e.strt4+e.Gap3+e.treatSpree1+e.Gap3+"HHH"+e.Gap3+e.treatSpree2+e.Gap3+"B-B"+e.Gap2+e.treatSpree3+e.Gap3+"i---i"+e.Gap3+e.treatSpree4+e.Gap3+"B"+e.Gap3+e.treatSpree5+e.Gap3+"r"+e.Gap3+e.treatSpree1+e.Gap3+"B--P-B"+e.Gap3+e.treatSpree2+e.Gap3+"HHHH"+e.Gap2+e.treatSpree3+e.Gap3+"i---i"+e.Gap3+e.treatSpree4+e.Gap3+"B"+e.Gap3+e.treatSpree5+e.Gap3+"i"+e.Gap3+e.treatSpree1+e.Gap3+"b--b--b"+e.Gap3+e.treatSpree2+e.Gap3+"hhhh"+e.Gap2+e.treatSpree3+e.Gap3+"r-----r"+e.Gap3+e.treatSpree4+e.Gap3+"B--B--B"+e.Gap3+e.treatSpree5+e.Gap3+"HHHH"+e.Gap3+e.fnsh4,locked:!0,gold:.9,silver:.85,bronze:.65,gradient:["#e86ddb","#fffc00"],velocity:t},{obstacles:e.Gap3+e.strt4+e.Gap3+e.mudSpree1+e.Gap3+e.mudSpree2+e.Gap2+"HHHH"+e.Gap3+e.Gap2+"r-p---------r--hh---------r"+e.discSpree2+e.Gap2+e.mudSpree3+e.Gap3+e.mudSpree4+e.Gap2+e.discSpree4+e.Gap3+e.mudSpree2+e.Gap2+e.discSpree5+e.Gap3+e.mudSpree1+e.Gap3+e.discSpree4+e.Gap3+e.mudSpree4+e.Gap2+e.discSpree2+e.Gap3+e.hurdleSpree3+e.Gap2+"r-p---------r--hh---------r"+e.Gap3+e.fnsh2,locked:!0,gold:.95,silver:.85,bronze:.75,velocity:t},{obstacles:e.Gap3+e.strt2+e.Gap3+e.highHoops3+e.Gap3+e.discSpree1+e.Gap3+e.discSpree5+e.Gap3+e.hoopSpree4+e.Gap2+e.discSpree3+e.Gap2+e.discSpree2+e.Gap2+e.hoopSpree1+e.Gap3+e.discSpree2+e.Gap2+e.discSpree4+e.Gap3+e.hoopSpree2+e.Gap2+e.hoopSpree3+e.Gap3+"B--B--B"+e.Gap2+e.discSpree2+e.Gap2+e.discSpree1+e.Gap3+e.hoopSpree3+e.Gap3+e.discSpree5+e.Gap3+e.discSpree4+e.Gap2+e.highTreats2+e.Gap2+e.discSpree2+e.Gap3+"B--B--B"+e.Gap2+e.lowTreats3+e.Gap2+e.discSpree5+e.Gap1+e.fnsh3,locked:!0,gold:.95,silver:.85,bronze:.75,gradient:["#cb54cc","#1dbee0"],velocity:t},{obstacles:e.Gap3+e.strt1+e.Gap3+e.highHoops3+e.Gap3+e.highTreats2+e.Gap3+e.discSpree5+e.Gap3+e.highHoops3+e.Gap3+e.highTreats1+e.Gap3+e.highHoops1+e.Gap3+e.highTreats3+e.Gap3+e.highHoops3+e.Gap3+e.highTreats3+e.Gap3+e.lowHoops3+e.Gap3+e.lowTreats3+e.Gap3+e.mudSpree4+e.Gap3+e.lowHoops3+e.Gap3+e.lowTreats3+e.Gap3+e.lowHoops2+e.Gap3+e.lowTreats3+e.Gap3+e.lowHoops3+e.Gap3+e.lowTreats3+e.Gap3+e.Gap3+e.mudSpree4+e.Gap3+e.discSpree5+e.Gap3+e.mudSpree4+e.Gap3+e.discSpree5+e.Gap3+e.mudSpree4+e.Gap3+e.discSpree5+e.Gap3+e.fnsh1,locked:!0,gold:.95,silver:.85,bronze:.75,gradient:["#e86ddb","#fffc00"],velocity:t}],startingCurrencyBalance:150,obstacleSpacerWidth:100,mainMenuVelocity:.2};return i}),define("layout",[],function(){var t={LoadingScreen:{logo:{y:200},progressBar:{y:1100}},MainMenu:{logo:{y:200},playButton:{x:864,y:1050},musicButton:{x:1018,y:1789},sfxButton:{x:1227,y:1789},zibboButton:{x:32,y:1816}},CareScreen:{hud:{x:0,y:0},optionsMenuButton:{x:36,y:1096},trainModeButton:{x:1806,y:1096},petStoreButton:{x:68,y:1327},environmentStoreButton:{x:1752,y:1327},edibleDrop:{x:825,y:0,dy:625}},CareHUD:{environmentHealthMeter:{x:1032,y:15},petHealthMeter:{x:454,y:15},score:{x:1597,y:12}},TrainScreen:{optionsMenuButton:{x:30,y:50},replayButton:{x:225,y:50},scoreDisplay:{x:1600,y:58}},TrainingView:{jumpButton:{x:1700,y:1200}},LevelSelectButton:{stateButton:{x:367,y:62},levelNumber:{x:95,y:25,scale:.7},score:{x:185,y:130,scale:.58},medalMask:{x:294,y:206,gutter:22}},OptionsScreen:{musicButton:{x:200,y:120},sfxButton:{x:660,y:120},htpButton:{x:1125,y:120},careButton:{x:630,y:450}},GameScreen:{timer:{x:26,y:1792},levelIndicator:{x:534,y:1742},scrambleButton:{x:990,y:1756},optionsButton:{x:766,y:1782},hintButton:{x:1252,y:1734},scrambleCount:{x:959,y:1899},hintCount:{x:1227,y:1899}},Timer:{timeProgress:{startX:22,endX:422}},LevelIndicator:{levelNumber:{y:10}},LevelFailed:{title:{x:137,y:424},menuButton:{x:337,y:1258},replayButton:{x:824,y:1258}},HowToPlay:{title:{x:284,y:73},move1:{x:153,y:282},move2:{x:833,y:282},move3:{x:153,y:740},move4:{x:833,y:740},power1:{x:17,y:1243},power2:{x:516,y:1243},power3:{x:1015,y:1243},playButton:{x:1280,y:1520}},ItemDetailScreen:{buyButton:{x:50,y:850},cancelButton:{x:400,y:850}},ScoreSummaryScreen:{levelSelectButton:{x:125,y:1100},replayButton:{x:1600,y:1100},playButton:{x:1600,y:1100},levelSelectText:{x:80,y:1400},nextLevelText:{x:1500,y:1400},goToLagoon:{y:1125},goToLagoonText:{y:1400},menuButton:{x:84,y:1258},headline:{y:350},levelDetails:{y:600},awardMessage:{y:950},playNextButton:{x:1058,y:1258},digitSpriteScale:1}};return t}),define("text!audiosprites.json",[],function(){return'[\n    {\n        "id": "puppy_flip",\n        "url": "puppy_flip",\n        "loop": false,\n        "volume": 100,\n        "start": 106,\n        "end": 106.81124716553288\n    },\n    {\n        "id": "care_mode_music",\n        "url": "care_mode_music",\n        "loop": true,\n        "volume": 50,\n        "start": 6,\n        "end": 36.021950113378686\n    },\n    {\n        "id": "button_click",\n        "url": "dol_button_click",\n        "loop": false,\n        "volume": 40,\n        "start": 45,\n        "end": 45.18430839002268\n    },\n    {\n        "id": "bumblebee_buzz",\n        "url": "bumble_bee",\n        "loop": false,\n        "volume": 45,\n        "start": 2,\n        "end": 4.854603174603175\n    },\n    {\n        "id": "puppy_eat_crunchy",\n        "url": "dol_dolphin_eat",\n        "loop": false,\n        "volume": 80,\n        "start": 51,\n        "end": 53.04190476190476\n    },\n    {\n        "id": "puppy_eat_meaty",\n        "url": "puppy_eat_meat",\n        "loop": false,\n        "volume": 80,\n        "start": 102,\n        "end": 104.08834467120181\n    },\n    {\n        "id": "puppy_love",\n        "url": "puppy_love",\n        "loop": false,\n        "volume": 80,\n        "start": 110,\n        "end": 111.57750566893424\n    },\n    {\n        "id": "puppy_running",\n        "url": "puppy_running",\n        "loop": false,\n        "volume": 80,\n        "start": 118,\n        "end": 120.92426303854876\n    },\n    {\n        "id": "bark",\n        "url": "puppy_bark",\n        "loop": false,\n        "volume": 75,\n        "start": 77,\n        "end": 77.43972789115647\n    },\n    {\n        "id": "beg",\n        "url": "puppy_beg",\n        "loop": false,\n        "volume": 75,\n        "start": 79,\n        "end": 80.11310657596371\n    },\n    {\n        "id": "jump",\n        "url": "puppy_jump",\n        "loop": false,\n        "volume": 75,\n        "start": 108,\n        "end": 108.3004081632653\n    },\n    {\n        "id": "sit",\n        "url": "puppy_sit",\n        "loop": false,\n        "volume": 75,\n        "start": 125,\n        "end": 125.90412698412699\n    },\n    {\n        "id": "pant",\n        "url": "puppy_pant",\n        "loop": false,\n        "volume": 75,\n        "start": 113,\n        "end": 116.7601814058957\n    },\n    {\n        "id": "dolphin_sponge",\n        "url": "dol_dolphin_sponge",\n        "loop": false,\n        "volume": 80,\n        "start": 58,\n        "end": 59.55428571428571\n    },\n    {\n        "id": "puppy_sad",\n        "url": "puppy_sad",\n        "loop": false,\n        "volume": 50,\n        "start": 122,\n        "end": 123.39174603174604\n    },\n    {\n        "id": "pet_clean_sparkle",\n        "url": "dol_gold_burst",\n        "loop": false,\n        "volume": 100,\n        "start": 61,\n        "end": 63.831383219954645\n    },\n    {\n        "id": "train_mode_music",\n        "url": "train_mode_music",\n        "loop": true,\n        "volume": 15,\n        "start": 129,\n        "end": 152.56680272108844\n    },\n    {\n        "id": "puppy_jump",\n        "url": "dol_dolphin_jump",\n        "loop": false,\n        "volume": 100,\n        "start": 55,\n        "end": 56.76326530612245\n    },\n    {\n        "id": "success_ball",\n        "url": "dol_success_ball",\n        "loop": false,\n        "volume": 100,\n        "start": 67,\n        "end": 67.78802721088435\n    },\n    {\n        "id": "puppy_bone_1",\n        "url": "puppy_bone_1",\n        "loop": false,\n        "volume": 75,\n        "start": 82,\n        "end": 82.60226757369614\n    },\n    {\n        "id": "puppy_bone_2",\n        "url": "puppy_bone_2",\n        "loop": false,\n        "volume": 75,\n        "start": 86,\n        "end": 86.50938775510204\n    },\n    {\n        "id": "puppy_bone_3",\n        "url": "puppy_bone_3",\n        "loop": false,\n        "volume": 75,\n        "start": 88,\n        "end": 88.50938775510204\n    },\n    {\n        "id": "puppy_bone_4",\n        "url": "puppy_bone_4",\n        "loop": false,\n        "volume": 75,\n        "start": 90,\n        "end": 90.50938775510204\n    },\n    {\n        "id": "puppy_bone_5",\n        "url": "puppy_bone_5",\n        "loop": false,\n        "volume": 75,\n        "start": 92,\n        "end": 92.50938775510204\n    },\n    {\n        "id": "puppy_bone_6",\n        "url": "puppy_bone_6",\n        "loop": false,\n        "volume": 75,\n        "start": 94,\n        "end": 94.50938775510204\n    },\n    {\n        "id": "puppy_bone_7",\n        "url": "puppy_bone_7",\n        "loop": false,\n        "volume": 75,\n        "start": 96,\n        "end": 96.50938775510204\n    },\n    {\n        "id": "puppy_bone_8",\n        "url": "puppy_bone_8",\n        "loop": false,\n        "volume": 75,\n        "start": 98,\n        "end": 98.50938775510204\n    },\n    {\n        "id": "puppy_bone_9",\n        "url": "puppy_bone_9",\n        "loop": false,\n        "volume": 75,\n        "start": 100,\n        "end": 100.50938775510204\n    },\n    {\n        "id": "puppy_bone_10",\n        "url": "puppy_bone_10",\n        "loop": false,\n        "volume": 75,\n        "start": 84,\n        "end": 84.50938775510204\n    },\n    {\n        "id": "success_hoop",\n        "url": "dol_success_hoop",\n        "loop": false,\n        "volume": 100,\n        "start": 69,\n        "end": 70.48462585034014\n    },\n    {\n        "id": "fail_hurdle",\n        "url": "puppy_wooden_hurdle",\n        "loop": false,\n        "volume": 50,\n        "start": 127,\n        "end": 127.53260770975056\n    },\n    {\n        "id": "fail_puddle",\n        "url": "dol_splash",\n        "loop": false,\n        "volume": 50,\n        "start": 65,\n        "end": 65.57904761904761\n    },\n    {\n        "id": "success_ring",\n        "url": "dol_success_ring",\n        "loop": false,\n        "volume": 100,\n        "start": 72,\n        "end": 73.04344671201814\n    },\n    {\n        "id": "course_end",\n        "url": "dol_course_end",\n        "loop": false,\n        "volume": 100,\n        "start": 47,\n        "end": 49.90104308390023\n    },\n    {\n        "id": "award_bronze",\n        "url": "dol_award_bronze",\n        "loop": false,\n        "volume": 100,\n        "start": 38,\n        "end": 38.81124716553288\n    },\n    {\n        "id": "award_silver",\n        "url": "dol_award_silver",\n        "loop": false,\n        "volume": 100,\n        "start": 43,\n        "end": 43.81124716553288\n    },\n    {\n        "id": "award_gold",\n        "url": "dol_award_gold",\n        "loop": false,\n        "volume": 100,\n        "start": 40,\n        "end": 41.50784580498866\n    }\n]'}),define("audiosprites",["text!audiosprites.json"],function(t){return JSON.parse(t)}),define("text!artassets.json",[],function(){return'[\n    "loading",\n    "atlas1",\n    "atlas2",\n    "atlas3",\n    "atlas4"\n]'}),define("artassets",["text!artassets.json"],function(t){return JSON.parse(t)}),define("text!gameconfig.json",[],function(){return'{\n    "analytics": {\n        "flurry": {\n            "apiKey": "Y4X9H7TQJFYR9M98MYKG"\n        }\n    }\n}'}),define("gameconfig",["text!gameconfig.json"],function(t){return JSON.parse(t)}),define("tutorials",["absolute"],function(t){return{getConfig:function(){return{careScreen:[{dialog:{width:t.Coords.x(1100),type:"text",content:"Welcome to your Yard! This is where you can take care of your Puppy and give her a happy home."},arrows:[]},{dialog:{width:t.Coords.x(1100),type:"text",content:"Press this button to get sponges and treats to keep your Puppy clean and well fed."},arrows:[{x:-t.Coords.x(225),y:t.Coords.y(1200),rotation:-2}]},{dialog:{width:t.Coords.x(1100),type:"text",content:"Every time you feed and clean your Puppy, her health will improve."},arrows:[{x:t.Coords.x(300),y:-t.Coords.y(200),rotation:0}]},{dialog:{width:t.Coords.x(1100),type:"text",content:"Press this button to get Toys, Decorations and Critters to make your Yard a happy home."},arrows:[{x:t.Coords.x(1350),y:t.Coords.y(1150),rotation:2}]},{dialog:{width:t.Coords.x(1100),type:"text",content:"Adding more toys and animals will increase your Yard's health."},arrows:[{x:t.Coords.x(750),y:-t.Coords.y(200),rotation:0}]},{dialog:{width:t.Coords.x(1100),type:"text",content:"You can race your Puppy at anytime to earn more Treats."},arrows:[{x:t.Coords.x(1400),y:t.Coords.y(800),rotation:2}]}],preRaceMode:[{dialog:{width:t.Coords.x(1100),type:"text",content:"Jump over and through obstacles to score points and collect more Treats."},arrows:[]},{dialog:{width:t.Coords.x(1500),type:"image",content:"tutorial_jumps.jpg"},arrows:[]}],currencyCaptured:[{dialog:{width:t.Coords.x(1100),type:"text",content:"Great Job! You earned some Treats!"},arrows:[{x:t.Coords.x(1200),y:-t.Coords.y(200),rotation:0}]}],levelCompleteToLagoon:[{dialog:{width:t.Coords.x(1100),type:"text",content:"Return to your Yard to care for it and your Puppy!"},arrows:[{x:t.Coords.x(400),y:t.Coords.y(750),rotation:1.57}]}],pageIndicators:{empty:"btn_main_pagepip_empty.png",full:"btn_main_pagepip_full.png"}}}}}),require.config({waitSeconds:0,paths:{text:"dependencies/bower_components/requirejs-text/text",pixi:"dependencies/bower_components/pixi/bin/pixi.dev",absolute:"dependencies/absolute/absolute",absoluteaudio:"dependencies/absoluteaudio/absoluteaudio",petengine:"dependencies/petengine/petengine","state-machine":"dependencies/bower_components/javascript-state-machine/state-machine",tween:"dependencies/bower_components/tweenjs/src/Tween",hammer:"dependencies/bower_components/hammerjs/hammer",fpsmeter:"dependencies/bower_components/fpsmeter/index",requireLib:"dependencies/bower_components/requirejs/require",proton:"dependencies/bower_components/Proton/build/proton-1.0.0"},packages:[{name:"lodash",location:"dependencies/bower_components/lodash-amd/modern"}],shim:{astar:{exports:"AStar"},"state-machine":{exports:"StateMachine"},tween:{exports:"TWEEN"},hammer:{exports:"Hammer"},fpsmeter:{exports:"FPSMeter"},proton:{exports:"Proton"}}}),require(["version","absolute","petengine","levelconfig","layout","audiosprites","artassets","gameconfig","tutorials"],function(t,e,i,n,o,r,s,a,h){for(var l,u=!1,c=!1,p={},d=/\+/g,f=/([^&=]+)=?([^&]*)/g,g=function(t){return decodeURIComponent(t.replace(d," "))},m=window.location.search.substring(1);l=f.exec(m);)p[g(l[1])]=g(l[2]);u=p.debug&&"true"===p.debug,c=p.portrait&&"true"===p.portrait,e.Debug.enabled=u,e.Debug.log('Starting "'+t.name()+'" '+t.id()+" "+t.version()),e.ScreenMetrics.stepDownResClass=!0,e.ScreenMetrics.refresh(),e.ScreenMetrics.log(),e.Platform.artPathPrefix="spritesheets",e.Platform.soundPathPrefix="sound",e.ScreenMetrics.detectOrientationChange(function(t){"landscape"===t&&window.scrollTo(0,0)});var y=function(){var l=new i.PetGame({container:"container",width:2008*e.ScreenMetrics.getResScale(),height:1536*e.ScreenMetrics.getResScale(),levelConfig:n,layout:o,gameId:t.id(),gameVersion:t.version(),config:a,tutorialConfig:h.getConfig(),backgroundColor:6737151});l.load({audioAssets:r,artAssets:s},function(t){e.Debug.log(100*t+"% loaded")},function(){e.Debug.log("load complete"),l.start()})};if("undefined"!=typeof cordova){var v=function(){document.addEventListener("pause",function(){e.MusicManager.stopMusic()},!1),document.addEventListener("backbutton",function(){navigator.app.exitApp()},!1),y()};document.addEventListener("deviceready",v,!1)}else y()}),define("main",function(){});